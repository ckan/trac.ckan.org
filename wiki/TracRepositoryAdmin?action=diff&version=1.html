<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

    <html xmlns="http://www.w3.org/1999/xhtml">
  
  


  <head>
    <title>
      TracRepositoryAdmin (diff) – CKAN
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <!--[if IE]><script type="text/javascript">window.location.hash = window.location.hash;</script><![endif]-->
        <link rel="search" href="../search.html" />
        <link rel="help" href="TracGuide.html" />
        <link rel="up" href="TracRepositoryAdmin%3Faction=history.html" title="Page history" />
        <link rel="start" href="../wiki.1.html" />
        <link rel="stylesheet" href="../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../chrome/common/css/wiki.css" type="text/css" /><link rel="stylesheet" href="../chrome/common/css/diff.css" type="text/css" />
        <link rel="shortcut icon" href="../chrome/common/trac.ico" type="image/x-icon" />
        <link rel="icon" href="../chrome/common/trac.ico" type="image/x-icon" />
      <link type="application/opensearchdescription+xml" rel="search" href="../search/opensearch" title="Search CKAN" />
    <script type="text/javascript" src="../chrome/common/js/jquery.js"></script><script type="text/javascript" src="../chrome/common/js/babel.js"></script><script type="text/javascript" src="../chrome/common/js/messages/en_US.js"></script><script type="text/javascript" src="../chrome/common/js/trac.js"></script><script type="text/javascript" src="../chrome/common/js/search.js"></script><script type="text/javascript" src="../chrome/common/js/diff.js"></script>
    <!--[if lt IE 7]>
    <script type="text/javascript" src="/chrome/common/js/ie_pre7_hacks.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="../chrome/common/css/diff.css" />
    <meta name="ROBOTS" content="NOINDEX, NOFOLLOW" />
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="http://ckan.org/"><img src="http://assets.okfn.org/p/ckan/img/ckan_logo_shortname.png" alt="CKAN Trac" height="70" /></a>
      </div>
      <form id="search" action="../search.html" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Search" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="../login.html">Login</a></li><li><a href="../prefs.html">Preferences</a></li><li><a href="TracGuide.html">Help/Guide</a></li><li><a href="../about.html">About Trac</a></li><li class="last"><a href="../register.html">Register</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first"><a href="../timeline.html">Timeline</a></li><li><a href="../roadmap.html">Roadmap</a></li><li><a href="../report.html">View Tickets</a></li><li><a href="../search.html">Search</a></li><li class="last active"><a href="../wiki.1.html">Wiki</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
          <ul>
              <li class="first"><span class="missing">&larr; Previous Change</span></li><li><a href="TracRepositoryAdmin%3Faction=history.html" title="Page history">Wiki History</a></li><li class="last"><span class="missing">Next Change &rarr;</span></li>
          </ul>
        <hr />
      </div>
    <div id="content" class="wiki">
      <h1>
        Changes between
          <a href="http://localhost/wiki/TracRepositoryAdmin?version=0">Initial Version</a> and
          <a href="TracRepositoryAdmin%3Fversion=1.html">Version 1</a> of
          <a href="TracRepositoryAdmin%3Fversion=1.html">TracRepositoryAdmin</a>
      </h1>
      <form method="post" id="prefs" action="TracRepositoryAdmin%3Fversion=1.html"><div><input type="hidden" name="__FORM_TOKEN" value="93d81ccf9a7bb1c456462f62" /></div>
        <div>
          <input type="hidden" name="action" value="diff" />
          <input type="hidden" name="version" value="1" />
          <input type="hidden" name="old_version" value="0" />
          
  <label for="style">View differences</label>
  <select id="style" name="style">
    <option selected="selected" value="inline">inline</option>
    <option value="sidebyside">side by side</option>
  </select>
  <div class="field">
    <label><input type="radio" name="contextall" value="0" checked="checked" />
             Show</label>
      <label><input type="text" name="contextlines" id="contextlines" size="2" maxlength="3" value="2" />
             lines around each change</label><br />
    <label><input type="radio" name="contextall" value="1" />
           Show the changes in full context</label>
  </div>
  <fieldset id="ignore">
    <legend>Ignore:</legend>
    <div class="field">
      <input type="checkbox" id="ignoreblanklines" name="ignoreblanklines" />
      <label for="ignoreblanklines">Blank lines</label>
    </div>
    <div class="field">
      <input type="checkbox" id="ignorecase" name="ignorecase" />
      <label for="ignorecase">Case changes</label>
    </div>
    <div class="field">
      <input type="checkbox" id="ignorewhitespace" name="ignorewhitespace" />
      <label for="ignorewhitespace">White space changes</label>
    </div>
  </fieldset>
  <div class="buttons">
    <input type="submit" name="update" value="Update" />
  </div>

        </div>
      </form>
      <dl id="overview">
        <dt class="property time">Timestamp:</dt>
        <dd class="time">
            05/02/14 01:33:04 (<a class="timeline" href="../timeline%3Ffrom=2014-05-02T01:33:04Z&amp;precision=second.html" title="2014-05-02T01:33:04Z in Timeline">9 minutes</a> ago)
        </dd>
        <dt class="property author">Author:</dt>
        <dd class="author">
          trac
        </dd>
        <dt class="property message">Comment:</dt>
        <dd class="message">
          
          <p>
--
</p>

        </dd>
      </dl>
      <div class="diff">
        <div class="legend" id="diff-legend">
          <h3>Legend:</h3>
          <dl>
            <dt class="unmod"></dt><dd>Unmodified</dd>
            <dt class="add"></dt><dd>Added</dd>
            <dt class="rem"></dt><dd>Removed</dd>
            <dt class="mod"></dt><dd>Modified</dd>
          </dl>
        </div>
        <div class="diff">
  <ul class="entries">
      <li class="entry">
        <h2 id="file0">
          <a href="TracRepositoryAdmin%3Fversion=1.html">TracRepositoryAdmin</a>
        </h2>
        <table class="trac-diff inline" summary="Differences" cellspacing="0">
              <colgroup><col class="lineno" /><col class="lineno" /><col class="content" /></colgroup>
              <thead>
                <tr>
                  <th title="Version currently edited">
                    <a href="TracRepositoryAdmin%3Faction=diff&amp;version=1.html#L1">
                      v1</a>
                  </th>
                  <th title="Version 1">
                    <a href="TracRepositoryAdmin%3Fversion=1.html#L1">
                      v1</a>
                  </th>
                  <td> </td>
                </tr>
              </thead>
            <tbody class="add">
                  <tr class="first">
                          <th> </th><th>1</th><td class="r"><ins>= Repository Administration =</ins> </td>
                  </tr><tr>
                          <th> </th><th>2</th><td class="r"><ins>[[PageOutline(2-3)]]</ins> </td>
                  </tr><tr>
                          <th> </th><th>3</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>4</th><td class="r"><ins>== Quick start == #QuickStart</ins> </td>
                  </tr><tr>
                          <th> </th><th>5</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>6</th><td class="r"><ins>&nbsp;* Manage repositories in the "Repository" admin panel, with `trac-admin` or in the `[repositories]` section of [wiki:TracIni#repositories-section trac.ini].</ins> </td>
                  </tr><tr>
                          <th> </th><th>7</th><td class="r"><ins>&nbsp;* Set up a call to `trac-admin $ENV changeset added $REPO $REV` in the post-commit hook of each repository. Additionally, add a call to `trac-admin $ENV changeset modified $REPO $REV` in the post-revprop-change hook of repositories allowing revision property changes.</ins> </td>
                  </tr><tr>
                          <th> </th><th>8</th><td class="r"><ins>&nbsp;* Set the `[trac] repository_sync_per_request` option to an empty value to disable per-request syncing.</ins> </td>
                  </tr><tr>
                          <th> </th><th>9</th><td class="r"><ins>&nbsp;* Make sure the user under which your Subversion hooks are run has write access to the Trac environment, or use a tool like `sudo` to temporarily elevate privileges.</ins> </td>
                  </tr><tr>
                          <th> </th><th>10</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>11</th><td class="r"><ins>== Specifying repositories == #Repositories</ins> </td>
                  </tr><tr>
                          <th> </th><th>12</th><td class="r"><ins>Starting with 0.12, Trac can handle more than one repository per environment. The pre-0.12 way of specifying the repository with the `repository_dir` and `repository_type` options in the `[trac]` section of [wiki:TracIni trac.ini] is still supported, but two new mechanisms allow including additional repositories into an environment.</ins> </td>
                  </tr><tr>
                          <th> </th><th>13</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>14</th><td class="r"><ins>It is also possible to define aliases of repositories, that act as "pointers" to real repositories. This can be useful when renaming a repository, to avoid breaking all the links to the old name.</ins> </td>
                  </tr><tr>
                          <th> </th><th>15</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>16</th><td class="r"><ins>A number of attributes can be associated with each repository, which define the repository's location, type, name and how it is displayed in the source browser. The following attributes are supported:</ins> </td>
                  </tr><tr>
                          <th> </th><th>17</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>18</th><td class="r"><ins>||='''Attribute''' =||='''Description''' =||</ins> </td>
                  </tr><tr>
                          <th> </th><th>19</th><td class="r"><ins>||`alias` ||\</ins> </td>
                  </tr><tr>
                          <th> </th><th>20</th><td class="r"><ins>||A repository having an `alias` attribute is an alias to a real repository. All TracLinks referencing the alias resolve to the aliased repository. Note that multiple indirection is not supported, so an alias must always point to a real repository. The `alias` and `dir` attributes are mutually exclusive. ||</ins> </td>
                  </tr><tr>
                          <th> </th><th>21</th><td class="r"><ins>||`description` ||\</ins> </td>
                  </tr><tr>
                          <th> </th><th>22</th><td class="r"><ins>||The text specified in the `description` attribute is displayed below the top-level entry for the repository in the source browser. It supports WikiFormatting. ||</ins> </td>
                  </tr><tr>
                          <th> </th><th>23</th><td class="r"><ins>||`dir` ||\</ins> </td>
                  </tr><tr>
                          <th> </th><th>24</th><td class="r"><ins>||The `dir` attribute specifies the location of the repository in the filesystem. It corresponds to the value previously specified in the option `[trac] repository_dir`. The `alias` and `dir` attributes are mutually exclusive. ||</ins> </td>
                  </tr><tr>
                          <th> </th><th>25</th><td class="r"><ins>||`hidden` ||When set to `true`, the repository is hidden from the repository index page in the source browser. Browsing the repository is still possible, and links referencing the repository remain valid. ||</ins> </td>
                  </tr><tr>
                          <th> </th><th>26</th><td class="r"><ins>||`type` ||The `type` attribute sets the type of version control system used by the repository. Trac supports Subversion out-of-the-box, and plugins add support for many other systems. If `type` is not specified, it defaults to the value of the `[trac] repository_type` option. ||</ins> </td>
                  </tr><tr>
                          <th> </th><th>27</th><td class="r"><ins>||`url` ||The `url` attribute specifies the root URL to be used for checking out from the repository. When specified, a "Repository URL" link is added to the context navigation links in the source browser, that can be copied into the tool used for creating the working copy. ||</ins> </td>
                  </tr><tr>
                          <th> </th><th>28</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>29</th><td class="r"><ins>A repository `name` and one of `alias` or `dir` attributes are mandatory. All others are optional.</ins> </td>
                  </tr><tr>
                          <th> </th><th>30</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>31</th><td class="r"><ins>After adding a repository, the cache for that repository must be re-synchronized once with the `trac-admin $ENV repository resync` command.</ins> </td>
                  </tr><tr>
                          <th> </th><th>32</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>33</th><td class="r"><ins>&nbsp;`repository resync &lt;repos&gt;`::</ins> </td>
                  </tr><tr>
                          <th> </th><th>34</th><td class="r"><ins>&nbsp; &nbsp;Re-synchronize Trac with a repository.</ins> </td>
                  </tr><tr>
                          <th> </th><th>35</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>36</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>37</th><td class="r"><ins>=== In `trac.ini` === #ReposTracIni</ins> </td>
                  </tr><tr>
                          <th> </th><th>38</th><td class="r"><ins>Repositories and repository attributes can be specified in the `[repositories]` section of [wiki:TracIni#repositories-section trac.ini]. Every attribute consists of a key structured as `{name}.{attribute}` and the corresponding value separated with an equal sign (`=`). The name of the default repository is empty.</ins> </td>
                  </tr><tr>
                          <th> </th><th>39</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>40</th><td class="r"><ins>The main advantage of specifying repositories in `trac.ini` is that they can be inherited from a global configuration (see the [wiki:TracIni#GlobalConfiguration global configuration] section of TracIni). One drawback is that, due to limitations in the `ConfigParser` class used to parse `trac.ini`, the repository name is always all-lowercase.</ins> </td>
                  </tr><tr>
                          <th> </th><th>41</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>42</th><td class="r"><ins>The following example defines two Subversion repositories named `project` and `lib`, and an alias to `project` as the default repository. This is a typical use case where a Trac environment previously had a single repository (the `project` repository), and was converted to multiple repositories. The alias ensures that links predating the change continue to resolve to the `project` repository.</ins> </td>
                  </tr><tr>
                          <th> </th><th>43</th><td class="r"><ins>{{{</ins> </td>
                  </tr><tr>
                          <th> </th><th>44</th><td class="r"><ins>#!ini</ins> </td>
                  </tr><tr>
                          <th> </th><th>45</th><td class="r"><ins>[repositories]</ins> </td>
                  </tr><tr>
                          <th> </th><th>46</th><td class="r"><ins>project.dir = /var/repos/project</ins> </td>
                  </tr><tr>
                          <th> </th><th>47</th><td class="r"><ins>project.description = This is the ''main'' project repository.</ins> </td>
                  </tr><tr>
                          <th> </th><th>48</th><td class="r"><ins>project.type = svn</ins> </td>
                  </tr><tr>
                          <th> </th><th>49</th><td class="r"><ins>project.url = http://example.com/svn/project</ins> </td>
                  </tr><tr>
                          <th> </th><th>50</th><td class="r"><ins>project.hidden = true</ins> </td>
                  </tr><tr>
                          <th> </th><th>51</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>52</th><td class="r"><ins>lib.dir = /var/repos/lib</ins> </td>
                  </tr><tr>
                          <th> </th><th>53</th><td class="r"><ins>lib.description = This is the secondary library code.</ins> </td>
                  </tr><tr>
                          <th> </th><th>54</th><td class="r"><ins>lib.type = svn</ins> </td>
                  </tr><tr>
                          <th> </th><th>55</th><td class="r"><ins>lib.url = http://example.com/svn/lib</ins> </td>
                  </tr><tr>
                          <th> </th><th>56</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>57</th><td class="r"><ins>.alias = project</ins> </td>
                  </tr><tr>
                          <th> </th><th>58</th><td class="r"><ins>}}}</ins> </td>
                  </tr><tr>
                          <th> </th><th>59</th><td class="r"><ins>Note that `name.alias = target` makes `name` an alias for the `target` repo, not the other way around.</ins> </td>
                  </tr><tr>
                          <th> </th><th>60</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>61</th><td class="r"><ins>=== In the database === #ReposDatabase</ins> </td>
                  </tr><tr>
                          <th> </th><th>62</th><td class="r"><ins>Repositories can also be specified in the database, using either the "Repositories" admin panel under "Version Control", or the `trac-admin $ENV repository` commands.</ins> </td>
                  </tr><tr>
                          <th> </th><th>63</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>64</th><td class="r"><ins>The admin panel shows the list of all repositories defined in the Trac environment. It allows adding repositories and aliases, editing repository attributes and removing repositories. Note that repositories defined in `trac.ini` are displayed but cannot be edited.</ins> </td>
                  </tr><tr>
                          <th> </th><th>65</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>66</th><td class="r"><ins>The following [wiki:TracAdmin trac-admin] commands can be used to perform repository operations from the command line.</ins> </td>
                  </tr><tr>
                          <th> </th><th>67</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>68</th><td class="r"><ins>&nbsp;`repository add &lt;repos&gt; &lt;dir&gt; [type]`::</ins> </td>
                  </tr><tr>
                          <th> </th><th>69</th><td class="r"><ins>&nbsp; &nbsp;Add a repository `&lt;repos&gt;` located at `&lt;dir&gt;`, and optionally specify its type.</ins> </td>
                  </tr><tr>
                          <th> </th><th>70</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>71</th><td class="r"><ins>&nbsp;`repository alias &lt;name&gt; &lt;target&gt;`::</ins> </td>
                  </tr><tr>
                          <th> </th><th>72</th><td class="r"><ins>&nbsp; &nbsp;Create an alias `&lt;name&gt;` for the repository `&lt;target&gt;`.</ins> </td>
                  </tr><tr>
                          <th> </th><th>73</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>74</th><td class="r"><ins>&nbsp;`repository remove &lt;repos&gt;`::</ins> </td>
                  </tr><tr>
                          <th> </th><th>75</th><td class="r"><ins>&nbsp; &nbsp;Remove the repository `&lt;repos&gt;`.</ins> </td>
                  </tr><tr>
                          <th> </th><th>76</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>77</th><td class="r"><ins>&nbsp;`repository set &lt;repos&gt; &lt;key&gt; &lt;value&gt;`::</ins> </td>
                  </tr><tr>
                          <th> </th><th>78</th><td class="r"><ins>&nbsp; &nbsp;Set the attribute `&lt;key&gt;` to `&lt;value&gt;` for the repository `&lt;repos&gt;`. </ins> </td>
                  </tr><tr>
                          <th> </th><th>79</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>80</th><td class="r"><ins>Note that the default repository has an empty name, so it will likely need to be quoted when running `trac-admin` from a shell. Alternatively, the name "`(default)`" can be used instead, for example when running `trac-admin` in interactive mode.</ins> </td>
                  </tr><tr>
                          <th> </th><th>81</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>82</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>83</th><td class="r"><ins>== Repository synchronization == #Synchronization</ins> </td>
                  </tr><tr>
                          <th> </th><th>84</th><td class="r"><ins>Prior to 0.12, Trac synchronized its cache with the repository on every HTTP request. This approach is not very efficient and not practical anymore with multiple repositories. For this reason, explicit synchronization through post-commit hooks was added. </ins> </td>
                  </tr><tr>
                          <th> </th><th>85</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>86</th><td class="r"><ins>There is also new functionality in the form of a repository listener extension point ''(IRepositoryChangeListener)'' that is triggered by the post-commit hook when a changeset is added or modified, and can be used by plugins to perform actions on commit.</ins> </td>
                  </tr><tr>
                          <th> </th><th>87</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>88</th><td class="r"><ins>=== Mercurial Repositories ===</ins> </td>
                  </tr><tr>
                          <th> </th><th>89</th><td class="r"><ins>Please note that at the time of writing, no initial resynchronization or any hooks are necessary for Mercurial repositories - see [trac:#9485] for more information. </ins> </td>
                  </tr><tr>
                          <th> </th><th>90</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>91</th><td class="r"><ins>=== Explicit synchronization === #ExplicitSync</ins> </td>
                  </tr><tr>
                          <th> </th><th>92</th><td class="r"><ins>This is the preferred method of repository synchronization. It requires setting the `[trac]&nbsp; repository_sync_per_request` option in [wiki:TracIni#trac-section trac.ini] to an empty value, and adding a call to `trac-admin` in the post-commit hook of each repository. Additionally, if a repository allows changing revision metadata, a call to `trac-admin` must be added to the post-revprop-change hook as well.</ins> </td>
                  </tr><tr>
                          <th> </th><th>93</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>94</th><td class="r"><ins>&nbsp;`changeset added &lt;repos&gt; &lt;rev&gt; [...]`::</ins> </td>
                  </tr><tr>
                          <th> </th><th>95</th><td class="r"><ins>&nbsp; &nbsp;Notify Trac that one or more changesets have been added to a repository.</ins> </td>
                  </tr><tr>
                          <th> </th><th>96</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>97</th><td class="r"><ins>&nbsp;`changeset modified &lt;repos&gt; &lt;rev&gt; [...]`::</ins> </td>
                  </tr><tr>
                          <th> </th><th>98</th><td class="r"><ins>&nbsp; &nbsp;Notify Trac that metadata on one or more changesets in a repository has been modified.</ins> </td>
                  </tr><tr>
                          <th> </th><th>99</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>100</th><td class="r"><ins>The `&lt;repos&gt;` argument can be either a repository name (use "`(default)`" for the default repository) or the path to the repository.</ins> </td>
                  </tr><tr>
                          <th> </th><th>101</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>102</th><td class="r"><ins>Note that you may have to set the environment variable PYTHON_EGG_CACHE to the same value as was used for the web server configuration before calling trac-admin, if you changed it from its default location. See [wiki:TracPlugins Trac Plugins] for more information.</ins> </td>
                  </tr><tr>
                          <th> </th><th>103</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>104</th><td class="r"><ins>The following examples are complete post-commit and post-revprop-change scripts for Subversion. They should be edited for the specific environment, marked executable (where applicable) and placed in the `hooks` directory of each repository. On Unix (`post-commit`):</ins> </td>
                  </tr><tr>
                          <th> </th><th>105</th><td class="r"><ins>{{{#!sh</ins> </td>
                  </tr><tr>
                          <th> </th><th>106</th><td class="r"><ins>#!/bin/sh</ins> </td>
                  </tr><tr>
                          <th> </th><th>107</th><td class="r"><ins>export PYTHON_EGG_CACHE="/path/to/dir"</ins> </td>
                  </tr><tr>
                          <th> </th><th>108</th><td class="r"><ins>/usr/bin/trac-admin /path/to/env changeset added "$1" "$2"</ins> </td>
                  </tr><tr>
                          <th> </th><th>109</th><td class="r"><ins>}}}</ins> </td>
                  </tr><tr>
                          <th> </th><th>110</th><td class="r"><ins>On Windows (`post-commit.cmd`):</ins> </td>
                  </tr><tr>
                          <th> </th><th>111</th><td class="r"><ins>{{{#!application/x-dos-batch</ins> </td>
                  </tr><tr>
                          <th> </th><th>112</th><td class="r"><ins>@C:\Python26\Scripts\trac-admin.exe C:\path\to\env changeset added "%1" "%2"</ins> </td>
                  </tr><tr>
                          <th> </th><th>113</th><td class="r"><ins>}}}</ins> </td>
                  </tr><tr>
                          <th> </th><th>114</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>115</th><td class="r"><ins>The post-revprop-change hook for Subversion is very similar. On Unix (`post-revprop-change`):</ins> </td>
                  </tr><tr>
                          <th> </th><th>116</th><td class="r"><ins>{{{#!sh</ins> </td>
                  </tr><tr>
                          <th> </th><th>117</th><td class="r"><ins>#!/bin/sh</ins> </td>
                  </tr><tr>
                          <th> </th><th>118</th><td class="r"><ins>export PYTHON_EGG_CACHE="/path/to/dir"</ins> </td>
                  </tr><tr>
                          <th> </th><th>119</th><td class="r"><ins>/usr/bin/trac-admin /path/to/env changeset modified "$1" "$2"</ins> </td>
                  </tr><tr>
                          <th> </th><th>120</th><td class="r"><ins>}}}</ins> </td>
                  </tr><tr>
                          <th> </th><th>121</th><td class="r"><ins>On Windows (`post-revprop-change.cmd`):</ins> </td>
                  </tr><tr>
                          <th> </th><th>122</th><td class="r"><ins>{{{#!application/x-dos-batch</ins> </td>
                  </tr><tr>
                          <th> </th><th>123</th><td class="r"><ins>@C:\Python26\Scripts\trac-admin.exe C:\path\to\env changeset modified "%1" "%2"</ins> </td>
                  </tr><tr>
                          <th> </th><th>124</th><td class="r"><ins>}}}</ins> </td>
                  </tr><tr>
                          <th> </th><th>125</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>126</th><td class="r"><ins>The Unix variants above assume that the user running the Subversion commit has write access to the Trac environment, which is the case in the standard configuration where both the repository and Trac are served by the web server. If you access the repository through another means, for example `svn+ssh://`, you may have to run `trac-admin` with different privileges, for example by using `sudo`.</ins> </td>
                  </tr><tr>
                          <th> </th><th>127</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>128</th><td class="r"><ins>Note that calling `trac-admin` in your Subversion hooks can slow down the commit and log editing operations on the client side. You might want to use the [trac:source:trunk/contrib/trac-svn-hook contrib/trac-svn-hook] script which starts `trac-admin` in an asynchronous way. The script also comes with a number of safety checks and usage advices which should make it easier to set up and test your hooks. There's no equivalent `trac-svn-hook.bat` for Windows yet, but the script can be run by Cygwin's bash.</ins> </td>
                  </tr><tr>
                          <th> </th><th>129</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>130</th><td class="r"><ins>See the [http://svnbook.red-bean.com/en/1.5/svn.reposadmin.create.html#svn.reposadmin.create.hooks section about hooks] in the Subversion book for more information. Other repository types will require different hook setups.</ins> </td>
                  </tr><tr>
                          <th> </th><th>131</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>132</th><td class="r"><ins>Git hooks can be used in the same way for explicit syncing of git repositories. Add the following to `.git/hooks/post-commit`:</ins> </td>
                  </tr><tr>
                          <th> </th><th>133</th><td class="r"><ins>{{{#!sh</ins> </td>
                  </tr><tr>
                          <th> </th><th>134</th><td class="r"><ins>REV=$(git rev-parse HEAD)</ins> </td>
                  </tr><tr>
                          <th> </th><th>135</th><td class="r"><ins>trac-admin /path/to/env changeset added &lt;my-repository&gt; $REV</ins> </td>
                  </tr><tr>
                          <th> </th><th>136</th><td class="r"><ins>}}}</ins> </td>
                  </tr><tr>
                          <th> </th><th>137</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>138</th><td class="r"><ins>For Mercurial, add the following entries to the `.hgrc` file of each repository accessed by Trac (if [trac:TracMercurial] is installed in a Trac `plugins` directory, download [source:plugins/0.13/mercurial-plugin/tracext/hg/hooks.py hooks.py] and place it somewhere accessible):</ins> </td>
                  </tr><tr>
                          <th> </th><th>139</th><td class="r"><ins>{{{#!ini</ins> </td>
                  </tr><tr>
                          <th> </th><th>140</th><td class="r"><ins>[hooks]</ins> </td>
                  </tr><tr>
                          <th> </th><th>141</th><td class="r"><ins>; If mercurial-plugin is installed globally</ins> </td>
                  </tr><tr>
                          <th> </th><th>142</th><td class="r"><ins>commit = python:tracext.hg.hooks.add_changesets</ins> </td>
                  </tr><tr>
                          <th> </th><th>143</th><td class="r"><ins>changegroup = python:tracext.hg.hooks.add_changesets</ins> </td>
                  </tr><tr>
                          <th> </th><th>144</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>145</th><td class="r"><ins>; If mercurial-plugin is installed in a Trac plugins directory</ins> </td>
                  </tr><tr>
                          <th> </th><th>146</th><td class="r"><ins>commit = python:/path/to/hooks.py:add_changesets</ins> </td>
                  </tr><tr>
                          <th> </th><th>147</th><td class="r"><ins>changegroup = python:/path/to/hooks.py:add_changesets</ins> </td>
                  </tr><tr>
                          <th> </th><th>148</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>149</th><td class="r"><ins>[trac]</ins> </td>
                  </tr><tr>
                          <th> </th><th>150</th><td class="r"><ins>env = /path/to/env</ins> </td>
                  </tr><tr>
                          <th> </th><th>151</th><td class="r"><ins>trac-admin = /path/to/trac-admin</ins> </td>
                  </tr><tr>
                          <th> </th><th>152</th><td class="r"><ins>}}}</ins> </td>
                  </tr><tr>
                          <th> </th><th>153</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>154</th><td class="r"><ins>=== Per-request synchronization === #PerRequestSync</ins> </td>
                  </tr><tr>
                          <th> </th><th>155</th><td class="r"><ins>If the post-commit hooks are not available, the environment can be set up for per-request synchronization. In that case, the `[trac] repository_sync_per_request` option in [wiki:TracIni#trac-section trac.ini] must be set to a comma-separated list of repository names to be synchronized.</ins> </td>
                  </tr><tr>
                          <th> </th><th>156</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>157</th><td class="r"><ins>Note that in this case, the changeset listener extension point is not called, and therefore plugins using it will not work correctly.</ins> </td>
                  </tr><tr>
                          <th> </th><th>158</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>159</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>160</th><td class="r"><ins>== Migration from a single-repository setup (Subversion) == #Migration</ins> </td>
                  </tr><tr>
                          <th> </th><th>161</th><td class="r"><ins>The following procedure illustrates a typical migration from a Subversion single-repository setup to multiple repositories.</ins> </td>
                  </tr><tr>
                          <th> </th><th>162</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>163</th><td class="r"><ins>&nbsp;1. Remove the default repository specification from the `[trac] repository_dir` option.</ins> </td>
                  </tr><tr>
                          <th> </th><th>164</th><td class="r"><ins>&nbsp;1. Add the main repository as a named repository.</ins> </td>
                  </tr><tr>
                          <th> </th><th>165</th><td class="r"><ins>&nbsp;1. Re-synchronize the main repository.</ins> </td>
                  </tr><tr>
                          <th> </th><th>166</th><td class="r"><ins>&nbsp;1. Set up post-commit and post-revprop-change hooks on the "main" repository, and set `[trac] repository_sync_per_request` to an empty value.</ins> </td>
                  </tr><tr>
                          <th> </th><th>167</th><td class="r"><ins>&nbsp;1. Add an alias to the main repository as the default repository (by leaving out the the `name`, e.g. `.alias = main`). This ensures that all links predating the migration still resolve to the main repository.</ins> </td>
                  </tr><tr>
                          <th> </th><th>168</th><td class="r"><ins>&nbsp;1. Repeat steps 2, 3 and 4 to add other "named" repositories as needed.</ins> </td>
                  </tr><tr>
                          <th> </th><th>169</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>170</th><td class="r"><ins>== Migration from a single-repository setup (Mercurial) == #MigrationMercurial</ins> </td>
                  </tr><tr>
                          <th> </th><th>171</th><td class="r"><ins>The following procedure illustrates a typical migration from a Mercurial single-repository setup to multiple repositories. Please note that at the time of writing, no initial resynchronization or any hooks are necessary for Mercurial repositories - see #9485 for more information.</ins> </td>
                  </tr><tr>
                          <th> </th><th>172</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>173</th><td class="r"><ins>&nbsp;1. Upgrade to the latest version of the TracMercurial plugin.</ins> </td>
                  </tr><tr>
                          <th> </th><th>174</th><td class="r"><ins>&nbsp;1. Remove the default repository specification from the `[trac] repository_dir` option.</ins> </td>
                  </tr><tr>
                          <th> </th><th>175</th><td class="r"><ins>&nbsp;1. Add the main repository as a named repository.</ins> </td>
                  </tr><tr>
                          <th> </th><th>176</th><td class="r"><ins>&nbsp;1. Add an alias to the main repository as the default repository (by leaving out the the `name`, e.g. `.alias = main`). This ensures that all links predating the migration still resolve to the main repository.</ins> </td>
                  </tr><tr>
                          <th> </th><th>177</th><td class="r"><ins>&nbsp;1. Repeat step 3 to add other "named" repositories as needed.</ins> </td>
                  </tr><tr>
                          <th> </th><th>178</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>179</th><td class="r"><ins>== Troubleshooting ==</ins> </td>
                  </tr><tr>
                          <th> </th><th>180</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>181</th><td class="r"><ins>=== My trac-post-commit-hook doesn't work anymore === #trac-post-commit-hook</ins> </td>
                  </tr><tr>
                          <th> </th><th>182</th><td class="r"><ins></ins> </td>
                  </tr><tr class="last">
                          <th> </th><th>183</th><td class="r"><ins>You must now use the optional components from `tracopt.ticket.commit_updater.*`, which you can activate through the Plugins panel in the Administrative part of the web interface, or by directly modifying the [TracIni#components-section "[components]"] section in the trac.ini. Be sure to use [#ExplicitSync explicit synchronization] as explained above.</ins> </td>
                  </tr>
            </tbody>
        </table>
      </li>
  </ul>
</div>
      </div>
  </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="../chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Powered by <a href="../about.html"><strong>Trac 0.12.3</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right">Visit the Trac open source project at<br /><a href="http://trac.edgewall.org/">http://trac.edgewall.org/</a></p>
    </div>
  </body>
</html>
