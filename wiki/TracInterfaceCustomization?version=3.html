<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  


  <head>
    <title>
      TracInterfaceCustomization – CKAN
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <!--[if IE]><script type="text/javascript">window.location.hash = window.location.hash;</script><![endif]-->
        <link rel="search" href="../search.html" />
        <link rel="help" href="TracGuide.html" />
        <link rel="alternate" href="TracInterfaceCustomization%3Fversion=3&amp;format=txt" type="text/x-trac-wiki" title="Plain Text" />
        <link rel="up" href="TracInterfaceCustomization.html" title="View latest version" />
        <link rel="next" href="TracInterfaceCustomization%3Fversion=4.html" title="Version 4" />
        <link rel="start" href="../wiki.1.html" />
        <link rel="stylesheet" href="../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../chrome/common/css/wiki.css" type="text/css" />
        <link rel="prev" href="TracInterfaceCustomization%3Fversion=2.html" title="Version 2" />
        <link rel="shortcut icon" href="../chrome/common/trac.ico" type="image/x-icon" />
        <link rel="icon" href="../chrome/common/trac.ico" type="image/x-icon" />
      <link type="application/opensearchdescription+xml" rel="search" href="../search/opensearch" title="Search CKAN" />
    <script type="text/javascript" src="../chrome/common/js/jquery.js"></script><script type="text/javascript" src="../chrome/common/js/babel.js"></script><script type="text/javascript" src="../chrome/common/js/messages/en_US.js"></script><script type="text/javascript" src="../chrome/common/js/trac.js"></script><script type="text/javascript" src="../chrome/common/js/search.js"></script><script type="text/javascript" src="../chrome/common/js/folding.js"></script>
    <!--[if lt IE 7]>
    <script type="text/javascript" src="/chrome/common/js/ie_pre7_hacks.js"></script>
    <![endif]-->
    <meta name="ROBOTS" content="NOINDEX, NOFOLLOW" />
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("#content").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $("#content").find(".wikianchor").each(function() {
          $(this).addAnchor(babel.format(_("Link to #%(id)s"), {id: $(this).attr('id')}));
        });
        $(".foldable").enableFolding(true, true);
      });
    </script>
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="http://ckan.org/"><img src="http://assets.okfn.org/p/ckan/img/ckan_logo_shortname.png" alt="CKAN Trac" height="70" /></a>
      </div>
      <form id="search" action="../search.html" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Search" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="../login.html">Login</a></li><li><a href="../prefs.html">Preferences</a></li><li><a href="TracGuide.html">Help/Guide</a></li><li><a href="../about.html">About Trac</a></li><li class="last"><a href="../register.html">Register</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first"><a href="../timeline.html">Timeline</a></li><li><a href="../roadmap.html">Roadmap</a></li><li><a href="../report.html">View Tickets</a></li><li><a href="../search.html">Search</a></li><li class="last active"><a href="../wiki.1.html">Wiki</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="pagepath" class="noprint">
  <a class="pathentry first" title="View WikiStart" href="../wiki.1.html">wiki:</a><a class="pathentry" href="TracInterfaceCustomization.html" title="View TracInterfaceCustomization">TracInterfaceCustomization</a>
</div>
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
          <ul>
              <li class="first"><span>&larr; <a class="prev" href="TracInterfaceCustomization%3Fversion=2.html" title="Version 2">Previous Version</a></span></li><li><a href="TracInterfaceCustomization.html" title="View latest version">View Latest Version</a></li><li class="last"><span><a class="next" href="TracInterfaceCustomization%3Fversion=4.html" title="Version 4">Next Version</a> &rarr;</span></li>
          </ul>
        <hr />
      </div>
    <div id="content" class="wiki">
        <br />
        <table id="info" summary="Revision info">
          <tbody>
            <tr><th scope="row">Version 3 (modified by trac, <a class="timeline" href="../timeline%3Ffrom=2009-05-28T11:13:09Z&amp;precision=second.html" title="2009-05-28T11:13:09Z in Timeline">5 years</a> ago)
               (<a href="TracInterfaceCustomization%3Faction=diff&amp;version=3.html">diff</a>)</th></tr>
            <tr><td class="message">
              <p>
--
</p>

            </td></tr>
          </tbody>
        </table>
      <div class="wikipage searchable">
        
          
          
          <div id="wikipage"><h1 id="CustomizingtheTracInterface">Customizing the Trac Interface</h1>
<p>
</p><div class="wiki-toc"><h4>Table of Contents</h4><ul><li class="False"><a class="False" href="TracGuide.html">Index</a></li><li class="False"><a class="False" href="TracInstall.html">Installation</a></li><li class="active"><a class="False" href="TracInterfaceCustomization.html">Customization</a></li><li class="False"><a class="False" href="TracPlugins.html">Plugins</a></li><li class="False"><a class="False" href="TracUpgrade.html">Upgrading</a></li><li class="False"><a class="False" href="TracIni.html">Configuration</a></li><li class="False"><a class="False" href="TracAdmin.html">Administration</a></li><li class="False"><a class="False" href="TracBackup.html">Backup</a></li><li class="False"><a class="False" href="TracLogging.html">Logging</a></li><li class="False"><a class="False" href="TracPermissions.html">Permissions</a></li><li class="False"><a class="False" href="TracWiki.html">The Wiki</a></li><li class="False"><a class="False" href="WikiFormatting.html">Wiki Formatting</a></li><li class="False"><a class="False" href="TracTimeline.html">Timeline</a></li><li class="False"><a class="False" href="TracBrowser.html">Repository Browser</a></li><li class="False"><a class="False" href="TracRevisionLog.html">Revision Log</a></li><li class="False"><a class="False" href="TracChangeset.html">Changesets</a></li><li class="False"><a class="False" href="TracTickets.html">Tickets</a></li><li class="False"><a class="False" href="TracWorkflow.html">Workflow</a></li><li class="False"><a class="False" href="TracRoadmap.html">Roadmap</a></li><li class="False"><a class="False" href="TracQuery.html">Ticket Queries</a></li><li class="False"><a class="False" href="TracReports.html">Reports</a></li><li class="False"><a class="False" href="TracRss.html">RSS Support</a></li><li class="False"><a class="False" href="TracNotification.html">Notification</a></li></ul></div><p>
</p>
<h2 id="Introduction">Introduction</h2>
<p>
This page is meant to give users suggestions on how they can customize the look of Trac.  Topics on this page cover editing the HTML templates and CSS files, but not the program code itself.  The topics are intended to show users how they can modify the look of Trac to meet their specific needs.  Suggestions for changes to Trac's interface applicable to all users should be filed as tickets, not listed on this page.
</p>
<h2 id="ProjectLogoandIcon">Project Logo and Icon</h2>
<p>
The easiest parts of the Trac interface to customize are the logo and the site icon.  Both of these can be configured with settings in <a class="wiki" href="TracIni.html">trac.ini</a>.
</p>
<p>
The logo or icon image should be put in a folder named "htdocs" in your project's environment folder.  (<em>Note: in projects created with a Trac version prior to 0.9 you will need to create this folder</em>)
</p>
<blockquote>
<p>
<em>Note: you can actually put the logo and icon anywhere on your server (as long as it's accessible through the web server), and use their absolute or server-relative URLs in the configuration.</em>
</p>
</blockquote>
<p>
Now configure the appropriate section of your <a class="wiki" href="TracIni.html">trac.ini</a>:
</p>
<h3 id="Logo">Logo</h3>
<p>
Change the <tt>src</tt> setting to <tt>site/</tt> followed by the name of your image file.  The <tt>width</tt> and <tt>height</tt> settings should be modified to match your image's dimensions (the Trac chrome handler uses "<tt>site/</tt>" for files within the project directory <tt>htdocs</tt> and "<tt>common/</tt>" for the common ones).
</p>
<pre class="wiki">[header_logo]
src = site/my_logo.gif
alt = My Project
width = 300
height = 100
</pre><h3 id="Icon">Icon</h3>
<p>
Icons should be a 16x16 image in <tt>.gif</tt> or <tt>.ico</tt> format.  Change the <tt>icon</tt> setting to <tt>site/</tt> followed by the name of your icon file.  Icons will typically be displayed by your web browser next to the site's URL and in the <tt>Bookmarks</tt> menu.
</p>
<pre class="wiki">[project]
icon = site/my_icon.ico
</pre><p>
Note though that this icon is ignored by Internet Explorer, which only accepts a file named <tt></tt>favicon.ico<tt></tt> at the root of the host. To make the project icon work in both IE and other browsers, you can store the icon in the document root of the host, and reference it from <tt></tt>trac.ini<tt></tt> as follows:
</p>
<pre class="wiki">[project]
icon = /favicon.ico
</pre><h2 id="CustomNavigationEntries">Custom Navigation Entries</h2>
<p>
The new [mainnav] and [metanav] can now be used to customize the text and link used for the navigation items, or even to disable them (but not for adding new ones).
</p>
<p>
In the following example, we rename the link to the Wiki start "Home", and hide the "<a class="missing wiki">Help/Guide?</a>". We also make the "View Tickets" entry link to a specific report .
</p>
<pre class="wiki">[mainnav]
wiki.label = Home
tickets.href = /report/24

[metanav]
help = disabled
</pre><p>
See also <a class="wiki" href="TracNavigation.html">TracNavigation</a> for a more detailed explanation of the mainnav and metanav terms.
</p>
<h2 id="SiteAppearance">Site Appearance</h2>
<p>
Trac is using <a class="ext-link" href="http://genshi.edgewall.org"><span class="icon">​</span>Genshi</a> as the templating engine. Documentation is yet to be written, in the meantime the following tip should work.
</p>
<p>
Say you want to add a link to a custom stylesheet, and then your own
header and footer.  Create a file <tt>/path/to/env/templates/site.html</tt> or <tt>/path/to/inherit/option/templates_dir/site.html</tt>, with contents like this:
</p>
<div class="code"><pre><span class="nt">&lt;html</span> <span class="na">xmlns=</span><span class="s">"http://www.w3.org/1999/xhtml"</span>
      <span class="na">xmlns:py=</span><span class="s">"http://genshi.edgewall.org/"</span>
      <span class="na">py:strip=</span><span class="s">""</span><span class="nt">&gt;</span>

  <span class="c">&lt;!--! Add site-specific style sheet --&gt;</span>
  <span class="nt">&lt;head</span> <span class="na">py:match=</span><span class="s">"head"</span> <span class="na">py:attrs=</span><span class="s">"select('@*')"</span><span class="nt">&gt;</span>
    ${select('*|comment()|text()')}
    <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">type=</span><span class="s">"text/css"</span>
          <span class="na">href=</span><span class="s">"${href.chrome('site/style.css')}"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/head&gt;</span>

  <span class="nt">&lt;body</span> <span class="na">py:match=</span><span class="s">"body"</span> <span class="na">py:attrs=</span><span class="s">"select('@*')"</span><span class="nt">&gt;</span>
    <span class="c">&lt;!--! Add site-specific header --&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"siteheader"</span><span class="nt">&gt;</span>
      <span class="c">&lt;!--! Place your header content here... --&gt;</span>
    <span class="nt">&lt;/div&gt;</span>

    ${select('*|text()')}

    <span class="c">&lt;!--! Add site-specific footer --&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"sitefooter"</span><span class="nt">&gt;</span>
      <span class="c">&lt;!--! Place your footer content here... --&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div><p>
Note that this references your environment's <tt>htdocs/style.css</tt>.
</p>
<p>
Example snippet of adding introduction text to the new ticket form (hide when preview):
</p>
<div class="code"><pre><span class="nt">&lt;form</span> <span class="na">py:match=</span><span class="s">"div[@id='content' and @class='ticket']/form"</span> <span class="na">py:attrs=</span><span class="s">"select('@*')"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;py:if</span> <span class="na">test=</span><span class="s">"req.environ['PATH_INFO'] == '/newticket' and (not 'preview' in req.args)"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;p&gt;</span>Please make sure to search for existing tickets before reporting a new one!<span class="nt">&lt;/p&gt;</span>
  <span class="nt">&lt;/py:if&gt;</span>
  ${select('*')} 
<span class="nt">&lt;/form&gt;</span>
</pre></div><p>
If the environment is upgraded from 0.10 and a <tt>site_newticket.cs</tt> file already exists, it can actually be loaded by using a workaroud - providing it contains no <a class="missing wiki">ClearSilver?</a> processing. In addition, as only one element can be imported, the content needs some sort of wrapper such as a <tt>&lt;div&gt;</tt> block or other similar parent container. The XInclude namespace must be specified to allow includes, but that can be moved to document root along with the others:
</p>
<div class="code"><pre><span class="nt">&lt;form</span> <span class="na">py:match=</span><span class="s">"div[@id='content' and @class='ticket']/form"</span> <span class="na">py:attrs=</span><span class="s">"select('@*')"</span>
        <span class="na">xmlns:xi=</span><span class="s">"http://www.w3.org/2001/XInclude"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;py:if</span> <span class="na">test=</span><span class="s">"req.environ['PATH_INFO'] == '/newticket' and (not 'preview' in req.args)"</span><span class="nt">&gt;</span> 
    <span class="nt">&lt;xi:include</span> <span class="na">href=</span><span class="s">"site_newticket.cs"</span><span class="nt">&gt;&lt;xi:fallback</span> <span class="nt">/&gt;&lt;/xi:include&gt;</span>
  <span class="nt">&lt;/py:if&gt;</span>
  ${select('*')} 
<span class="nt">&lt;/form&gt;</span>
</pre></div><p>
Also note that the <tt>site.html</tt> (despite its name) can be put in a common templates directory - see the <tt>[inherit] templates_dir</tt> option. This could provide easier maintainence (and a migration path from 0.10 for larger installations) as one new global <tt>site.html</tt> file can be made to include any existing header, footer and newticket snippets.
</p>
<h2 id="ProjectList">Project List</h2>
<p>
You can use a custom Genshi template to display the list of projects if you are using Trac with multiple projects.  
</p>
<p>
The following is the basic template used by Trac to display a list of links to the projects.  For projects that could not be loaded it displays an error message. You can use this as a starting point for your own index template.
</p>
<div class="code"><pre><span class="cp">&lt;!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;</span>
<span class="nt">&lt;html</span> <span class="na">xmlns=</span><span class="s">"http://www.w3.org/1999/xhtml"</span>
      <span class="na">xmlns:py=</span><span class="s">"http://genshi.edgewall.org/"</span>
      <span class="na">xmlns:xi=</span><span class="s">"http://www.w3.org/2001/XInclude"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;title&gt;</span>Available Projects<span class="nt">&lt;/title&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;h1&gt;</span>Available Projects<span class="nt">&lt;/h1&gt;</span>
    <span class="nt">&lt;ul&gt;</span>
      <span class="nt">&lt;li</span> <span class="na">py:for=</span><span class="s">"project in projects"</span> <span class="na">py:choose=</span><span class="s">""</span><span class="nt">&gt;</span>
        <span class="nt">&lt;a</span> <span class="na">py:when=</span><span class="s">"project.href"</span> <span class="na">href=</span><span class="s">"$project.href"</span>
           <span class="na">title=</span><span class="s">"$project.description"</span><span class="nt">&gt;</span>$project.name<span class="nt">&lt;/a&gt;</span>
        <span class="nt">&lt;py:otherwise&gt;</span>
          <span class="nt">&lt;small&gt;</span>$project.name: <span class="nt">&lt;em&gt;</span>Error<span class="nt">&lt;/em&gt;</span> <span class="nt">&lt;br</span> <span class="nt">/&gt;</span> ($project.description)<span class="nt">&lt;/small&gt;</span>
        <span class="nt">&lt;/py:otherwise&gt;</span>
      <span class="nt">&lt;/li&gt;</span>
    <span class="nt">&lt;/ul&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div><p>
Once you've created your custom template you will need to configure the webserver to tell Trac where the template is located (pls verify ... not yet changed to 0.11):
</p>
<p>
For <a class="wiki" href="TracFastCgi.html">FastCGI</a>:
</p>
<pre class="wiki">FastCgiConfig -initial-env TRAC_ENV_PARENT_DIR=/parent/dir/of/projects \
              -initial-env TRAC_ENV_INDEX_TEMPLATE=/path/to/template
</pre><p>
For <a class="wiki" href="TracModPython.html">mod_python</a>:
</p>
<pre class="wiki">PythonOption TracEnvIndexTemplate /path/to/template
</pre><p>
For <a class="wiki" href="TracCgi.html">CGI</a>:
</p>
<pre class="wiki">SetEnv TRAC_ENV_INDEX_TEMPLATE /path/to/template
</pre><p>
For <a class="wiki" href="TracStandalone.html">TracStandalone</a>, you'll need to set up the <tt>TRAC_ENV_INDEX_TEMPLATE</tt> environment variable in the shell used to launch tracd:
</p>
<ul><li>Unix
<div class="code"><pre><span class="nv">$ </span><span class="nb">export </span><span class="nv">TRAC_ENV_INDEX_TEMPLATE</span><span class="o">=</span>/path/to/template
</pre></div></li><li>Windows
<div class="code"><pre><span class="nv">$ </span><span class="nb">set </span><span class="nv">TRAC_ENV_INDEX_TEMPLATE</span><span class="o">=</span>/path/to/template
</pre></div></li></ul><hr />
<p>
See also <a class="wiki" href="TracGuide.html">TracGuide</a>, <a class="wiki" href="TracIni.html">TracIni</a>
</p>
</div>
        
        
      </div>
      

    </div>
    <script type="text/javascript">
        jQuery.loadStyleSheet("/pygments/trac.css", "text/css");
    </script>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="last first">
          <a rel="nofollow" href="TracInterfaceCustomization%3Fversion=3&amp;format=txt">Plain Text</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="../chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Powered by <a href="../about.html"><strong>Trac 0.12.3</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right">Visit the Trac open source project at<br /><a href="http://trac.edgewall.org/">http://trac.edgewall.org/</a></p>
    </div>
  </body>
</html>