<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  


  <head>
    <title>
      {22} Trac tickets – CKAN
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <!--[if IE]><script type="text/javascript">window.location.hash = window.location.hash;</script><![endif]-->
        <link rel="search" href="../search.html" />
        <link rel="help" href="../wiki/TracGuide.html" />
        <link rel="alternate" href="22%3Fsort=reporter&amp;asc=0&amp;format=rss" type="application/rss+xml" class="rss" title="RSS Feed" /><link rel="alternate" href="22%3Fsort=reporter&amp;asc=0&amp;format=csv" type="text/plain" title="Comma-delimited Text" /><link rel="alternate" href="22%3Fsort=reporter&amp;asc=0&amp;format=tab" type="text/plain" title="Tab-delimited Text" /><link rel="alternate" href="../report%3Fid=22&amp;format=sql" type="text/plain" title="SQL Query" />
        <link rel="up" href="../report.html" title="Available Reports" />
        <link rel="next" href="22%3Fsort=reporter&amp;asc=0&amp;page=24.html" title="Next Page" />
        <link rel="start" href="../wiki.1.html" />
        <link rel="stylesheet" href="../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../chrome/common/css/report.css" type="text/css" />
        <link rel="prev" href="22%3Fsort=reporter&amp;asc=0&amp;page=22.html" title="Previous Page" />
        <link rel="shortcut icon" href="../chrome/common/trac.ico" type="image/x-icon" />
        <link rel="icon" href="../chrome/common/trac.ico" type="image/x-icon" />
      <link type="application/opensearchdescription+xml" rel="search" href="../search/opensearch" title="Search CKAN" />
    <script type="text/javascript" src="../chrome/common/js/jquery.js"></script><script type="text/javascript" src="../chrome/common/js/babel.js"></script><script type="text/javascript" src="../chrome/common/js/messages/en_US.js"></script><script type="text/javascript" src="../chrome/common/js/trac.js"></script><script type="text/javascript" src="../chrome/common/js/search.js"></script>
    <!--[if lt IE 7]>
    <script type="text/javascript" src="/chrome/common/js/ie_pre7_hacks.js"></script>
    <![endif]-->
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="http://ckan.org/"><img src="http://assets.okfn.org/p/ckan/img/ckan_logo_shortname.png" alt="CKAN Trac" height="70" /></a>
      </div>
      <form id="search" action="../search.html" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Search" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="../login.html">Login</a></li><li><a href="../prefs.html">Preferences</a></li><li><a href="../wiki/TracGuide.html">Help/Guide</a></li><li><a href="../about.html">About Trac</a></li><li class="last"><a href="../register.html">Register</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first"><a href="../timeline.html">Timeline</a></li><li><a href="../roadmap.html">Roadmap</a></li><li class="active"><a href="../report.html">View Tickets</a></li><li><a href="../search.html">Search</a></li><li class="last"><a href="../wiki.1.html">Wiki</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
          <ul>
              <li class="first"><a href="../report.html">Available Reports</a></li><li class="last"><a href="../query.html">Custom Query</a></li>
          </ul>
        <hr />
      </div>
    <div id="content" class="report">
      <h1>{22} Trac tickets
        <span class="numrows">(2647 matches)</span>
      </h1>
      <form method="get" action="22%3Fsort=reporter&amp;asc=0&amp;page=23.html">
        <div id="prefs">
          <div>
            <label>
              Max items per page
              <input type="text" name="max" size="10" value="100" />
            </label>
          </div>
          <div class="buttons">
            <input type="submit" value="Update" />
          </div>
        </div>
      </form>
      <div id="description">
        <p>
<a class="ext-link" href="https://github.com/roskakori/tratihubis/blob/master/query_tickets.sql"><span class="icon">​</span>https://github.com/roskakori/tratihubis/blob/master/query_tickets.sql</a>
</p>

      </div>
      <div class="buttons">
      </div>
      <h2 class="report-result">
        Results <span class="numresults">(2201 - 2300 of 2647)</span>
      </h2>
      <div class="paging">
    <span class="previous">
      <a href="22%3Fsort=reporter&amp;asc=0&amp;page=22.html" title="Previous Page">←</a>
    </span>
      <span>
        <a href="22%3Fsort=reporter&amp;asc=0&amp;page=13.html" title="Page 13">13</a>
      </span>
      <span>
        <a href="22%3Fsort=reporter&amp;asc=0&amp;page=14.html" title="Page 14">14</a>
      </span>
      <span>
        <a href="22%3Fsort=reporter&amp;asc=0&amp;page=15.html" title="Page 15">15</a>
      </span>
      <span>
        <a href="22%3Fsort=reporter&amp;asc=0&amp;page=16.html" title="Page 16">16</a>
      </span>
      <span>
        <a href="22%3Fsort=reporter&amp;asc=0&amp;page=17.html" title="Page 17">17</a>
      </span>
      <span>
        <a href="22%3Fsort=reporter&amp;asc=0&amp;page=18.html" title="Page 18">18</a>
      </span>
      <span>
        <a href="22%3Fsort=reporter&amp;asc=0&amp;page=19.html" title="Page 19">19</a>
      </span>
      <span>
        <a href="22%3Fsort=reporter&amp;asc=0&amp;page=20.html" title="Page 20">20</a>
      </span>
      <span>
        <a href="22%3Fsort=reporter&amp;asc=0&amp;page=21.html" title="Page 21">21</a>
      </span>
      <span>
        <a href="22%3Fsort=reporter&amp;asc=0&amp;page=22.html" title="Page 22">22</a>
      </span>
      <span>
        <span class="current">23</span>
      </span>
      <span>
        <a href="22%3Fsort=reporter&amp;asc=0&amp;page=24.html" title="Page 24">24</a>
      </span>
      <span>
        <a href="22%3Fsort=reporter&amp;asc=0&amp;page=25.html" title="Page 25">25</a>
      </span>
      <span>
        <a href="22%3Fsort=reporter&amp;asc=0&amp;page=26.html" title="Page 26">26</a>
      </span>
      <span>
        <a href="22%3Fsort=reporter&amp;asc=0&amp;page=27.html" title="Page 27">27</a>
      </span>
    <span class="next">
      <a href="22%3Fsort=reporter&amp;asc=0&amp;page=24.html" title="Next Page">→</a>
    </span>
</div>
      <table class="listing tickets">
          <thead>
        <tr class="trac-columns">
          <th>
            <a href="22%3Fsort=id&amp;asc=1&amp;page=23.html">
              Id
            </a>
          </th><th>
            <a href="22%3Fsort=type&amp;asc=1&amp;page=23.html">
              Type
            </a>
          </th><th>
            <a href="22%3Fsort=owner&amp;asc=1&amp;page=23.html">
              Owner
            </a>
          </th><th class="desc">
            <a href="22%3Fsort=reporter&amp;asc=1&amp;page=23.html">
              Reporter
            </a>
          </th><th>
            <a href="22%3Fsort=milestone&amp;asc=1&amp;page=23.html">
              Milestone
            </a>
          </th><th>
            <a href="22%3Fsort=status&amp;asc=1&amp;page=23.html">
              Status
            </a>
          </th><th>
            <a href="22%3Fsort=resolution&amp;asc=1&amp;page=23.html">
              Resolution
            </a>
          </th><th>
            <a href="22%3Fsort=summary&amp;asc=1&amp;page=23.html">
              Summary
            </a>
          </th><th>
            <a href="22%3Fsort=description&amp;asc=1&amp;page=23.html">
              Description
            </a>
          </th><th>
            <a href="22%3Fsort=PosixTime&amp;asc=1&amp;page=23.html">
              Posixtime
            </a>
          </th><th colspan="100">
            <a href="22%3Fsort=ModifiedTime&amp;asc=1&amp;page=23.html">
              Modifiedtime
            </a>
          </th>
        </tr>
          </thead>
          <tbody>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1067.html">#1067</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.4-sprint-5.html">ckan-v1.4-sprint-5</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1067.html">CLI for loading/dumping complete databases</a>
                          </td>
                          <td class="description">
                            <p>
Use 'db dump' and 'db load' for 'pg_dump' and 'psql -f' of a database. Use pylons config to find out database options.
</p>

                            
                          </td>
                          <td class="PosixTime">1301645463000000
                          </td>
                          <td class="ModifiedTime">1302186503000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1068.html">#1068</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.4-sprint-5.html">ckan-v1.4-sprint-5</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1068.html">metadata_modified problem</a>
                          </td>
                          <td class="description">
                            <p>
This test has been failing since the clocks changed:
</p>
<pre class="wiki">======================================================================
FAIL: ckan.tests.models.test_package.TestPackageRevisions.test_02_metadata_created_and_modified
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/home/dread/hgroot/pyenv-ckan2/lib/python2.6/site-packages/nose-0.11.3-py2.6.egg/nose/case.py", line 186, in runTest
    self.test(*self.arg)
  File "/home/dread/hgroot/ckan2/ckan/tests/models/test_package.py", line 283, in test_02_metadata_created_and_modified
    assert out == exp, (out, exp)
AssertionError: (datetime.datetime(2011, 4, 1, 10, 45, 50, 875509), datetime.datetime(2011, 4, 1, 9, 45, 50, 875509))

----------------------------------------------------------------------
</pre>
                            
                          </td>
                          <td class="PosixTime">1301652085000000
                          </td>
                          <td class="ModifiedTime">1302109505000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1071.html">#1071</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.4-sprint-5.html">ckan-v1.4-sprint-5</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1071.html">Package history API moved to /api/rest/package/revisions</a>
                          </td>
                          <td class="description">
                            <p>
api/rest/package_history is not RESTful or follow API naming conventions. Therefore move it to /api/rest/package/revisions
</p>
<p>
Also, API docs incomplete.
</p>

                            
                          </td>
                          <td class="PosixTime">1301937882000000
                          </td>
                          <td class="ModifiedTime">1301943180000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1072.html">#1072</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.4-sprint-5.html">ckan-v1.4-sprint-5</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1072.html">Add filters to authztool</a>
                          </td>
                          <td class="description">
                            <p>
It takes several minutes to print the 'rights' on DGU, which is annoying when you only want to grep for a few lines. Much quicker than grepping is to filter in the query.
</p>

                            
                          </td>
                          <td class="PosixTime">1302106311000000
                          </td>
                          <td class="ModifiedTime">1302106474000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1073.html">#1073</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.4-sprint-5.html">ckan-v1.4-sprint-5</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1073.html">Search index checker</a>
                          </td>
                          <td class="description">
                            <p>
Tool that checks which packages have not been indexed.
</p>
<p>
Required for DGU: <a class="ext-link" href="https://trac.dataco.coi.gov.uk/projects/datagov/ticket/940"><span class="icon">​</span>https://trac.dataco.coi.gov.uk/projects/datagov/ticket/940</a>
</p>

                            
                          </td>
                          <td class="PosixTime">1302185444000000
                          </td>
                          <td class="ModifiedTime">1302185825000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1089.html">#1089</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.4-sprint-6.html">ckan-v1.4-sprint-6</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1089.html">Check for "--ckan" when running nosetests</a>
                          </td>
                          <td class="description">
                            <p>
(because if you forget, you get difficult to understand errors, and more than one person has tripped up on this)
</p>

                            
                          </td>
                          <td class="PosixTime">1302631189000000
                          </td>
                          <td class="ModifiedTime">1302631733000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1090.html">#1090</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.4-sprint-6.html">ckan-v1.4-sprint-6</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1090.html">Visitor can't create packages on new CKAN install</a>
                          </td>
                          <td class="description">
                            <p>
Default visitor roles in default config is reader, not anon_editor. 
</p>
<p>
Problem caused by changes in <a class="closed ticket" href="../ticket/1066.html" title="enhancement: Default reader role too permissive (closed: fixed)">#1066</a> (released in 1.3.3)
</p>
<p>
New installs will be affected, although simple to just increase permissions when the installer realises a visitor can't create packages.
</p>
<p>
The solution to the config getting out of sync with the code like this is to not have the default_roles in the config - refer to the code in the configuration instructions.
</p>

                            
                          </td>
                          <td class="PosixTime">1302635219000000
                          </td>
                          <td class="ModifiedTime">1302635699000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1093.html">#1093</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.4-sprint-6.html">ckan-v1.4-sprint-6</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1093.html">500 errors on GET to api/rest/licenses</a>
                          </td>
                          <td class="description">
                            <p>
CKAN gets its license list from a license service, which can be a local file, but is often the <a class="ext-link" href="http://licenses.opendefinition.org/2.0/ckan_original"><span class="icon">​</span>http://licenses.opendefinition.org/2.0/ckan_original</a> server. This server is currently flakey, but I think we only request the list on start up. The problem is we query it much more often than required. It is queried for every request to api/rest/licenses, and we are returning lots of 500 errors when the license server is timing out.
</p>

                            
                          </td>
                          <td class="PosixTime">1302862261000000
                          </td>
                          <td class="ModifiedTime">1302865470000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1097.html">#1097</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.4-sprint-6.html">ckan-v1.4-sprint-6</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1097.html">Sidebar hideable</a>
                          </td>
                          <td class="description">
                            <p>
The web interface has a sidebar (#primary) which should be hidden in some pages. This is for QA extension and useful for package new and edit pages. Must be compatible with DGU theme.
</p>

                            
                          </td>
                          <td class="PosixTime">1303293416000000
                          </td>
                          <td class="ModifiedTime">1303293476000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1098.html">#1098</a>
                          </td>
                          <td class="type">task
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.4-sprint-6.html">ckan-v1.4-sprint-6</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1098.html">--ckan-migration tests not initialised correctly</a>
                          </td>
                          <td class="description">
                            <p>
Only tests with failing --ckan-migration fail, due to authz not being initialised.
</p>

                            
                          </td>
                          <td class="PosixTime">1303377336000000
                          </td>
                          <td class="ModifiedTime">1303406017000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1100.html">#1100</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.4-sprint-6.html">ckan-v1.4-sprint-6</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1100.html">Get buildbot running on ckan branches</a>
                          </td>
                          <td class="description">
                            <p>
Need some changes to pip-requirements files in release branches.
</p>

                            
                          </td>
                          <td class="PosixTime">1303385267000000
                          </td>
                          <td class="ModifiedTime">1303406103000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1112.html">#1112</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.4-sprint-7.html">ckan-v1.4-sprint-7</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1112.html">Allow searching for all packages</a>
                          </td>
                          <td class="description">
                            <pre class="wiki">GET api/search/package?q=
</pre><p>
returns all packages. This is so you can filter them e.g. by openness, which is not currently possible.
</p>

                            
                          </td>
                          <td class="PosixTime">1304007852000000
                          </td>
                          <td class="ModifiedTime">1304358643000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1114.html">#1114</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.4-sprint-7.html">ckan-v1.4-sprint-7</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1114.html">CLI for viewing search index of a package</a>
                          </td>
                          <td class="description">
                            <p>
To see what lexemes are generated for debug purposes.
</p>

                            
                          </td>
                          <td class="PosixTime">1304078353000000
                          </td>
                          <td class="ModifiedTime">1304085484000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1116.html">#1116</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.4-sprint-7.html">ckan-v1.4-sprint-7</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1116.html">api search loses boolean q options</a>
                          </td>
                          <td class="description">
                            <p>
filter_by_openness and filter_by_downloadable options don't work when specified as URI parameters. (They do work in qjson parameters)
</p>

                            
                          </td>
                          <td class="PosixTime">1304086823000000
                          </td>
                          <td class="ModifiedTime">1304358664000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1121.html">#1121</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">wontfix
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1121.html">JSON extras appear in package edit form mangled</a>
                          </td>
                          <td class="description">
                            <p>
It is possible to use the CKAN API to insert JSON format data into package extra values, but this data is displayed in the package edit form.
</p>
<p>
Example: Package <a class="ext-link" href="http://ckan.net/package/hbz_unioncatalog"><span class="icon">​</span>http://ckan.net/package/hbz_unioncatalog</a> in the API the extra value as a list:
</p>
<pre class="wiki">"extras": {"publishingInstitution": ["http://lobid.org/organisation/DE-605", "http://lobid.org/organisation/DE-290"...
</pre><p>
yet when you edit the package it loses all the quotes and brackets: <a class="ext-link" href="http://ckan.net/package/edit/hbz_unioncatalog"><span class="icon">​</span>http://ckan.net/package/edit/hbz_unioncatalog</a>
{{{<a class="ext-link" href="http://lobid.org/organisation/DE-605http://lobid.org/organisation/DE-290"><span class="icon">​</span>http://lobid.org/organisation/DE-605http://lobid.org/organisation/DE-290</a>...
}}}
so when you save the package, the list is mangled into a bad string.
</p>

                            
                          </td>
                          <td class="PosixTime">1304367504000000
                          </td>
                          <td class="ModifiedTime">1307358426000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1122.html">#1122</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">pudo
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">wontfix
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1122.html">JSON Extra data not searchable</a>
                          </td>
                          <td class="description">
                            <p>
It is possible to use the CKAN API to insert JSON format data into package extra values, but this data is not found on searching.
</p>
<p>
Full text from Pascal:
</p>
<pre class="wiki">we encountered a Problem concerning accessing Arrays/Lists.

curl -XGET 'http://ckan.net/api/rest/package/hbz_unioncatalog'

will get you amongst others:

 "extras": {"publishingInstitution":
"[u'http://lobid.org/organisation/DE-605',
u'http://lobid.org/organisation/DE-290',
u'http://lobid.org/organisation/DE-38M',
u'http://lobid.org/organisation/DE-98',
u'http://lobid.org/organisation/DE-38',
u'http://lobid.org/organisation/DE-Kn41',
u'http://lobid.org/organisation/DE-82',
u'http://lobid.org/organisation/DE-107',
u'http://lobid.org/organisation/DE-929',
u'http://lobid.org/organisation/DE-Zw1',
u'http://lobid.org/organisation/DE-832']"}

but if I try to query this:

wget
'http://ckan.net/api/search/package?q=lobid&amp;publishingInstitution="http://lobid.org/organisation/DE-605"'

I get only two packages, among the package "hbz_unioncatalog" is
missing. (These two packages have only one value for
"publishingInstitution").

The "extra/publishingInstitution"-Array was uploaded through a "curl
-XPUT ...
 "extras": {
   "publishingInstitution":[
     "http://lobid.org/organisation/DE-605",
     "http://lobid.org/organisation/DE-290",
     "http://lobid.org/organisation/DE-38M",
     "http://lobid.org/organisation/DE-98",
     "http://lobid.org/organisation/DE-38",
     "http://lobid.org/organisation/DE-Kn41",
     "http://lobid.org/organisation/DE-82",
     "http://lobid.org/organisation/DE-107",
     "http://lobid.org/organisation/DE-929",
     "http://lobid.org/organisation/DE-Zw1",
     "http://lobid.org/organisation/DE-832"
   ]
   },
...
</pre>
                            
                          </td>
                          <td class="PosixTime">1304367510000000
                          </td>
                          <td class="ModifiedTime">1306747714000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1126.html">#1126</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.4-sprint-7.html">ckan-v1.4-sprint-7</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1126.html">Exceptions arising from error page</a>
                          </td>
                          <td class="description">
                            <p>
I'm not completely clear what the use case is for loading the error page in this way, but somehow original_request is None and that creates an unnecessary exception with the logic refactor.
</p>
<pre class="wiki">http://ckan.net/error/document?__cache=39020485
...
Module ckan.controllers.error:29 in document
&lt;&lt;          original_response = request.environ.get('pylons.original_response')
               # Bypass error template for API operations.
               if original_request.path.startswith('/api'):
                   return original_response.body
               # Otherwise, decorate original response with error template.
&gt;&gt;  if original_request.path.startswith('/api'):
AttributeError: 'NoneType' object has no attribute 'path'
</pre>
                            
                          </td>
                          <td class="PosixTime">1304586683000000
                          </td>
                          <td class="ModifiedTime">1304587078000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1128.html">#1128</a>
                          </td>
                          <td class="type">task
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-10-28.html">ckan-sprint-2011-10-28</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1128.html">Upload Scotland gov data</a>
                          </td>
                          <td class="description">
                            <p>
Upload to ckan.net:
<a class="ext-link" href="https://sites.google.com/site/scotlandsdata/"><span class="icon">​</span>https://sites.google.com/site/scotlandsdata/</a>
</p>

                            
                          </td>
                          <td class="PosixTime">1304712293000000
                          </td>
                          <td class="ModifiedTime">1310568028000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1131.html">#1131</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.4-sprint-7.html">ckan-v1.4-sprint-7</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1131.html">Search param validation exception not caught</a>
                          </td>
                          <td class="description">
                            <p>
Example request:
</p>
<pre class="wiki">http://nl.ckan.net/api/2/search/package?q=delft&amp;order_by=&amp;offset=&amp;limit=&amp;tags=
</pre><p>
Gives 500 error:
</p>
<pre class="wiki">&lt;type 'exceptions.ValueError'&gt;: invalid literal for int() with base 10: ''
</pre>
                            
                          </td>
                          <td class="PosixTime">1304942023000000
                          </td>
                          <td class="ModifiedTime">1305537897000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1140.html">#1140</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.5.html">ckan-v1.5</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1140.html">Adding the package to the group is not search indexed</a>
                          </td>
                          <td class="description">
                            <p>
To reproduce:
</p>
<ol><li><tt>paster db init</tt>
</li><li><tt>paster create-test-data</tt>
</li><li>In Web UI: create new group 'tilo', which includes package 'annakarenina'
</li><li><tt>curl http://localhost:5000/api/search/package?groups=tilo</tt>  results in 0 results (WRONG)
</li><li><tt>paster search-index rebuild</tt>
</li><li><tt>curl http://localhost:5000/api/search/package?groups=tilo</tt>  results in 1 result
</li></ol>
                            
                          </td>
                          <td class="PosixTime">1305718290000000
                          </td>
                          <td class="ModifiedTime">1312537257000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1143.html">#1143</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.5-sprint-2.html">ckan-v1.5-sprint-2</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1143.html">Improve stats page</a>
                          </td>
                          <td class="description">
                            <ul><li>Ensure we don't include deleted packages in the stats
</li><li>Some visual improvements:
<ul><li>Number of packages:
<ul><li>fix x axis to start at first revision
</li><li>fix y axis to start at zero
</li></ul></li><li>Fix problem with legend to 'Revisions to packages' graph.
</li><li>Hide sidebar in the template, so it isn't right-cropped in the DGU theme
</li></ul></li><li>Add some testing of the stats lib - results of basic stats
</li></ul>
                            
                          </td>
                          <td class="PosixTime">1305734836000000
                          </td>
                          <td class="ModifiedTime">1307024681000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1168.html">#1168</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">thejimmyg
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-backlog.html">ckan-backlog</a>
                          </td>
                          <td class="status">assigned
                          </td>
                          <td class="resolution">
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1168.html">Test system for deb packaging</a>
                          </td>
                          <td class="description">
                            <p>
Get buildbot to:
</p>
<ul><li>build the deb packages
</li><li>install them into a fresh virtual machine
</li><li>run smoke tests on the installed ckan
</li></ul>
                            
                          </td>
                          <td class="PosixTime">1306441994000000
                          </td>
                          <td class="ModifiedTime">1330990423000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1169.html">#1169</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.5-sprint-2.html">ckan-v1.5-sprint-2</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1169.html">Link to csv/json dumps on ckan.net</a>
                          </td>
                          <td class="description">
                            
                            
                          </td>
                          <td class="PosixTime">1306749768000000
                          </td>
                          <td class="ModifiedTime">1306754833000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1170.html">#1170</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.5-sprint-2.html">ckan-v1.5-sprint-2</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1170.html">Production deployment docs out of date</a>
                          </td>
                          <td class="description">
                            <p>
Need to cover pip-requirements.txt on different branches in the doc/deployment.rst. 
</p>
<p>
Also could do with tidying up upgrade.txt into this document too.
</p>

                            
                          </td>
                          <td class="PosixTime">1306864171000000
                          </td>
                          <td class="ModifiedTime">1306864422000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1171.html">#1171</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">mark.wainwright
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan&#32;2.0.html">ckan 2.0</a>
                          </td>
                          <td class="status">assigned
                          </td>
                          <td class="resolution">
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1171.html">Citation instructions on dataset and resource view pages</a>
                          </td>
                          <td class="description">
                            <p>
Some sort of citation helper. Something small on the dataset and resource page that would show how to cite.
</p>
<p>
wwaites: Some related thoughts on this from opb: <a class="ext-link" href="http://homepages.inf.ed.ac.uk/opb/papers/ssdbm2006.pdf"><span class="icon">​</span>http://homepages.inf.ed.ac.uk/opb/papers/ssdbm2006.pdf</a>
</p>
<p>
timclicks: I'm looking at Dataverse for the first time<a class="missing changeset" title="No default repository defined">[0]</a>. It seems very popular in the social sciences. I noticed that there is a recommended citation for each dataset. For example, <a class="missing changeset" title="No default repository defined">[1]</a> is has this one: "Targeted Input Programme (TIP) 2000-01", <a class="ext-link" href="http://hdl.handle.net/1902.1/SSC-MWI-TIP2000-01-M1"><span class="icon">​</span>http://hdl.handle.net/1902.1/SSC-MWI-TIP2000-01-M1</a> V1 [Version]"
</p>
<h2 id="Implementation">Implementation</h2>
<p>
Add a small box at bottom of dataset / resource page (or in sidebar on dataset page) with title "Cite this" with contents like:
</p>
<p>
%title. %author. Retrieved %date. %site_title.
</p>
<p>
For resource: %title = %dataset_title. %resource_name.
</p>
<p>
Could also add export to ref managers (e.g. to bibtex) but that is for later.
</p>

                            
                          </td>
                          <td class="PosixTime">1306920799000000
                          </td>
                          <td class="ModifiedTime">1347358705000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1176.html">#1176</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">thejimmyg
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-10-28.html">ckan-sprint-2011-10-28</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1176.html">unicode_body exception</a>
                          </td>
                          <td class="description">
                            <p>
We seem to occasionally get this exception on ckan.net. 
</p>
<p>
User agents causing this include:
</p>
<ul><li>Alexa ia_archiver (3/6/11)
</li><li>Maxthon browser (17/5/11)
</li></ul><pre class="wiki">Module ckan.controllers.error:32 in document
&lt;&lt;              return original_response.body
               # Otherwise, decorate original response with error template.
               c.content = literal(original_response.unicode_body) or cgi.escape(request.GET.get('message', ''))
               c.prefix=request.environ.get('SCRIPT_NAME', ''),
               c.code=cgi.escape(request.GET.get('code', str(original_response.status_int))),
&gt;&gt;  c.content = literal(original_response.unicode_body) or cgi.escape(request.GET.get('message', ''))
AttributeError: 'NoneType' object has no attribute 'unicode_body'
</pre>
                            
                          </td>
                          <td class="PosixTime">1307351562000000
                          </td>
                          <td class="ModifiedTime">1314273012000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1180.html">#1180</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.5-sprint-3.html">ckan-v1.5-sprint-3</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1180.html">Links in markdown can be badly formed</a>
                          </td>
                          <td class="description">
                            <p>
User can insert bad anchor tags into the User-About and Package-Notes fields and when you view them (web interface) it causes a 500 error.
</p>
<p>
Need to improve filtering for anchors in markdown.
</p>
<pre class="wiki">&lt;a href="http://xxxsex.com&gt;nasty/website
</pre><p>
Also check this related exception:
</p>
<pre class="wiki">Module ckan.controllers.user:59 in read
&lt;&lt;          c.is_myself = user.name == c.user
               c.api_key = user.apikey
               c.about_formatted = self._format_about(user.about)
               revisions_q = model.Session.query(model.Revision
                       ).filter_by(author=user.name)
&gt;&gt;  c.about_formatted = self._format_about(user.about)
Module ckan.controllers.user:167 in _format_about
&lt;&lt;      def _format_about(self, about):
               about_formatted = ckan.misc.MarkdownFormat().to_html(about)
               return genshi.HTML(about_formatted) 
       
           def _get_form_password(self):
&gt;&gt;  return genshi.HTML(about_formatted)
WebApp Error: &lt;class 'genshi.input.ParseError'&gt;: junk characters in start tag: u'\u201dhttp://www.settingu': line 1, column 3
</pre>
                            
                          </td>
                          <td class="PosixTime">1307469037000000
                          </td>
                          <td class="ModifiedTime">1307544223000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1181.html">#1181</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1181.html">Link spam vulnerability in Notes and User-About fields</a>
                          </td>
                          <td class="description">
                            <p>
When viewing a user and a package, the about/notes fields contain Markdown, which may have links. These should have rel="nofollow" to discourage link spam.
</p>

                            
                          </td>
                          <td class="PosixTime">1307523160000000
                          </td>
                          <td class="ModifiedTime">1307532816000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1186.html">#1186</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1186.html">Password reset facility</a>
                          </td>
                          <td class="description">
                            <p>
You can register a user with password and (optional) email address. But if you forget the password you can't then log in again. We need a password reset facility that sends and email with a new password.
</p>

                            
                          </td>
                          <td class="PosixTime">1308142766000000
                          </td>
                          <td class="ModifiedTime">1310556519000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1187.html">#1187</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.5-sprint-3.html">ckan-v1.5-sprint-3</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1187.html">Stop spam users with links in the 'about' field</a>
                          </td>
                          <td class="description">
                            <p>
When you edit a user, you should be stopped from putting links in the 'about' field, because this is a common tactic by spammers.
</p>

                            
                          </td>
                          <td class="PosixTime">1308142999000000
                          </td>
                          <td class="ModifiedTime">1308143605000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1191.html">#1191</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.5-sprint-3.html">ckan-v1.5-sprint-3</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1191.html">Unicode in user password gives 500 error on user registration</a>
                          </td>
                          <td class="description">
                            <p>
Create/register a user with a unicode character in the password. It creates the user, but the redirect to the user page doesn't work and results in 500 error.
</p>

                            
                          </td>
                          <td class="PosixTime">1308312895000000
                          </td>
                          <td class="ModifiedTime">1308650930000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1194.html">#1194</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1194.html">"Welcome back" message for newly registered user</a>
                          </td>
                          <td class="description">
                            <ol><li>Register a new user (/user/register)
</li><li>It redirects you to user page and displays "Welcome back" even though you are a new user.
</li></ol>
                            
                          </td>
                          <td class="PosixTime">1308563392000000
                          </td>
                          <td class="ModifiedTime">1317053688000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1195.html">#1195</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">rgrp
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-10-28.html">ckan-sprint-2011-10-28</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1195.html">Storage extension to handle incorrect routes better</a>
                          </td>
                          <td class="description">
                            <p>
We've seen exceptions caused by people getting the file storage link wrong, adding a slash to the end.
</p>
<p>
e.g.
<a class="ext-link" href="http://ckan.net/storage/f/file/e696d857-e997-41c8-be08-408697168ca8/"><span class="icon">​</span>http://ckan.net/storage/f/file/e696d857-e997-41c8-be08-408697168ca8/</a>
</p>
<p>
We should aim to handle all requests better than causing exception. 404 (or even 302 in this case) is better than 500.
</p>

                            
                          </td>
                          <td class="PosixTime">1308576769000000
                          </td>
                          <td class="ModifiedTime">1311964374000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1196.html">#1196</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.5-sprint-3.html">ckan-v1.5-sprint-3</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1196.html">Markdown logging ignores config settings</a>
                          </td>
                          <td class="description">
                            <p>
Markdown produces Debug logging, even when the pylons logging config is set to level of Info or Warning. This clogs up the logfile.
</p>

                            
                          </td>
                          <td class="PosixTime">1308743476000000
                          </td>
                          <td class="ModifiedTime">1308743857000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1198.html">#1198</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-backlog.html">ckan-backlog</a>
                          </td>
                          <td class="status">new
                          </td>
                          <td class="resolution">
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1198.html">Publisher hierarchy</a>
                          </td>
                          <td class="description">
                            <p>
'Publisher' entities in the model. They are hierarchical. 
</p>
<p>
'User-Publisher' connections with one or more roles (e.g. drafter, moderator). 
</p>
<p>
Authorization settings can control who can set what values in a 'published by' type field.
</p>
<p>
Publishers and User-Publishers available to read in the API.
</p>
<p>
Future tickets will provide:
</p>
<ul><li>API to write Publishers and User-Publishers
</li><li>UI to edit Publishers and User-Publishers
</li></ul><p>
(This feature deprecates authorization groups)
</p>

                            
                          </td>
                          <td class="PosixTime">1308820592000000
                          </td>
                          <td class="ModifiedTime">1339774200000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1205.html">#1205</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">kindly
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1205.html">db upgrade problem on cz.ckan.net</a>
                          </td>
                          <td class="description">
                            <p>
When upgrading database for cz.ckan.net (psql.okfn.org/cz.okfn.org) an error occurred (see below).
</p>
<p>
cz.ckan.net has been running on eu3 and this updrade was part of moving it to eu19, with a more recent version of ckan.
</p>
<p>
In the meantime I've reverted the db to the old version (pre-upgrade). 
</p>
<p>
cz.ckan.net is not working properly until this is fixed.
</p>
<pre class="wiki">okfn@eu19:~$ paster --plugin ckan db upgrade --config=/etc/ckan/cz/cz.ini
/usr/lib/pymodules/python2.6/ckan_deps/sqlalchemy/engine/url.py:105: SADeprecationWarning: The SQLAlchemy PostgreSQL dialect has been renamed from 'postgres' to 'postgresql'. The new URL format is postgresql[+driver]://&lt;user&gt;:&lt;pass&gt;@&lt;host&gt;/&lt;dbname&gt;
  module = __import__('sqlalchemy.dialects.%s' % (dialect, )).dialects
2011-06-29 09:07:41,294 INFO  [migrate.versioning.api] 28 -&gt; 29... 
/usr/lib/pymodules/python2.6/ckan_deps/sqlalchemy/engine/reflection.py:46: SAWarning: Skipped unsupported reflection of expression-based index idx_pkg_lname
  ret = fn(self, con, *args, **kw)
/usr/lib/pymodules/python2.6/ckan_deps/sqlalchemy/engine/reflection.py:46: SAWarning: Skipped unsupported reflection of expression-based index idx_pkg_slname
  ret = fn(self, con, *args, **kw)
/usr/lib/pymodules/python2.6/ckan_deps/sqlalchemy/engine/reflection.py:46: SAWarning: Skipped unsupported reflection of expression-based index idx_pkg_suname
  ret = fn(self, con, *args, **kw)
/usr/lib/pymodules/python2.6/ckan_deps/sqlalchemy/engine/reflection.py:46: SAWarning: Skipped unsupported reflection of expression-based index idx_pkg_uname
  ret = fn(self, con, *args, **kw)
Traceback (most recent call last):
  File "/usr/bin/paster", line 18, in &lt;module&gt;
    command.run()
  File "/usr/lib/pymodules/python2.6/paste/script/command.py", line 84, in run
    invoke(command, command_name, options, args[1:])
  File "/usr/lib/pymodules/python2.6/paste/script/command.py", line 123, in invoke
    exit_code = runner.run(args)
  File "/usr/lib/pymodules/python2.6/paste/script/command.py", line 218, in run
    result = self.command()
  File "/usr/lib/pymodules/python2.6/ckan/lib/cli.py", line 84, in command
    model.repo.upgrade_db()
  File "/usr/lib/pymodules/python2.6/ckan/model/__init__.py", line 163, in upgrade_db
    mig.upgrade(self.metadata.bind, self.migrate_repository, version=version)
  File "/usr/lib/pymodules/python2.6/ckan_deps/migrate/versioning/api.py", line 185, in upgrade
    return _migrate(url, repository, version, upgrade=True, err=err, **opts)
  File "&lt;string&gt;", line 2, in _migrate
  File "/usr/lib/pymodules/python2.6/ckan_deps/migrate/versioning/util/__init__.py", line 160, in with_engine
    return f(*a, **kw)
  File "/usr/lib/pymodules/python2.6/ckan_deps/migrate/versioning/api.py", line 364, in _migrate
    schema.runchange(ver, change, changeset.step)
  File "/usr/lib/pymodules/python2.6/ckan_deps/migrate/versioning/schema.py", line 83, in runchange
    change.run(self.engine, step)
  File "/usr/lib/pymodules/python2.6/ckan_deps/migrate/versioning/script/py.py", line 140, in run
    script_func(engine)
  File "/usr/lib/pymodules/python2.6/ckan/migration/versions/029_version_groups.py", line 152, in upgrade
    migrate_engine.execute(q)
  File "/usr/lib/pymodules/python2.6/ckan_deps/sqlalchemy/engine/base.py", line 1788, in execute
    return connection.execute(statement, *multiparams, **params)
  File "/usr/lib/pymodules/python2.6/ckan_deps/sqlalchemy/engine/base.py", line 1191, in execute
    params)
  File "/usr/lib/pymodules/python2.6/ckan_deps/sqlalchemy/engine/base.py", line 1271, in _execute_clauseelement
    return self.__execute_context(context)
  File "/usr/lib/pymodules/python2.6/ckan_deps/sqlalchemy/engine/base.py", line 1302, in __execute_context
    context.parameters[0], context=context)
  File "/usr/lib/pymodules/python2.6/ckan_deps/sqlalchemy/engine/base.py", line 1401, in _cursor_execute
    context)
  File "/usr/lib/pymodules/python2.6/ckan_deps/sqlalchemy/engine/base.py", line 1394, in _cursor_execute
    context)
  File "/usr/lib/pymodules/python2.6/ckan_deps/sqlalchemy/engine/default.py", line 299, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (IntegrityError) insert or update on table "package_group_revision" violates foreign key constraint "package_group_revision_continuity_id_fkey"
DETAIL:  Key (continuity_id)=(7f373978-40a0-4848-bdc9-018ad213aa0b) is not present in table "package_group".
 'INSERT INTO package_group_revision (id, package_id, group_id, state, revision_id, continuity_id) VALUES (%(id)s, %(package_id)s, %(group_id)s, %(state)s, %(revision_id)s, %(continuity_id)s)' {'state': u'active', 'package_id': u'14d76e9e-028c-49c1-955b-ef30d4abb970', 'continuity_id': u'7f373978-40a0-4848-bdc9-018ad213aa0b', 'revision_id': u'24a11f58-2ff9-46f3-b113-0bf7f0baf254', 'group_id': u'4b832199-b8e3-4989-9b5d-de8dd6322612', 'id': u'7a3863bd-3054-40c8-bb3d-68b73096c108'}
</pre>
                            
                          </td>
                          <td class="PosixTime">1309339700000000
                          </td>
                          <td class="ModifiedTime">1310568631000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1206.html">#1206</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">wwaites
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1206.html">"Content-Type json" header scuppers package POST</a>
                          </td>
                          <td class="description">
                            <p>
Compare these two requests to create a package:
</p>
<pre class="wiki">curl http://test.ckan.net/api/rest/package -d '{name:"test"}' -H 'Content-Type: application/json' -H 'X-CKAN-API-KEY: tester'
curl http://test.ckan.net/api/rest/package -d '{name:"test"}' -H 'X-CKAN-API-KEY: tester'
</pre><p>
The second one gets the payload through (ckan log):
</p>
<pre class="wiki">Retrieving request params: UnicodeMultiDict([('{name:"test"}', u'')])
</pre><p>
But the first one causes a <a class="missing wiki">ServerError?</a> because the payload (name:&#34;test&#34;) doesn't make it to request.POST or request.params:
</p>
<pre class="wiki">Retrieving request params: UnicodeMultiDict([])
</pre><p>
The only difference is the "<a class="missing wiki">ContentType?</a>: application/json" header, which seems a reasonable thing to include. Javascript lib backbone.js (for example) inserts this automatically.
</p>
<p>
So why does this header cause the payload to not get through to the request object?
</p>

                            
                          </td>
                          <td class="PosixTime">1309344348000000
                          </td>
                          <td class="ModifiedTime">1309450216000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1207.html">#1207</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1207.html">ckanclient.package_entity_get should raise more specific exception</a>
                          </td>
                          <td class="description">
                            <p>
When package does not exist in ckan catalogue, ckanclient.package_entity_get should raise more specific exception, such as <a class="missing wiki">CkanNotFoundError?</a> instead of generic <a class="missing wiki">CkanApiError?</a>.
</p>

                            
                          </td>
                          <td class="PosixTime">1309515582000000
                          </td>
                          <td class="ModifiedTime">1311325343000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1210.html">#1210</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.5-sprint-4.html">ckan-v1.5-sprint-4</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1210.html">POST application/json error handling with newer WebOb</a>
                          </td>
                          <td class="description">
                            <p>
<a class="missing wiki">WebOb?</a> from v1.0.7 has some interesting new behaviour with reading request data for different Content-Types:
</p>
<ul><li>It seems that looking at request.body mangles request.POST. See fix in ckan cset:e83bad9caa1b (problem with <a class="missing wiki">WebOb?</a> v1.0.7 but may go back to v1.0.4?)
</li></ul><ul><li>A particular request caused an <a class="missing wiki">AssertionError?</a> during looking at request.body, so we need to enclose this in a try/except. I couldn't recreate it in a test unfortunately (problem with <a class="missing wiki">WebOb?</a> v1.0.7 but may go back to v1.0.2?)
</li></ul><p>
Example:
</p>
<pre class="wiki">Module ckan.controllers.api:206 in create
&lt;&lt;          log.debug('create: %s' % (context))
               try:
                   request_data = self._get_request_data()
               except ValueError, inst:
                   response.status_int = 400
&gt;&gt;  request_data = self._get_request_data()
Module ckan.lib.base:149 in _get_request_data
&lt;&lt;          cls.log.debug('Retrieving request params: %r' % request.params)
               cls.log.debug('Retrieving request POST: %r' % request.POST)
               cls.log.debug('Retrieving request POST body: %r' % request.body)
               if request.POST:
                   try:
&gt;&gt;  cls.log.debug('Retrieving request POST body: %r' % request.body)
Module paste.registry:137 in __getattr__
&lt;&lt;      
           def __getattr__(self, attr):
               return getattr(self._current_obj(), attr)
           
           def __setattr__(self, attr, value):
&gt;&gt;  return getattr(self._current_obj(), attr)
Module webob.request:470 in _body__get
&lt;&lt;          Return the content of the request body.
               """
               self.make_body_seekable() # we need this to have content_length
               r = self.body_file.read(self.content_length)
               self.body_file.seek(0)
&gt;&gt;  self.make_body_seekable() # we need this to have content_length
Module webob.request:697 in make_body_seekable
&lt;&lt;              self.body_file_raw.seek(0)
               else:
                   self.copy_body()
&gt;&gt;  self.copy_body()
Module webob.request:714 in copy_body
&lt;&lt;                  self.body = self.body_file_raw.read(length)
               elif self.is_body_readable:
                   self.body = self.body_file_raw.read()
                   self._copy_body_tempfile()
               else:
&gt;&gt;  self.body = self.body_file_raw.read()
Module webob.request:1190 in read
&lt;&lt;      def read(self, size=-1):
               body = self._get_body()
               if size &lt; 0:
                   v = body[self.position:]
&gt;&gt;  body = self._get_body()
Module webob.request:1207 in _get_body
&lt;&lt;                  self._body = _encode_multipart(self.vars, self.content_type)
                   else:
                       assert 0, ('Bad content type: %r' % self.content_type)
               return self._body
&gt;&gt;  assert 0, ('Bad content type: %r' % self.content_type)
AssertionError: Bad content type: '; charset=utf-8'
</pre>
                            
                          </td>
                          <td class="PosixTime">1309949451000000
                          </td>
                          <td class="ModifiedTime">1309974781000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1214.html">#1214</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">worksforme
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1214.html">API improvements (following javascript use)</a>
                          </td>
                          <td class="description">
                            <p>
Notes on the CKAN API from Aron:
</p>
<ul><li>Server returns text/html for errors even when "Accept: application/json" header is set.
</li><li>DELETE package request requires a Content-Length? Should be 405 Method Not Allowed?
</li><li>Tag returned as a JSON object when updating but as a string when requesting. Same with "extras" content.
</li><li>How to remove key from "extras" object? Passing None as described in the docs is invalid JSON and using null doesn't work.
</li><li>Tags return package names rather than ids when querying GET /tag/{id}
</li><li>Doesn't return rendered_text property on package update.
</li><li>Relationships use "object" key rather than id or package_id.
</li></ul>
                            
                          </td>
                          <td class="PosixTime">1309975222000000
                          </td>
                          <td class="ModifiedTime">1314029628000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1215.html">#1215</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1215.html">Edit Resources table - removing all rows prevents adding them again</a>
                          </td>
                          <td class="description">
                            <p>
I'm not sure if this was reported earlier, but I have found a minor bug in the "Add new package" form. As far as I can see this bug exists in v1.3.2 and also in v1.4.1a (that runs on ckan.net). This is a problem with adding new resources in "Resources" section. To reproduce the bug do the following:
</p>
<ol><li>Go to "Add new package", for instance <a class="ext-link" href="http://ckan.net/package/new"><span class="icon">​</span>http://ckan.net/package/new</a>
</li><li>Scroll down to "Resources" section.
</li><li>Click on "Remove this row" link (red circle).
</li><li>Say "Yes" to "Are you sure you wish to remove this row?"
</li><li>Now there should be no rows. Only the header "URL*   Format  Description"
</li><li>Click on "Add row to table"
</li><li>All you get now is another row with table header "URL*        Format Description". You will not be able to add any resources now. Solution is to reload the page.
</li></ol><p>
The simplest solution to this bug will be to hide the "Remove this
row" link if there is only one row.
</p>

                            
                          </td>
                          <td class="PosixTime">1310133224000000
                          </td>
                          <td class="ModifiedTime">1310385485000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1217.html">#1217</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-11-07.html">ckan-sprint-2011-11-07</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">invalid
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1217.html">Diff exception</a>
                          </td>
                          <td class="description">
                            <p>
Exception raised doing this particular diff.
</p>
<p>
<a class="ext-link" href="http://ckan.net/revision/diff/sudocfr?diff_entity=package&amp;oldid=a18b2520-09e0-44be-80dd-4fea94ffe7d1&amp;diff=3934ff16-a3a7-4481-b390-72944903b945"><span class="icon">​</span>http://ckan.net/revision/diff/sudocfr?diff_entity=package&amp;oldid=a18b2520-09e0-44be-80dd-4fea94ffe7d1&amp;diff=3934ff16-a3a7-4481-b390-72944903b945</a>
</p>
<pre class="wiki">...
Module ckan.controllers.revision:142 in diff
&lt;&lt;          if c.diff_entity == 'package':
                   c.pkg = model.Package.by_name(id)
                   diff = c.pkg.diff(c.revision_to, c.revision_from)
               elif c.diff_entity == 'group':
                   c.group = model.Group.by_name(id)
&gt;&gt;  diff = c.pkg.diff(c.revision_to, c.revision_from)
Module ckan.model.package:449 in diff
&lt;&lt;                              display_id = to_obj_rev.tag.name
                               elif obj_class.__name__ == 'PackageExtra':
                                   display_id = to_obj_rev.key
                               else:
                                   display_id = related_obj_id[:4]
&gt;&gt;  display_id = to_obj_rev.key
AttributeError: 'NoneType' object has no attribute 'key'
</pre><p>
Seems to be to do with this particular extra key:
</p>
<pre class="wiki">[&lt;PackageExtraRevision id=ba1f3b3e-f61f-4924-bae0-ec3dd2163ae4 package_id=febe4da9-5874-4411-a7da-b497fdebf739 key=namespace value=http://www.sudoc.fr/ state=active revision_id=5ec8e730-c73d-4f1c-989b-2e015eb3d315 continuity_id=ba1f3b3e-f61f-4924-bae0-ec3dd2163ae4 expired_id=None revision_timestamp=2011-07-08 13:48:11.027260 expired_timestamp=9999-12-31 00:00:00 current=True&gt;]
</pre><p>
Is it because it was created between the from_revision and to_revision?
</p>

                            
                          </td>
                          <td class="PosixTime">1310375498000000
                          </td>
                          <td class="ModifiedTime">1320663277000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1221.html">#1221</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-10-28.html">ckan-sprint-2011-10-28</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1221.html">Password reset tidy up</a>
                          </td>
                          <td class="description">
                            <ul><li>No tests.
</li><li>500 error given when user is not found.
</li></ul>
                            
                          </td>
                          <td class="PosixTime">1310475661000000
                          </td>
                          <td class="ModifiedTime">1310556607000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1222.html">#1222</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-10-28.html">ckan-sprint-2011-10-28</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1222.html">Mailer has no tests</a>
                          </td>
                          <td class="description">
                            
                            
                          </td>
                          <td class="PosixTime">1310479136000000
                          </td>
                          <td class="ModifiedTime">1310556618000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1225.html">#1225</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-10-28.html">ckan-sprint-2011-10-28</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1225.html">Tool for mass tag changes</a>
                          </td>
                          <td class="description">
                            <p>
Using ckanapi
</p>

                            
                          </td>
                          <td class="PosixTime">1310642161000000
                          </td>
                          <td class="ModifiedTime">1310642407000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1226.html">#1226</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">worksforme
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1226.html">Genshi stream exception</a>
                          </td>
                          <td class="description">
                            <p>
<a class="missing wiki">IndexError?</a> exception in genshi.filters.i18n keeps popping up daily.
</p>
<p>
e.g.
</p>
<pre class="wiki">...
Module ckan.controllers.authorization_group:28 in index
&lt;&lt;              items_per_page=20
               )
               return render('authorization_group/index.html')
       
           def read(self, id):
&gt;&gt;  return render('authorization_group/index.html')
Module ckan.lib.base:74 in render
&lt;&lt;      
           return cached_template(template_name, render_template, cache_key=cache_key, 
                                  cache_type=cache_type, cache_expire=cache_expire)
                                  #, ns_options=('method'), method=method)
&gt;&gt;  cache_type=cache_type, cache_expire=cache_expire)
Module pylons.templating:249 in cached_template
&lt;&lt;          return content
           else:
               return render_func()
&gt;&gt;  return render_func()
Module ckan.lib.base:63 in render_template
&lt;&lt;              stream = item.filter(stream)
               
               return literal(stream.render(method=method, encoding=None))
           
           if 'Pragma' in response.headers:
&gt;&gt;  return literal(stream.render(method=method, encoding=None))
Module genshi.core:183 in render
&lt;&lt;              method = self.serializer or 'xml'
               generator = self.serialize(method=method, **kwargs)
               return encode(generator, method=method, encoding=encoding, out=out)
       
           def select(self, path, namespaces=None, variables=None):
&gt;&gt;  return encode(generator, method=method, encoding=encoding, out=out)
Module genshi.output:57 in encode
&lt;&lt;          _encode = lambda string: string
           if out is None:
               return _encode(''.join(list(iterator)))
           for chunk in iterator:
               out.write(_encode(chunk))
&gt;&gt;  return _encode(''.join(list(iterator)))
Module genshi.output:339 in __call__
&lt;&lt;          for filter_ in self.filters:
                   stream = filter_(stream)
               for kind, data, pos in stream:
                   cached = cache_get((kind, data))
                   if cached is not None:
&gt;&gt;  for kind, data, pos in stream:
Module genshi.output:670 in __call__
&lt;&lt;          _gen_prefix = _gen_prefix().next
       
               for kind, data, pos in stream:
                   output = cache_get((kind, data))
                   if output is not None:
&gt;&gt;  for kind, data, pos in stream:
Module genshi.output:771 in __call__
&lt;&lt;          push_text = textbuf.append
               pop_text = textbuf.pop
               for kind, data, pos in chain(stream, [(None, None, None)]):
       
                   if kind is TEXT:
&gt;&gt;  for kind, data, pos in chain(stream, [(None, None, None)]):
Module genshi.output:586 in __call__
&lt;&lt;      def __call__(self, stream):
               prev = (None, None, None)
               for ev in stream:
                   if prev[0] is START:
                       if ev[0] is END:
&gt;&gt;  for ev in stream:
Module genshi.core:288 in _ensure
&lt;&lt;      # unchanged
           yield event
           for event in stream:
               yield event
&gt;&gt;  for event in stream:
Module genshi.core:288 in _ensure
&lt;&lt;      # unchanged
           yield event
           for event in stream:
               yield event
&gt;&gt;  for event in stream:
Module genshi.filters.transform:686 in _unmark
&lt;&lt;      def _unmark(self, stream):
               for mark, event in stream:
                   kind = event[0]
                   if not (kind is None or kind is ATTR or kind is BREAK):
&gt;&gt;  for mark, event in stream:
Module genshi.filters.transform:1145 in __call__
&lt;&lt;          :param stream: The marked event stream to filter
               """
               for mark, event in stream:
                   yield mark, event
                   if mark is ENTER:
&gt;&gt;  for mark, event in stream:
Module genshi.filters.transform:714 in __call__
&lt;&lt;          stream = iter(stream)
               next = stream.next
               for mark, event in stream:
                   if mark is None:
                       yield mark, event
&gt;&gt;  for mark, event in stream:
Module genshi.filters.transform:682 in _mark
&lt;&lt;      def _mark(self, stream):
               for event in stream:
                   yield OUTSIDE, event
&gt;&gt;  for event in stream:
Module genshi.core:288 in _ensure
&lt;&lt;      # unchanged
           yield event
           for event in stream:
               yield event
&gt;&gt;  for event in stream:
Module genshi.filters.transform:686 in _unmark
&lt;&lt;      def _unmark(self, stream):
               for mark, event in stream:
                   kind = event[0]
                   if not (kind is None or kind is ATTR or kind is BREAK):
&gt;&gt;  for mark, event in stream:
Module ckanext.googleanalytics.plugin:62 in download_adder
&lt;&lt;              (downloaded %s times)&lt;/span&gt;'''
                   count = None
                   for mark, (kind, data, pos) in stream:
                       if mark and kind == START:
                           href = data[1].get('href')
&gt;&gt;  for mark, (kind, data, pos) in stream:
Module genshi.filters.transform:714 in __call__
&lt;&lt;          stream = iter(stream)
               next = stream.next
               for mark, event in stream:
                   if mark is None:
                       yield mark, event
&gt;&gt;  for mark, event in stream:
Module genshi.filters.transform:682 in _mark
&lt;&lt;      def _mark(self, stream):
               for event in stream:
                   yield OUTSIDE, event
&gt;&gt;  for event in stream:
Module genshi.core:288 in _ensure
&lt;&lt;      # unchanged
           yield event
           for event in stream:
               yield event
&gt;&gt;  for event in stream:
Module genshi.filters.transform:686 in _unmark
&lt;&lt;      def _unmark(self, stream):
               for mark, event in stream:
                   kind = event[0]
                   if not (kind is None or kind is ATTR or kind is BREAK):
&gt;&gt;  for mark, event in stream:
Module genshi.filters.transform:1175 in __call__
&lt;&lt;          """
               callable_value = hasattr(self.value, '__call__')
               for mark, (kind, data, pos) in stream:
                   if mark is ENTER:
                       if callable_value:
&gt;&gt;  for mark, (kind, data, pos) in stream:
Module genshi.filters.transform:714 in __call__
&lt;&lt;          stream = iter(stream)
               next = stream.next
               for mark, event in stream:
                   if mark is None:
                       yield mark, event
&gt;&gt;  for mark, event in stream:
Module genshi.filters.transform:682 in _mark
&lt;&lt;      def _mark(self, stream):
               for event in stream:
                   yield OUTSIDE, event
&gt;&gt;  for event in stream:
Module genshi.core:288 in _ensure
&lt;&lt;      # unchanged
           yield event
           for event in stream:
               yield event
&gt;&gt;  for event in stream:
Module genshi.filters.transform:686 in _unmark
&lt;&lt;      def _unmark(self, stream):
               for mark, event in stream:
                   kind = event[0]
                   if not (kind is None or kind is ATTR or kind is BREAK):
&gt;&gt;  for mark, event in stream:
Module genshi.filters.transform:1145 in __call__
&lt;&lt;          :param stream: The marked event stream to filter
               """
               for mark, event in stream:
                   yield mark, event
                   if mark is ENTER:
&gt;&gt;  for mark, event in stream:
Module genshi.filters.transform:714 in __call__
&lt;&lt;          stream = iter(stream)
               next = stream.next
               for mark, event in stream:
                   if mark is None:
                       yield mark, event
&gt;&gt;  for mark, event in stream:
Module genshi.filters.transform:682 in _mark
&lt;&lt;      def _mark(self, stream):
               for event in stream:
                   yield OUTSIDE, event
&gt;&gt;  for event in stream:
Module genshi.template.base:618 in _include
&lt;&lt;                      tmpl = self.loader.load(href, relative_to=event[2][0],
                                                   cls=cls or self.__class__)
                           for event in tmpl.generate(ctxt, **vars):
                               yield event
                       except TemplateNotFound:
&gt;&gt;  for event in tmpl.generate(ctxt, **vars):
Module genshi.template.base:618 in _include
&lt;&lt;                      tmpl = self.loader.load(href, relative_to=event[2][0],
                                                   cls=cls or self.__class__)
                           for event in tmpl.generate(ctxt, **vars):
                               yield event
                       except TemplateNotFound:
&gt;&gt;  for event in tmpl.generate(ctxt, **vars):
Module genshi.template.base:618 in _include
&lt;&lt;                      tmpl = self.loader.load(href, relative_to=event[2][0],
                                                   cls=cls or self.__class__)
                           for event in tmpl.generate(ctxt, **vars):
                               yield event
                       except TemplateNotFound:
&gt;&gt;  for event in tmpl.generate(ctxt, **vars):
Module genshi.template.base:605 in _include
&lt;&lt;          from genshi.template.loader import TemplateNotFound
       
               for event in stream:
                   if event[0] is INCLUDE:
                       href, cls, fallback = event[1]
&gt;&gt;  for event in stream:
Module genshi.template.markup:378 in _match
&lt;&lt;                      for event in self._match(self._flatten(template, ctxt,
                                                                  **vars),
                                                    ctxt, start=idx + 1, **vars):
                               yield event
&gt;&gt;  ctxt, start=idx + 1, **vars):
Module genshi.template.markup:327 in _match
&lt;&lt;                      break
       
               for event in stream:
       
                   # We (currently) only care about start and end events for matching
&gt;&gt;  for event in stream:
Module genshi.template.base:545 in _flatten
&lt;&lt;          while 1:
                   for kind, data, pos in stream:
       
                       if kind is START and data[1]:
&gt;&gt;  for kind, data, pos in stream:
Module genshi.filters.i18n:177 in _generate
&lt;&lt;                  msgbuf.append(*previous)
                       previous = None
                   for event in msgbuf.translate(gettext(msgbuf.format())):
                       yield event
                   if previous:
&gt;&gt;  for event in msgbuf.translate(gettext(msgbuf.format())):
Module genshi.filters.i18n:1029 in translate
&lt;&lt;                      )
       
               parts = parse_msg(string)
               parts_counter = {}
               for order, string in parts:
&gt;&gt;  parts = parse_msg(string)
Module genshi.filters.i18n:1143 in parse_msg
&lt;&lt;      if string:
               parts.append((stack[-1], string))
       
           return parts
&gt;&gt;  parts.append((stack[-1], string))
IndexError: list index out of range
</pre>
                            
                          </td>
                          <td class="PosixTime">1311008861000000
                          </td>
                          <td class="ModifiedTime">1314029434000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1228.html">#1228</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-10-28.html">ckan-sprint-2011-10-28</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1228.html">Display OpenID login errors</a>
                          </td>
                          <td class="description">
                            <p>
When there are errors when logging into OpenID, these don't get displayed. You just get the login screen again.
</p>

                            
                          </td>
                          <td class="PosixTime">1311086562000000
                          </td>
                          <td class="ModifiedTime">1311325161000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1234.html">#1234</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-10-28.html">ckan-sprint-2011-10-28</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1234.html">Setting locale error conditions handled badly</a>
                          </td>
                          <td class="description">
                            <p>
Needs tests for error conditions for bad locale and redirect parameters.
</p>

                            
                          </td>
                          <td class="PosixTime">1311179871000000
                          </td>
                          <td class="ModifiedTime">1311183328000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1236.html">#1236</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-11-07.html">ckan-sprint-2011-11-07</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1236.html">View a package at a given revision</a>
                          </td>
                          <td class="description">
                            <p>
As a user I want to view a package at a given revision:
</p>
<ul><li>When I visit /package/osm@yyyy-mm-dd or /package/osm@rrrrrrr I should be shown package at date yyyy-mm-dd or revision rrrrrrr.
</li><li>viewing this page, it should say it is the old revision, just like wikipedia
</li><li>package history page should provide links to these pages
</li></ul>
                            
                          </td>
                          <td class="PosixTime">1311269333000000
                          </td>
                          <td class="ModifiedTime">1330019788000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1238.html">#1238</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">kindly
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-10-28.html">ckan-sprint-2011-10-28</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">invalid
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1238.html">Viewing a package @date misses non-PackageRevisions</a>
                          </td>
                          <td class="description">
                            <p>
There's a problem with getting old versions of packages using @date. The query looks for the <a class="missing wiki">PackageRevision?</a> related to the date, but ignores <a class="missing wiki">TagRevisions?</a> etc.
</p>
<p>
So for example if you compare this table:
<a class="ext-link" href="http://ckan.net/package/history/osm"><span class="icon">​</span>http://ckan.net/package/history/osm</a>
with this view:
<a class="ext-link" href="http://ckan.net/package/osm%402010-11-30%2000%3A21%3A49.627830"><span class="icon">​</span>http://ckan.net/package/osm%402010-11-30%2000%3A21%3A49.627830</a>
you actually see the 2010-01-13 11:13 revision - the wrong revision.
</p>

                            
                          </td>
                          <td class="PosixTime">1311351303000000
                          </td>
                          <td class="ModifiedTime">1311759784000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1244.html">#1244</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">assigned
                          </td>
                          <td class="resolution">
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1244.html">Notes field carriage-returns converted to CRLF</a>
                          </td>
                          <td class="description">
                            <p>
When you edit a package in the web form, if the notes field had <tt>\n</tt> as the End Of Line symbol, it gets lost when you preview or save the package, and the notes field is displayed all on one line.
</p>
<p>
This can be seen when editing annakarenina (as created by 'paster create-test-data'). The diff shows for example:
</p>
<pre class="wiki">- Some test notes
+ Some test notes
?                +
</pre><p>
but it would more clearly be shown as:
</p>
<pre class="wiki">- Some test notes\n
+ Some test notes
?                ++
</pre><p>
This is a significant problem with DGU, since a lot comes in via the API.
</p>
<p>
It's not clear what we should do about it. We could standardise on \n or \r\n when the form submission comes in. Do different browsers on different platforms do different things with EOLs?
</p>
<h2 id="Analysis">Analysis</h2>
<p>
Displaying the package: the Markdown processor respects both EOLs when displaying the field, putting each line in a &lt;p&gt; tag.
</p>
<p>
Creating the package edit form: placed into &lt;textfield&gt;. 
</p>
<p>
Browser displaying package edit form: &lt;textfield&gt; displays \n and \r\n as EOL. But \n\n gets compressed to one EOL. But on submission, both are returned as \r\n.
</p>
<p>
Receiving the edited package: Somewhere along the line the EOL gets converted to \n\n.
</p>

                            
                          </td>
                          <td class="PosixTime">1311689456000000
                          </td>
                          <td class="ModifiedTime">1340191253000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1247.html">#1247</a>
                          </td>
                          <td class="type">task
                          </td>
                          <td class="owner">rgrp
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-10-28.html">ckan-sprint-2011-10-28</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1247.html">Put docs on ReadTheDocs</a>
                          </td>
                          <td class="description">
                            <p>
Put docs on <a class="missing wiki">ReadTheDocs?</a> instead of eu13.
</p>

                            
                          </td>
                          <td class="PosixTime">1311941948000000
                          </td>
                          <td class="ModifiedTime">1311955185000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1248.html">#1248</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-11-07.html">ckan-sprint-2011-11-07</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1248.html">License exception</a>
                          </td>
                          <td class="description">
                            <p>
Exception received on test.ckan.net at 10.12 on 29/7/11
</p>
<pre class="wiki">http://test.ckan.net/package?__cache=2759373&amp;page=4
Module pylons.controllers.core:60 in _perform_call
&lt;&lt;          """Hide the traceback for everything above this method"""
               __traceback_hide__ = 'before_and_this'
               return func(**args)
           
           def _inspect_call(self, func):
&gt;&gt;  return func(**args)
Module ckan.controllers.package:153 in search
&lt;&lt;                          }
       
                   query = get.package_search(context,data_dict)
       
                   c.page = h.Page(
&gt;&gt;  query = get.package_search(context,data_dict)
Module ckan.logic.action.get:514 in package_search
&lt;&lt;      for package in query.results:
               result_dict = table_dictize(package, context)
               result_dict = _extend_package_dict(result_dict,context)
       
               results.append(result_dict)
&gt;&gt;  result_dict = _extend_package_dict(result_dict,context)
Module ckan.logic.action.get:537 in _extend_package_dict
&lt;&lt;      license_id = package_dict['license_id']
           if license_id:
               isopen = model.Package.get_license_register()[license_id].isopen()
               package_dict['isopen'] = isopen
           else:
&gt;&gt;  isopen = model.Package.get_license_register()[license_id].isopen()
Module ckan.model.license:59 in __getitem__
&lt;&lt;              return default
               else:
                   raise KeyError, "License not found: %s" % key
       
           def get(self, key, default=None):
&gt;&gt;  raise KeyError, "License not found: %s" % key
KeyError: u'License not found: None'
</pre><p>
and a similar one: 
</p>
<pre class="wiki"> http://test.ckan.net/tag/barbecue
Module pylons.wsgiapp:324 in dispatch
&lt;&lt;          if log_debug:
                   log.debug("Calling controller class with WSGI interface")
               return controller(environ, start_response)
           
           def load_test_env(self, environ):
&gt;&gt;  return controller(environ, start_response)
Module ckan.lib.base:118 in __call__
&lt;&lt;          # available in environ['pylons.routes_dict']    
               try:
                   return WSGIController.__call__(self, environ, start_response)
               finally:
                   model.Session.remove()
&gt;&gt;  return WSGIController.__call__(self, environ, start_response)
Module pylons.controllers.core:221 in __call__
&lt;&lt;                  return response(environ, self.start_response)
               
               response = self._dispatch_call()
               if not start_response_called:
                   self.start_response = start_response
&gt;&gt;  response = self._dispatch_call()
Module pylons.controllers.core:172 in _dispatch_call
&lt;&lt;              req.environ['pylons.action_method'] = func
                   
                   response = self._inspect_call(func)
               else:
                   if log_debug:
&gt;&gt;  response = self._inspect_call(func)
Module pylons.controllers.core:107 in _inspect_call
&lt;&lt;                        func.__name__, args)
               try:
                   result = self._perform_call(func, args)
               except HTTPException, httpe:
                   if log_debug:
&gt;&gt;  result = self._perform_call(func, args)
Module pylons.controllers.core:60 in _perform_call
&lt;&lt;          """Hide the traceback for everything above this method"""
               __traceback_hide__ = 'before_and_this'
               return func(**args)
           
           def _inspect_call(self, func):
&gt;&gt;  return func(**args)
Module ckan.controllers.tag:2 in read
Module ckan.lib.cache:167 in wrapper
&lt;&lt;      log = __import__("logging").getLogger("proxy_cache")
           def wrapper(func, *args, **kwargs):
               result = func(*args, **kwargs)
       
               pylons = get_pylons(args)
&gt;&gt;  result = func(*args, **kwargs)
Module ckan.controllers.tag:64 in read
&lt;&lt;          data_dict = {'id':id}
               try:
                   c.tag = get.tag_show(context,data_dict)
               except NotFound:
                   abort(404, _('Tag not found'))
&gt;&gt;  c.tag = get.tag_show(context,data_dict)
Module ckan.logic.action.get:341 in tag_show
&lt;&lt;      extended_packages = []
           for package in tag_dict['packages']:
               extended_packages.append(_extend_package_dict(package,context))
       
           tag_dict['packages'] = extended_packages
&gt;&gt;  extended_packages.append(_extend_package_dict(package,context))
Module ckan.logic.action.get:537 in _extend_package_dict
&lt;&lt;      license_id = package_dict['license_id']
           if license_id:
               isopen = model.Package.get_license_register()[license_id].isopen()
               package_dict['isopen'] = isopen
           else:
&gt;&gt;  isopen = model.Package.get_license_register()[license_id].isopen()
Module ckan.model.license:59 in __getitem__
&lt;&lt;              return default
               else:
                   raise KeyError, "License not found: %s" % key
       
           def get(self, key, default=None):
&gt;&gt;  raise KeyError, "License not found: %s" % key
KeyError: u'License not found: CreativeCommonsAttributionCCBY25'
</pre>
                            
                          </td>
                          <td class="PosixTime">1311954136000000
                          </td>
                          <td class="ModifiedTime">1319797763000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1254.html">#1254</a>
                          </td>
                          <td class="type">task
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-10-28.html">ckan-sprint-2011-10-28</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1254.html">Feature sheet</a>
                          </td>
                          <td class="description">
                            <p>
Compose a feature list for CKAN. Use the existing Feature Matrix. Basic explanation of terms. For use by customers.
</p>

                            
                          </td>
                          <td class="PosixTime">1312211925000000
                          </td>
                          <td class="ModifiedTime">1313401629000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1257.html">#1257</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-backlog.html">ckan-backlog</a>
                          </td>
                          <td class="status">new
                          </td>
                          <td class="resolution">
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1257.html">Anti-Spam tools</a>
                          </td>
                          <td class="description">
                            <p>
We are getting more and more spam on ckan.net and we need to improve our strategy of combating it. It is bad because google ranks who we link to (which we do want for legitimate links), and our front page contains the latest package edits, so spam is immediately very visible.
</p>
<p>
Spam:
</p>
<ul><li>Package creation
</li><li>Package edit
</li><li>User creation
</li><li>Group creation
</li></ul><p>
Systems to consider:
</p>
<ul><li>Automatic
<ul><li>captcha
</li><li>bayesian scoring
</li></ul></li><li>Sysadmin
<ul><li>a tool to quickly analyse and remove packages, edits and users
</li></ul></li><li>Helpful users
<ul><li>button to click indicating spam, leading to any/all of: 
<ul><li>add TODO item (which emails package admin and sysadmins)
</li><li>quarantine the package/user so it doesn't show up on the front page and a warning is shown when you view it
</li></ul></li></ul></li></ul><p>
General thoughts:
</p>
<ul><li>We should learn from the wikipedia tools, as they are the experts
</li><li>This is a serious problem that is only going to get worse and is a threat to the whole site.
</li></ul>
                            
                          </td>
                          <td class="PosixTime">1312283565000000
                          </td>
                          <td class="ModifiedTime">1339774129000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1263.html">#1263</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1263.html">Bad name for logic action in API causes Exception</a>
                          </td>
                          <td class="description">
                            <p>
A bad action name:
e.g.
curl <a class="ext-link" href="http://test.ckan.net/api/action/user_showaa"><span class="icon">​</span>http://test.ckan.net/api/action/user_showaa</a> -d '{}'
causes 500 response.
</p>
<p>
Occurs only on 1.4.3 beta.
</p>

                            
                          </td>
                          <td class="PosixTime">1312479020000000
                          </td>
                          <td class="ModifiedTime">1314029279000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1265.html">#1265</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-10-28.html">ckan-sprint-2011-10-28</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1265.html">user/edit error conditions cause exceptions</a>
                          </td>
                          <td class="description">
                            <p>
We get exceptions on these occasions:
</p>
<ul><li>user/edit if not logged in
</li><li>user/edit/bob if bob is not a known user
</li></ul><p>
These are a problem only on 1.4.3b.
</p>
<p>
Introduced in <a class="closed ticket" href="../ticket/1229.html" title="enhancement: Refactor all database code out of the controllers and into the logic layer (closed: fixed)">#1229</a> - merge of branch feature-1229-db-out-of-controllers
</p>

                            
                          </td>
                          <td class="PosixTime">1312565788000000
                          </td>
                          <td class="ModifiedTime">1312566052000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1266.html">#1266</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-10-28.html">ckan-sprint-2011-10-28</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1266.html">Timestamps without microseconds causing exception</a>
                          </td>
                          <td class="description">
                            <p>
I'm not sure why some timestamps are missing microseconds in the ckan.net data, but plenty seem to. This causes this exception when viewing the package rss feed:
</p>
<pre class="wiki">URL: http://ckan.net/package/history/sfk_publishing?format=atom&amp;days=7
In Module ckan.lib.helpers:227 in date_str_to_datetime
WebApp Error: &lt;type 'exceptions.ValueError'&gt;: time data '2008-04-13T20:40:20' does not match format '%Y-%m-%dT%H:%M:%S.%f'
</pre><p>
Only seen with ckan 1.4.3b
</p>

                            
                          </td>
                          <td class="PosixTime">1312794831000000
                          </td>
                          <td class="ModifiedTime">1312797477000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1267.html">#1267</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1267.html">Random exception: cannot set the body to a unicode value</a>
                          </td>
                          <td class="description">
                            <p>
Occasionally see this problem when producing an error page. Here's an example
</p>
<pre class="wiki">WebApp Error: &lt;type 'exceptions.TypeError'&gt;: You cannot set the body to a unicode value without a charset
URL: http://at.ckan.net/authorizationgroup/new
Module weberror.errormiddleware:162 in __call__
&lt;&lt;              __traceback_supplement__ = Supplement, self, environ
                   sr_checker = ResponseStartChecker(start_response)
                   app_iter = self.application(environ, sr_checker)
                   return self.make_catching_iter(app_iter, environ, sr_checker)
               except:
&gt;&gt;  app_iter = self.application(environ, sr_checker)
Module beaker.middleware:73 in __call__
&lt;&lt;                                                     self.cache_manager)
               environ[self.environ_key] = self.cache_manager
               return self.app(environ, start_response)
&gt;&gt;  return self.app(environ, start_response)
Module beaker.middleware:152 in __call__
&lt;&lt;                          headers.append(('Set-cookie', cookie))
                   return start_response(status, headers, exc_info)
               return self.wrap_app(environ, session_start_response)
           
           def _get_session(self):
&gt;&gt;  return self.wrap_app(environ, session_start_response)
Module routes.middleware:130 in __call__
&lt;&lt;                  environ['SCRIPT_NAME'] = environ['SCRIPT_NAME'][:-1]
               
               response = self.app(environ, start_response)
               
               # Wrapped in try as in rare cases the attribute will be gone already
&gt;&gt;  response = self.app(environ, start_response)
Module pylons.wsgiapp:125 in __call__
&lt;&lt;          
               controller = self.resolve(environ, start_response)
               response = self.dispatch(controller, environ, start_response)
               
               if 'paste.testing_variables' in environ and hasattr(response,
&gt;&gt;  response = self.dispatch(controller, environ, start_response)
Module pylons.wsgiapp:324 in dispatch
&lt;&lt;          if log_debug:
                   log.debug("Calling controller class with WSGI interface")
               return controller(environ, start_response)
           
           def load_test_env(self, environ):
&gt;&gt;  return controller(environ, start_response)
Module ckan.lib.base:117 in __call__
&lt;&lt;          # available in environ['pylons.routes_dict']    
               try:
                   return WSGIController.__call__(self, environ, start_response)
               finally:
                   model.Session.remove()
&gt;&gt;  return WSGIController.__call__(self, environ, start_response)
Module pylons.controllers.core:284 in __call__
&lt;&lt;              if log_debug:
                       log.debug("Calling Response object to return WSGI data")
                   return response(environ, self.start_response)
               
               if log_debug:
&gt;&gt;  return response(environ, self.start_response)
Module webob.exc:248 in __call__
&lt;&lt;              return []
               if not self.body and not self.empty_body:
                   return self.generate_response(environ, start_response)
               return Response.__call__(self, environ, start_response)
&gt;&gt;  return self.generate_response(environ, start_response)
Module webob.exc:239 in generate_response
&lt;&lt;              status=self.status,
                   headerlist=headerlist,
                   content_type=content_type
               )
               return resp(environ, start_response)
&gt;&gt;  content_type=content_type
Module webob.response:94 in __init__
&lt;&lt;                  if charset is None:
                           raise TypeError(
                               "You cannot set the body to a unicode value without a charset")
                       body = body.encode(charset)
                   self._body = body
&gt;&gt;  "You cannot set the body to a unicode value without a charset")
TypeError: You cannot set the body to a unicode value without a charset
</pre>
                            
                          </td>
                          <td class="PosixTime">1312889084000000
                          </td>
                          <td class="ModifiedTime">1312897724000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1270.html">#1270</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-10-28.html">ckan-sprint-2011-10-28</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1270.html">Default site www.ckan.net is a redirect and loses POSTs</a>
                          </td>
                          <td class="description">
                            <p>
The default site was www.ckan.net, which had an Apache 301 redirect to ckan.net, but the problem was urllib was not rePOSTing stuff. This affected search parameters:
</p>
<pre class="wiki">In [1]: import ckanclient

In [2]: c = ckanclient.CkanClient()

In [3]: c2 = ckanclient.CkanClient('http://ckan.net/api')

In [4]: c.package_search('', search_options={'groups':'openspending'})
Out[4]: 
{u'count': 2102,
 u'results': &lt;generator object _result_generator at 0x10168b1e0&gt;}

In [5]: c2.package_search('', search_options={'groups':'openspending'})
Out[5]: {u'count': 29, u'results': &lt;generator object _result_generator at 0x10168b410&gt;}
</pre><p>
Thanks to borior for finding this and raising it.
</p>

                            
                          </td>
                          <td class="PosixTime">1312911847000000
                          </td>
                          <td class="ModifiedTime">1312912188000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1283.html">#1283</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-backlog.html">ckan-backlog</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1283.html">Deleted packages shouldn't be searchable or browsable</a>
                          </td>
                          <td class="description">
                            <p>
A package in deleted state doesn't show to general users, but admins DO see them. The idea is that they can resurrect them if they want. But now we have the trash can that lists deleted packages. So we don't want admins to see the deleted packages anywhere else. 
</p>
<p>
(But an admin should still be able to READ and EDIT a deleted package, so if he clicks on it in the trash list he can see it to decide whether to resurrect and actually be able to change its state.)
</p>
<p>
Same in the Web interface and API.
</p>
<p>
This ticket ties in with <a class="assigned ticket" href="../ticket/948.html" title="enhancement: Highlight (to a sysadmin) which packages are deleted (assigned)">#948</a> highlighting a package being deleted (when viewing or editing) and follows on from the introduction of the trash can <a class="closed ticket" href="../ticket/1076.html" title="enhancement: Improve revision and package purge system (closed: fixed)">#1076</a>.
</p>

                            
                          </td>
                          <td class="PosixTime">1314112481000000
                          </td>
                          <td class="ModifiedTime">1330083933000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1285.html">#1285</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-future.html">ckan-future</a>
                          </td>
                          <td class="status">assigned
                          </td>
                          <td class="resolution">
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1285.html">Errors cause emails</a>
                          </td>
                          <td class="description">
                            <p>
Currently a sysadmin gets an email when an exception is not caught. But there are occasions when we DO want to catch an exception so we can fail nicely for the user, but the sysadmin STILL gets an email to know to fix something.
e.g. if there is an exception when search indexes a package. You want to catch the exception and still run any other notify calls.
</p>

                            
                          </td>
                          <td class="PosixTime">1314116944000000
                          </td>
                          <td class="ModifiedTime">1338206151000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1287.html">#1287</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">thejimmyg
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-backlog.html">ckan-backlog</a>
                          </td>
                          <td class="status">assigned
                          </td>
                          <td class="resolution">
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1287.html">NAVL validation errors - Junk fields should be listed explicitly</a>
                          </td>
                          <td class="description">
                            <p>
When you create a package, but specify a key that is not allowed (e.g. 'relationships') then you get error message:
</p>
<pre class="wiki">{"__junk": ["The input field __junk was not expected."]}
</pre><p>
It should mention the actual key which is not expected. e.g.
</p>
<pre class="wiki">{"relationships": ["The input field 'relationships' was not expected."]}
</pre><p>
Kindly said that James' version of NAVL was better in this respect, so this might be best solved by moving to that.
</p>

                            
                          </td>
                          <td class="PosixTime">1314203102000000
                          </td>
                          <td class="ModifiedTime">1330990459000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1288.html">#1288</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-backlog.html">ckan-backlog</a>
                          </td>
                          <td class="status">new
                          </td>
                          <td class="resolution">
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1288.html">Package edit/creation can't include 'relationships' field</a>
                          </td>
                          <td class="description">
                            <p>
When you create or edit a package (via the API), you aren't able to specify the relationships it has. (If you do you get 409 <tt> {"__junk": ["The input field __junk was not expected."]} </tt>)
</p>
<p>
The normal way to create relationships is via /api/rest/relationships/ and this works. But when you GET a package, the dictionary lists all relationship details. So this bug creates a problem for editing a package that has relationships - you want to GET it, make any edits and then PUT it back. The work-around is to delete the 'relationships' key from the dict before you PUT it back.
</p>
<h2 id="Options">Options</h2>
<p>
Ideally, CKAN would read the 'relationships' key and make the necessary changes. This is a chunk of work.
</p>
<p>
Another good option is to allow an unchanged 'relationships' value, but barf it is edited. This is also a chunk of work.
</p>
<p>
A bad option would be to just ignore the 'relationships' value, since users will get frustrated changing this value and wonder why it never saves, not understanding it is different to all the rest, without error message.
</p>
<p>
A final option is to get rid of relationships altogether.
</p>

                            
                          </td>
                          <td class="PosixTime">1314203695000000
                          </td>
                          <td class="ModifiedTime">1339774098000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1289.html">#1289</a>
                          </td>
                          <td class="type">CREP
                          </td>
                          <td class="owner">
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-backlog.html">ckan-backlog</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">wontfix
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1289.html">Remove 'relationships'</a>
                          </td>
                          <td class="description">
                            <h2 id="Abstract">Abstract</h2>
<p>
Package Relationships have not taken off in the 18 months we've had them in the API. There are some issues with them and we need to spend more time improving them or consider getting rid of them.
</p>
<h2 id="TheProblem">The Problem</h2>
<p>
Original use cases are expressed here: <a class="assigned ticket" href="../ticket/253.html" title="enhancement: Package relationships (assigned)">#253</a> Here are comments about how we could handle these specific examples better:
</p>
<ol><li>groups of packages - maybe better with a custom tag?
</li><li>fragment resources - soon to be covered by 'kind' resource field <a class="closed ticket" href="../ticket/957.html" title="enhancement: new &#34;kind &#34; field added to resources (closed: wontfix)">#957</a>
</li></ol><p>
3&amp;5. derived resource - better to have some sort of resource relationship perhaps?
</p>
<ol start="4"><li>linked resource - again better to have some sort of resource relationship perhaps?
</li></ol><p>
Outstanding issues needing serious effort to fix:
</p>
<ul><li><a class="assigned ticket" href="../ticket/256.html" title="requirement: Package relationships - 3. Edit in WUI (assigned)">#256</a> Editing them in Web UI (not done yet)
</li><li><a class="new ticket" href="../ticket/1288.html" title="defect: Package edit/creation can't include 'relationships' field (new)">#1288</a> Package edit/creation can't include 'relationships' field
</li></ul><h2 id="Specification">Specification</h2>
<p>
Remove relationships from model, API, tests, Web UI. Data migration to remove from db.
</p>
<h2 id="Whydoitthisway">Why do it this way</h2>
<p>
Getting frustrated having problems with the code, when it's not used much. Often asked about what it's for, but rarely used. Seems an overly complicated design.
</p>
<h2 id="BackwardsCompatibility">Backwards Compatibility</h2>
<p>
n/a
</p>
<h2 id="Implementationplan">Implementation plan</h2>
<h3 id="Deliverables">Deliverables</h3>
<p>
See Specification
</p>
<h3 id="Risksandmitigations">Risks and mitigations</h3>
<p>
Risk: a customer suddenly wants this, and the new ways to relate resources are not in place yet.
</p>
<p>
Mitigation: discuss this decision thoroughly to make sure we are confident the use cases are not important. Discuss with team, ckan-discuss and specifically the LOD people who have some related packages on thedatahub.org.
</p>
<h3 id="Participants">Participants</h3>
<p>
David Read
</p>
<h3 id="Progress">Progress</h3>
<p>
Not yet.
</p>

                            
                          </td>
                          <td class="PosixTime">1314206502000000
                          </td>
                          <td class="ModifiedTime">1317315211000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1290.html">#1290</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-backlog.html">ckan-backlog</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1290.html">Better error when blank database</a>
                          </td>
                          <td class="description">
                            <p>
When installing CKAN, when doing "paster serve development.ini", lots of users encounter the error for every request: 
</p>
<pre class="wiki">ProgrammingError: (ProgrammingError) relation "user" does not exist
</pre><p>
This is because the database tables have not been created - they have forgotten or missed the "paster db init" step.
</p>
<p>
Can we provide a better error to say that the database is not initialised yet?
</p>
<h2 id="Implementationoptions">Implementation options</h2>
<ol><li>At the start of every request we reflect the database tables and check they are there. This is rather expensive!
</li></ol><ol start="2"><li>Uncached requests to the home page start with a cheap database query. If there is an exception then return this error about database setup. I really like Drupal's page for this that has in large letters that the site is currently off-line. Below a line, in small letters, there are developer suggestions on what is wrong and where to look to fix it.
</li></ol>
                            
                          </td>
                          <td class="PosixTime">1314264255000000
                          </td>
                          <td class="ModifiedTime">1314270894000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1292.html">#1292</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-11-07.html">ckan-sprint-2011-11-07</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1292.html">Internationalization improvements</a>
                          </td>
                          <td class="description">
                            <ul><li>Review process of releases and updating strings (pot) and translations (po) files
<ul><li>c.f. <a class="ext-link" href="http://lists.okfn.org/pipermail/ckan-dev/2011-May/000718.html"><span class="icon">​</span>http://lists.okfn.org/pipermail/ckan-dev/2011-May/000718.html</a>
</li></ul></li><li>Get language changing thing to get home page to mostly work - push to key strings translated (or don't advertise the translation?)
</li><li>Review long list of strings for improvement
<ul><li>Consolidate any?
</li><li>Get rid of i18n for strings in api
</li><li>Try and remove javascript
</li><li>Add in extensions
</li></ul></li><li><a class="closed ticket" href="../ticket/1374.html" title="defect: Can't switch to English if default is non-English (closed: fixed)">#1374</a> Fix switching to en from other default language
</li><li><a class="closed ticket" href="../ticket/1417.html" title="defect: Browser language detection doesn't work (closed: fixed)">#1417</a> Fix browser language detection
</li></ul>
                            
                          </td>
                          <td class="PosixTime">1314303314000000
                          </td>
                          <td class="ModifiedTime">1320145732000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1308.html">#1308</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">shevski
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1308.html">'create package' user case failure</a>
                          </td>
                          <td class="description">
                            <p>
On the CKAN home page there is no suggestion that you can add or register a dataset. The 'Register a dataset' option has been removed at some point! (only visible to users that have registered - why would they do that when the benefits aren't described?)
</p>

                            
                          </td>
                          <td class="PosixTime">1315219500000000
                          </td>
                          <td class="ModifiedTime">1323174312000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1310.html">#1310</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-09-12.html">ckan-sprint-2011-09-12</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1310.html">API GET of a revision that has been approved causes exception</a>
                          </td>
                          <td class="description">
                            <p>
e.g. this particular revision on ckan.net: <a class="ext-link" href="http://ckan.net/api/rest/revision/9601fbcb-03a7-4ebc-981d-5aa16df4852c"><span class="icon">​</span>http://ckan.net/api/rest/revision/9601fbcb-03a7-4ebc-981d-5aa16df4852c</a>
(most others have not been approved)
Causes 500 error.
</p>

                            
                          </td>
                          <td class="PosixTime">1315234899000000
                          </td>
                          <td class="ModifiedTime">1315820419000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1313.html">#1313</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">zephod
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">duplicate
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1313.html">Tweaks to captcha configuration</a>
                          </td>
                          <td class="description">
                            <p>
Awesome to have the captcha implementation and running on thedatahub.org! Here are some further
suggestions concerning the config options, before this goes into a release:
</p>
<ul><li>Document "ckan.recaptcha.publickey" and "ckan.recaptcha.privatekey" in doc/configuration.rst
</li><li>Which one config option defines whether recaptcha is enabled? There is disagreement between the template and the lib. Maybe better to have a third option for this. When setting the syntax for this, I can see us wanting to use captcha for other operations, like package edit, package create, group create etc. so perhaps we'd want to be able to turn each one on/off separately, using the name of the logic action. e.g. <tt>ckan.recaptcha.enable = user_create, group_create</tt>
</li><li>We got this exception last night from the template:
<pre class="wiki">Module ?:37 in &lt;Expression u'g.recaptcha_publickey'&gt;
&lt;&lt;          &lt;dd&gt;&lt;input type="password" name="password2" value="" /&gt;&lt;/dd&gt;
       
               &lt;dd py:if="g.recaptcha_publickey"&gt;
                 &lt;script type="text/javascript"
                   src="http://www.google.com/recaptcha/api/challenge?k=${g.recaptcha_publickey}"&gt;
&gt;&gt;  &lt;dd py:if="g.recaptcha_publickey"&gt;
Module genshi.template.eval:324 in lookup_attr
&lt;&lt;                      val = obj[key]
                       except (KeyError, TypeError):
                           val = cls.undefined(key, owner=obj)
               return val
&gt;&gt;  val = cls.undefined(key, owner=obj)
Module genshi.template.eval:410 in undefined
&lt;&lt;          """Raise an ``UndefinedError`` immediately."""
               __traceback_hide__ = True
               raise UndefinedError(key, owner=owner)
&gt;&gt;  raise UndefinedError(key, owner=owner)
UndefinedError: &lt;ckan.lib.app_globals.Globals object at 0xb8f1182c&gt; has no member named "recaptcha_publickey"
</pre></li></ul><p>
I'm not sure why - might be something to do with the maintenance on the server, but worth double checking, since we don't want exceptions, say if one or other config variable is not defined.
</p>

                            
                          </td>
                          <td class="PosixTime">1315395185000000
                          </td>
                          <td class="ModifiedTime">1317076432000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1314.html">#1314</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-backlog.html">ckan-backlog</a>
                          </td>
                          <td class="status">assigned
                          </td>
                          <td class="resolution">
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1314.html">ckanclient search - generator improvements</a>
                          </td>
                          <td class="description">
                            <p>
Apparently the search generator always makes two requests, even if you don't want to see the search results, which might be slow. Can this be optimised?
</p>
<p>
Maybe we should also provide a second search function that doesn't use the generator - the original simple search function (that leaves the user to deal with limit &amp; offset).
</p>

                            
                          </td>
                          <td class="PosixTime">1315395410000000
                          </td>
                          <td class="ModifiedTime">1340191233000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1315.html">#1315</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-11-07.html">ckan-sprint-2011-11-07</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1315.html">Document /api/action</a>
                          </td>
                          <td class="description">
                            <p>
We need some documentation for the /api/action. Even though it's beta and subject to change it would be good to have a guide.
</p>

                            
                          </td>
                          <td class="PosixTime">1315396722000000
                          </td>
                          <td class="ModifiedTime">1320173768000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1316.html">#1316</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">kindly
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1316.html">/api/action uncaught exception if missing necessary parameter</a>
                          </td>
                          <td class="description">
                            <pre class="wiki">curl http://ckan.net/api/action/package_show -d '{"name": "uk-quango-data"}'
</pre><p>
This gives 500 error due to <a class="missing wiki">KeyError?</a> (it looked for the 'id' param), rather than 400.
</p>

                            
                          </td>
                          <td class="PosixTime">1315397224000000
                          </td>
                          <td class="ModifiedTime">1338193724000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1317.html">#1317</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-backlog.html">ckan-backlog</a>
                          </td>
                          <td class="status">assigned
                          </td>
                          <td class="resolution">
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1317.html">password reset - improve user search</a>
                          </td>
                          <td class="description">
                            <p>
In password reset, it gets confused if you have two similar users. This is because with the string the user provides, it searches several fields, not just name but also fullname and email address, allowing you to search for these. But only name is unique.
</p>
<p>
Specific problem:
Ira searches for "Irina" then it finds both:
<tt>&lt;User name=irina fullname=Irina email=irina.bolychevsky@okfn.org ]</tt>
and
<tt>&lt;User name=shevski fullname=Ira email=&gt;</tt>
(I think)
</p>
<p>
Maybe need to choose which field it searches?
</p>

                            
                          </td>
                          <td class="PosixTime">1315415539000000
                          </td>
                          <td class="ModifiedTime">1340191221000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1318.html">#1318</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-10-28.html">ckan-sprint-2011-10-28</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1318.html">'Register user' doesn't log you in</a>
                          </td>
                          <td class="description">
                            <p>
When you register a user, it doesn't seem to be logged in properly straight away. Top-right it invites you to "log in" and "register". Also the "create package" menu option doesn't appear. Going to /user/me sends you to login page. If you then login, then all these things are corrected.
</p>

                            
                          </td>
                          <td class="PosixTime">1315415783000000
                          </td>
                          <td class="ModifiedTime">1315569362000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1319.html">#1319</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">rgrp
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-10-24.html">ckan-sprint-2011-10-24</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1319.html">Require an email address on User registration</a>
                          </td>
                          <td class="description">
                            <p>
Superticket: <a class="new ticket" href="../ticket/1343.html" title="enhancement: [super] User related improvements (login, user pages etc) (new)">#1343</a>
</p>
<p>
This avoids difficulties when they forget their password.
</p>
<ul><li>(?) Email validation (navl does not have one!)
</li><li>Require email confirmation to be activated (?) (Answer: no, not at present -- see discussion below)
</li></ul>
                            
                          </td>
                          <td class="PosixTime">1315415932000000
                          </td>
                          <td class="ModifiedTime">1324036947000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1321.html">#1321</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-10-24.html">ckan-sprint-2011-10-24</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1321.html">Flash message deferred</a>
                          </td>
                          <td class="description">
                            <p>
When you reset a password, the flash message saying "check your email" sometimes doesn't display on the next page. You then click on the link in your email and it displays on that page (i.e. too late).
</p>
<p>
Seen this on thedatahub.org. To do with the proxy caching?
</p>

                            
                          </td>
                          <td class="PosixTime">1315474657000000
                          </td>
                          <td class="ModifiedTime">1319814460000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1322.html">#1322</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">assigned
                          </td>
                          <td class="resolution">
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1322.html">Action API improvements</a>
                          </td>
                          <td class="description">
                            <p>
Focusing on improving Action API as the v3 API:
</p>
<ul><li>have an optional parameter of the data_dict called "options".  Options would contain items that would get passed into the context. e.g. <tt>{"options" : {"ref_package_by": "id"}}. </tt>
</li><li>instead of using API version to change the way packages are referenced, use the ref_package_by.
</li><li>All package_show, group_show etc. to accept an object 'name' as an alternative to object 'id'.
</li><li>Action API is v3 of api, replacement for v1 &amp; v2. Default for most urls is still v1, but if url is /api/action then default to v3.
</li></ul><p>
Next steps:
</p>
<ul><li>Add search API (package, resource, 
</li><li>Add Util API
</li><li>Clarify JSONP still applies
</li><li>Add doc strings, clarifying parameters
</li></ul>
                            
                          </td>
                          <td class="PosixTime">1315474749000000
                          </td>
                          <td class="ModifiedTime">1340191088000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1323.html">#1323</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-10-28.html">ckan-sprint-2011-10-28</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1323.html">GET /authorizationgroup causes Exception when logged in</a>
                          </td>
                          <td class="description">
                            <p>
on thedatahub.org
</p>

                            
                          </td>
                          <td class="PosixTime">1315475685000000
                          </td>
                          <td class="ModifiedTime">1315594333000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1325.html">#1325</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-09-12.html">ckan-sprint-2011-09-12</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1325.html">python 2.5 incompatibilities</a>
                          </td>
                          <td class="description">
                            <p>
We claim to support Python 2.5 (useful for Lenny), yet a few problems have crept in:
</p>
<ul><li>'with' statement requires <tt>from __future__ import with_statement</tt>
</li><li>import json from ckan.lib.helpers, rather than directly, since it copes with reverting to simplejson, used in python 2.5.
</li></ul>
                            
                          </td>
                          <td class="PosixTime">1315580452000000
                          </td>
                          <td class="ModifiedTime">1315587113000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1331.html">#1331</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">worksforme
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1331.html">Setting a tag twice causes exception</a>
                          </td>
                          <td class="description">
                            <p>
To reproduce:
</p>
<ol><li>Create a package with two tags the same: "bulk bulk"
</li><li>Click 'save'
</li><li>500 ERROR - 'Server Error'
</li></ol>
                            
                          </td>
                          <td class="PosixTime">1315905959000000
                          </td>
                          <td class="ModifiedTime">1325355631000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1332.html">#1332</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1332.html">i18n IndexError exceptions</a>
                          </td>
                          <td class="description">
                            <p>
We get this i18n error for the URL <a class="ext-link" href="http://no.ckan.net/authorizationgroup"><span class="icon">​</span>http://no.ckan.net/authorizationgroup</a> (which runs 1.4.2 with Norwegian translation). I'm not sure why it occurs. Fixing it is low importance though, because this site doesn't use Authorization Group feature
</p>
<p>
Usually caused by bots. The user does not appear to be logged in.
</p>
<pre class="wiki">WebApp Error: &lt;type 'exceptions.IndexError'&gt;: list index out of range
...
Module genshi.filters.i18n:177 in _generate
&lt;&lt;                  msgbuf.append(*previous)
                       previous = None
                   for event in msgbuf.translate(gettext(msgbuf.format())):
                       yield event
                   if previous:
&gt;&gt;  for event in msgbuf.translate(gettext(msgbuf.format())):
Module genshi.filters.i18n:1029 in translate
&lt;&lt;                      )
       
               parts = parse_msg(string)
               parts_counter = {}
               for order, string in parts:
&gt;&gt;  parts = parse_msg(string)
Module genshi.filters.i18n:1143 in parse_msg
&lt;&lt;      if string:
               parts.append((stack[-1], string))
       
           return parts
&gt;&gt;  parts.append((stack[-1], string))
IndexError: list index out of range
</pre>
                            
                          </td>
                          <td class="PosixTime">1315906429000000
                          </td>
                          <td class="ModifiedTime">1315999104000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1335.html">#1335</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">kindly
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1335.html">Action API - basic</a>
                          </td>
                          <td class="description">
                            <p>
Provide an API to the logic layer at /api/action.
</p>

                            
                          </td>
                          <td class="PosixTime">1315910021000000
                          </td>
                          <td class="ModifiedTime">1315910117000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1336.html">#1336</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">johnglover
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-backlog.html">ckan-backlog</a>
                          </td>
                          <td class="status">new
                          </td>
                          <td class="resolution">
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1336.html">License fudge</a>
                          </td>
                          <td class="description">
                            <p>
cset:4b59ab34137d ckan/logic/action/get.py:
</p>
<pre class="wiki">-            isopen = model.Package.get_license_register()[license_id].isopen()
-            result_dict['isopen'] = isopen
+            try:
+                isopen = model.Package.get_license_register()[license_id].isopen()
+                result_dict['isopen'] = isopen
+            except KeyError:
+                # TODO: create a log message this error?
+                result_dict['isopen'] = False 

</pre><p>
This change hides problems with the license server and returns potentially incorrect values for openness. 
</p>
<p>
This has been noted as 'temporary fix' but seems to be forgotten about, since it has been merged to default and gone into release 1.4.3.
</p>
<p>
I suggest the licenses are cached (I thought this was already the case when CKAN first requests them after start-up?). I suggest failure would return 503.
</p>

                            
                          </td>
                          <td class="PosixTime">1315912057000000
                          </td>
                          <td class="ModifiedTime">1323173073000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1340.html">#1340</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-10-28.html">ckan-sprint-2011-10-28</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1340.html">Editing non-existent group causes Exception</a>
                          </td>
                          <td class="description">
                            <p>
e.g. <a class="ext-link" href="http://ckan.net/group/edit/history"><span class="icon">​</span>http://ckan.net/group/edit/history</a>
</p>
<pre class="wiki">Module ckan.controllers.group:135 in edit
&lt;&lt;          try:
                   old_data = get_action('group_show')(context, data_dict)
                   c.grouptitle = old_data.get('title')
                   c.groupname = old_data.get('name')
&gt;&gt;  old_data = get_action('group_show')(context, data_dict)
Module ckan.logic.action.get:347 in group_show
&lt;&lt;      if group is None:
               raise NotFound
       
           check_access('group_show',context, data_dict)
&gt;&gt;  raise NotFound
</pre>
                            
                          </td>
                          <td class="PosixTime">1315991374000000
                          </td>
                          <td class="ModifiedTime">1315991534000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1346.html">#1346</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-10-28.html">ckan-sprint-2011-10-28</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1346.html">'get_authorization_group_dict not found' exception</a>
                          </td>
                          <td class="description">
                            <p>
This stems from a feature to allow you to prefill fields in the authorizationgroup creation form. 
</p>
<p>
e.g. <a class="ext-link" href="http://ckan.net/authorizationgroup/new?name=science"><span class="icon">​</span>http://ckan.net/authorizationgroup/new?name=science</a>
</p>
<p>
It's not tested, not supported in the new logic layer and therefore broken. I don't think anyone uses it - can remove it.
</p>

                            
                          </td>
                          <td class="PosixTime">1316081974000000
                          </td>
                          <td class="ModifiedTime">1316094632000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1347.html">#1347</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-10-28.html">ckan-sprint-2011-10-28</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1347.html">Exception caused by New Group form POST with bad formed parameter</a>
                          </td>
                          <td class="description">
                            <p>
Exception caused by bots POSTing 'new group' form, but with bad (old-style) parameters.
</p>
<pre class="wiki">&lt;type 'exceptions.ValueError'&gt;: invalid literal for int() with base 10: 'cache'
...
Module ckan.controllers.group:102 in new
&lt;&lt;          if context['save'] and not data:
                   return self._save_new(context)
               
               data = data or {}
&gt;&gt;  return self._save_new(context)
Module ckan.controllers.group:152 in _save_new
&lt;&lt;          try:
                   data_dict = clean_dict(unflatten(
                       tuplize_dict(parse_params(request.params))))
                   context['message'] = data_dict.get('log_message', '')
                   group = create.group_create(data_dict, context)
&gt;&gt;  tuplize_dict(parse_params(request.params))))
Module ckan.logic:57 in tuplize_dict
&lt;&lt;          for num, key in enumerate(key_list):
                   if num % 2 == 1:
                       key_list[num] = int(key)
               tuplized_dict[tuple(key_list)] = value
           return tuplized_dict
&gt;&gt;  key_list[num] = int(key)
ValueError: invalid literal for int() with base 10: 'cache'
</pre>
                            
                          </td>
                          <td class="PosixTime">1316094466000000
                          </td>
                          <td class="ModifiedTime">1316094608000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1365.html">#1365</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-11-07.html">ckan-sprint-2011-11-07</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1365.html">Support old search formats</a>
                          </td>
                          <td class="description">
                            <p>
Lots of things rely on the old (i.e. pre-SOLR) search param formats, including ckanclient / DGU. Need a translation layer to convert these params (in api v1&amp;2) to SOLR syntax.
</p>
<p>
This functionality was broken by the changes in <a class="closed ticket" href="../ticket/1277.html" title="enhancement: Use solr query parser for search instead of ckan query parser (closed: fixed)">#1277</a> which went into 1.5a
</p>

                            
                          </td>
                          <td class="PosixTime">1317233338000000
                          </td>
                          <td class="ModifiedTime">1319815052000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1366.html">#1366</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-future.html">ckan-future</a>
                          </td>
                          <td class="status">assigned
                          </td>
                          <td class="resolution">
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1366.html">Search inside extra fields</a>
                          </td>
                          <td class="description">
                            <p>
SOLR search doesn't support searching for part of an extra field, but it does for other fields.
</p>
<p>
i.e. title="One Two Three" matches q=one AND q=title:one
and geographic_coverage="England Scotland" matches q=England BUT NOT q=geographic_coverage:England
</p>
<p>
This problem emerged when we went to SOLR in <a class="closed ticket" href="../ticket/1275.html" title="enhancement: Move solr search extension to ckan core (closed: fixed)">#1275</a> (CKAN 1.5a). Tests were skipped.
</p>
<p>
This is could be a problem for DGU and maybe elsewhere.
</p>

                            
                          </td>
                          <td class="PosixTime">1317290992000000
                          </td>
                          <td class="ModifiedTime">1338206707000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1367.html">#1367</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1367.html">PyPI ckan broken</a>
                          </td>
                          <td class="description">
                            <p>
manifest.cfg was not included in the pypi package, causing <a class="missing wiki">InvalidRepositoryError?</a> when you do 'paster db init'. 
</p>
<p>
Appears to affect most CKAN PyPI releases up to and including 1.4.3.
</p>

                            
                          </td>
                          <td class="PosixTime">1317379931000000
                          </td>
                          <td class="ModifiedTime">1317394273000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1374.html">#1374</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-10-24.html">ckan-sprint-2011-10-24</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1374.html">Can't switch to English if default is non-English</a>
                          </td>
                          <td class="description">
                            <p>
e.g. cz.ckan.net defaults to Czech (config option lang=cs_CZ) but it fails when you try to switch to English.
</p>

                            
                          </td>
                          <td class="PosixTime">1317893975000000
                          </td>
                          <td class="ModifiedTime">1319648746000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1385.html">#1385</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1385.html">Resolve postgres permissions issues</a>
                          </td>
                          <td class="description">
                            <p>
Currently there is a problem because the docs guide us to set the sqlalchemy url to use 'localhost' i.e. loopback, whereas paster commands don't specify '-h localhost' so use unix sockets (you need to do 'sudo -u postgres'). These should be the same.
</p>
<p>
Also do we need to tell people to add a line to their postgres authentication config /etc/postgresql/8.4/main/pg_hba.conf
to help things? Florian suggests:
</p>
<pre class="wiki">local   std         std                          md5
</pre><p>
/etc/postgresql/8.4/main/pg_hba.conf
</p>

                            
                          </td>
                          <td class="PosixTime">1318418537000000
                          </td>
                          <td class="ModifiedTime">1326218703000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1388.html">#1388</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-backlog.html">ckan-backlog</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1388.html">etags caching on home page</a>
                          </td>
                          <td class="description">
                            <p>
Needs to update on:
</p>
<ol><li>language - It's broken on thedatahub.org if you change to German and then click on the CKAN icon top-left to go to thedatahub.org again.
</li></ol><p>
AND
</p>
<ol start="2"><li>whether signed in or not - <a class="closed ticket" href="../ticket/1373.html" title="defect: home page view does not react to logging in / out (closed: fixed)">#1373</a>
</li></ol><p>
BUT not latest revisions (which is what it was)
</p>
<p>
Or get rid of etag caching on this page and others?
</p>

                            
                          </td>
                          <td class="PosixTime">1318429443000000
                          </td>
                          <td class="ModifiedTime">1320174229000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1393.html">#1393</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">johnglover
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-backlog.html">ckan-backlog</a>
                          </td>
                          <td class="status">assigned
                          </td>
                          <td class="resolution">
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1393.html">Don't skip search tests</a>
                          </td>
                          <td class="description">
                            <p>
Now we don't use postgres search, all the tests involving search now don't need to be skipped when running on sqlite. Should help coders spot earlier if these tests break. 
</p>

                            
                          </td>
                          <td class="PosixTime">1318505453000000
                          </td>
                          <td class="ModifiedTime">1320153590000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1394.html">#1394</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2012-01-09.html">ckan-sprint-2012-01-09</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1394.html">Resource validation error messages misleading</a>
                          </td>
                          <td class="description">
                            <p>
(Editing a dataset) If the second resource contains any validation error then it says "Resources: Package resource(s) incomplete" and "Resource 1:".
</p>

                            
                          </td>
                          <td class="PosixTime">1318515262000000
                          </td>
                          <td class="ModifiedTime">1325604784000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1407.html">#1407</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">rgrp
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-12-19.html">ckan-sprint-2011-12-19</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1407.html">Stats extension not working</a>
                          </td>
                          <td class="description">
                            <p>
Graphs don't show any more at <a class="ext-link" href="http://thedatahub.org/stats"><span class="icon">​</span>http://thedatahub.org/stats</a>
</p>

                            
                          </td>
                          <td class="PosixTime">1319014605000000
                          </td>
                          <td class="ModifiedTime">1323764239000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1416.html">#1416</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-11-07.html">ckan-sprint-2011-11-07</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1416.html">Registering with blank email can cause exception</a>
                          </td>
                          <td class="description">
                            <p>
This might well be a bot, but not POSTing the email field should not cause an exception - it should be 400 and then the sysadmin doesn't get these nags.
</p>
<pre class="wiki">http://www.publicdata.eu/user/register
...
Module ckan.controllers.user:79 in register
&lt;&lt;              c.login = request.params.getone('login')
                   c.fullname = request.params.getone('fullname')
                   c.email = request.params.getone('email')
                   if not model.User.check_name_available(c.login):
                       h.flash_error(_("That username is not available."))
&gt;&gt;  c.email = request.params.getone('email')
Module webob.multidict:335 in getone
&lt;&lt;          values were found.
               """
               return self._decode_value(self.multi.getone(self._encode_key(key)))
       
           def mixed(self):
&gt;&gt;  return self._decode_value(self.multi.getone(self._encode_key(key)))
Module webob.multidict:99 in getone
&lt;&lt;          v = self.getall(key)
               if not v:
                   raise KeyError('Key not found: %r' % key)
               if len(v) &gt; 1:
                   raise KeyError('Multiple values match %r: %r' % (key, v))
&gt;&gt;  raise KeyError('Key not found: %r' % key)
KeyError: "Key not found: 'email'"
</pre><pre class="wiki">HTTP_USER_AGENT	'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; MRA 4.3 (build 01218); .NET CLR 1.1.4322)'
webob._parsed_post_vars	(MultiDict([('login', 'ahusernames9'), ('fullname', 'ahusernames9'), ('password1', '******'), ('password2', '******'), ('s', 'Sign up')]), &lt;FakeCGIBody at 0xb9d7c5ec viewing MultiDict([('lo...p')])&gt;)
</pre>
                            
                          </td>
                          <td class="PosixTime">1319533989000000
                          </td>
                          <td class="ModifiedTime">1320153507000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1417.html">#1417</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-10-24.html">ckan-sprint-2011-10-24</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1417.html">Browser language detection doesn't work</a>
                          </td>
                          <td class="description">
                            <p>
In Firefox:
</p>
<ul><li>Edit | Preferences | Content | Languages - put 'de' at top language
</li><li>Clear cookies
</li><li>Load thedatahub.org
</li><li>it should be in German, but it's in the default language - English.
</li></ul>
                            
                          </td>
                          <td class="PosixTime">1319539010000000
                          </td>
                          <td class="ModifiedTime">1319651617000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1418.html">#1418</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-10-28.html">ckan-sprint-2011-10-28</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">duplicate
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1418.html">If default language is not 'en' then you can't switch language to 'en'</a>
                          </td>
                          <td class="description">
                            <p>
e.g. cz.ckan.net has lang=cz but when you click on Home page link "English" it flashes message "Language has been set to: English" but the rest of the page is still Czech.
</p>

                            
                          </td>
                          <td class="PosixTime">1319539146000000
                          </td>
                          <td class="ModifiedTime">1319539691000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1419.html">#1419</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-11-07.html">ckan-sprint-2011-11-07</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">invalid
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1419.html">Can't log in via OpenID</a>
                          </td>
                          <td class="description">
                            <p>
I couldn't log into theDataHub with OpenID today. I tried both Google ID and MyOpenID. Both times the login on the remote auth server went fine, but when it returns you to theDataHub you get error "Login failed. Bad username or password."
</p>

                            
                          </td>
                          <td class="PosixTime">1319543013000000
                          </td>
                          <td class="ModifiedTime">1319796164000000
                          </td>
              </tr>
          </tbody>
      </table>
      <div class="paging">
    <span class="previous">
      <a href="22%3Fsort=reporter&amp;asc=0&amp;page=22.html" title="Previous Page">←</a>
    </span>
      <span>
        <a href="22%3Fsort=reporter&amp;asc=0&amp;page=13.html" title="Page 13">13</a>
      </span>
      <span>
        <a href="22%3Fsort=reporter&amp;asc=0&amp;page=14.html" title="Page 14">14</a>
      </span>
      <span>
        <a href="22%3Fsort=reporter&amp;asc=0&amp;page=15.html" title="Page 15">15</a>
      </span>
      <span>
        <a href="22%3Fsort=reporter&amp;asc=0&amp;page=16.html" title="Page 16">16</a>
      </span>
      <span>
        <a href="22%3Fsort=reporter&amp;asc=0&amp;page=17.html" title="Page 17">17</a>
      </span>
      <span>
        <a href="22%3Fsort=reporter&amp;asc=0&amp;page=18.html" title="Page 18">18</a>
      </span>
      <span>
        <a href="22%3Fsort=reporter&amp;asc=0&amp;page=19.html" title="Page 19">19</a>
      </span>
      <span>
        <a href="22%3Fsort=reporter&amp;asc=0&amp;page=20.html" title="Page 20">20</a>
      </span>
      <span>
        <a href="22%3Fsort=reporter&amp;asc=0&amp;page=21.html" title="Page 21">21</a>
      </span>
      <span>
        <a href="22%3Fsort=reporter&amp;asc=0&amp;page=22.html" title="Page 22">22</a>
      </span>
      <span>
        <span class="current">23</span>
      </span>
      <span>
        <a href="22%3Fsort=reporter&amp;asc=0&amp;page=24.html" title="Page 24">24</a>
      </span>
      <span>
        <a href="22%3Fsort=reporter&amp;asc=0&amp;page=25.html" title="Page 25">25</a>
      </span>
      <span>
        <a href="22%3Fsort=reporter&amp;asc=0&amp;page=26.html" title="Page 26">26</a>
      </span>
      <span>
        <a href="22%3Fsort=reporter&amp;asc=0&amp;page=27.html" title="Page 27">27</a>
      </span>
    <span class="next">
      <a href="22%3Fsort=reporter&amp;asc=0&amp;page=24.html" title="Next Page">→</a>
    </span>
</div>
      <div id="help"><strong>Note:</strong>
        See <a href="../wiki/TracReports.html">TracReports</a> for help on using and creating reports.</div>
    </div>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="first">
          <a rel="nofollow" href="22%3Fsort=reporter&amp;asc=0&amp;format=rss" class="rss">RSS Feed</a>
        </li><li>
          <a rel="nofollow" href="22%3Fsort=reporter&amp;asc=0&amp;format=csv">Comma-delimited Text</a>
        </li><li>
          <a rel="nofollow" href="22%3Fsort=reporter&amp;asc=0&amp;format=tab">Tab-delimited Text</a>
        </li><li class="last">
          <a rel="nofollow" href="../report%3Fid=22&amp;format=sql">SQL Query</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="../chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Powered by <a href="../about.html"><strong>Trac 0.12.3</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right">Visit the Trac open source project at<br /><a href="http://trac.edgewall.org/">http://trac.edgewall.org/</a></p>
    </div>
  </body>
</html>