<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  


  <head>
    <title>
      {22} Trac tickets – CKAN
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <!--[if IE]><script type="text/javascript">window.location.hash = window.location.hash;</script><![endif]-->
        <link rel="search" href="../search.html" />
        <link rel="help" href="../wiki/TracGuide.html" />
        <link rel="alternate" href="22%3Fsort=ModifiedTime&amp;asc=0&amp;format=rss" type="application/rss+xml" class="rss" title="RSS Feed" /><link rel="alternate" href="22%3Fsort=ModifiedTime&amp;asc=0&amp;format=csv" type="text/plain" title="Comma-delimited Text" /><link rel="alternate" href="22%3Fsort=ModifiedTime&amp;asc=0&amp;format=tab" type="text/plain" title="Tab-delimited Text" /><link rel="alternate" href="../report%3Fid=22&amp;format=sql" type="text/plain" title="SQL Query" />
        <link rel="up" href="../report.html" title="Available Reports" />
        <link rel="next" href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=18.html" title="Next Page" />
        <link rel="start" href="../wiki.1.html" />
        <link rel="stylesheet" href="../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../chrome/common/css/report.css" type="text/css" />
        <link rel="prev" href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=16.html" title="Previous Page" />
        <link rel="shortcut icon" href="../chrome/common/trac.ico" type="image/x-icon" />
        <link rel="icon" href="../chrome/common/trac.ico" type="image/x-icon" />
      <link type="application/opensearchdescription+xml" rel="search" href="../search/opensearch" title="Search CKAN" />
    <script type="text/javascript" src="../chrome/common/js/jquery.js"></script><script type="text/javascript" src="../chrome/common/js/babel.js"></script><script type="text/javascript" src="../chrome/common/js/messages/en_US.js"></script><script type="text/javascript" src="../chrome/common/js/trac.js"></script><script type="text/javascript" src="../chrome/common/js/search.js"></script>
    <!--[if lt IE 7]>
    <script type="text/javascript" src="/chrome/common/js/ie_pre7_hacks.js"></script>
    <![endif]-->
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="http://ckan.org/"><img src="http://assets.okfn.org/p/ckan/img/ckan_logo_shortname.png" alt="CKAN Trac" height="70" /></a>
      </div>
      <form id="search" action="../search.html" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Search" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="../login.html">Login</a></li><li><a href="../prefs.html">Preferences</a></li><li><a href="../wiki/TracGuide.html">Help/Guide</a></li><li><a href="../about.html">About Trac</a></li><li class="last"><a href="../register.html">Register</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first"><a href="../timeline.html">Timeline</a></li><li><a href="../roadmap.html">Roadmap</a></li><li class="active"><a href="../report.html">View Tickets</a></li><li><a href="../search.html">Search</a></li><li class="last"><a href="../wiki.1.html">Wiki</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
          <ul>
              <li class="first"><a href="../report.html">Available Reports</a></li><li class="last"><a href="../query.html">Custom Query</a></li>
          </ul>
        <hr />
      </div>
    <div id="content" class="report">
      <h1>{22} Trac tickets
        <span class="numrows">(2647 matches)</span>
      </h1>
      <form method="get" action="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=17.html">
        <div id="prefs">
          <div>
            <label>
              Max items per page
              <input type="text" name="max" size="10" value="100" />
            </label>
          </div>
          <div class="buttons">
            <input type="submit" value="Update" />
          </div>
        </div>
      </form>
      <div id="description">
        <p>
<a class="ext-link" href="https://github.com/roskakori/tratihubis/blob/master/query_tickets.sql"><span class="icon">​</span>https://github.com/roskakori/tratihubis/blob/master/query_tickets.sql</a>
</p>

      </div>
      <div class="buttons">
      </div>
      <h2 class="report-result">
        Results <span class="numresults">(1601 - 1700 of 2647)</span>
      </h2>
      <div class="paging">
    <span class="previous">
      <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=16.html" title="Previous Page">←</a>
    </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=7.html" title="Page 7">7</a>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=8.html" title="Page 8">8</a>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=9.html" title="Page 9">9</a>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=10.html" title="Page 10">10</a>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=11.html" title="Page 11">11</a>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=12.html" title="Page 12">12</a>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=13.html" title="Page 13">13</a>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=14.html" title="Page 14">14</a>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=15.html" title="Page 15">15</a>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=16.html" title="Page 16">16</a>
      </span>
      <span>
        <span class="current">17</span>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=18.html" title="Page 18">18</a>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=19.html" title="Page 19">19</a>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=20.html" title="Page 20">20</a>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=21.html" title="Page 21">21</a>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=22.html" title="Page 22">22</a>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=23.html" title="Page 23">23</a>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=24.html" title="Page 24">24</a>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=25.html" title="Page 25">25</a>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=26.html" title="Page 26">26</a>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=27.html" title="Page 27">27</a>
      </span>
    <span class="next">
      <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=18.html" title="Next Page">→</a>
    </span>
</div>
      <table class="listing tickets">
          <thead>
        <tr class="trac-columns">
          <th>
            <a href="22%3Fsort=id&amp;asc=1&amp;page=17.html">
              Id
            </a>
          </th><th>
            <a href="22%3Fsort=type&amp;asc=1&amp;page=17.html">
              Type
            </a>
          </th><th>
            <a href="22%3Fsort=owner&amp;asc=1&amp;page=17.html">
              Owner
            </a>
          </th><th>
            <a href="22%3Fsort=reporter&amp;asc=1&amp;page=17.html">
              Reporter
            </a>
          </th><th>
            <a href="22%3Fsort=milestone&amp;asc=1&amp;page=17.html">
              Milestone
            </a>
          </th><th>
            <a href="22%3Fsort=status&amp;asc=1&amp;page=17.html">
              Status
            </a>
          </th><th>
            <a href="22%3Fsort=resolution&amp;asc=1&amp;page=17.html">
              Resolution
            </a>
          </th><th>
            <a href="22%3Fsort=summary&amp;asc=1&amp;page=17.html">
              Summary
            </a>
          </th><th>
            <a href="22%3Fsort=description&amp;asc=1&amp;page=17.html">
              Description
            </a>
          </th><th>
            <a href="22%3Fsort=PosixTime&amp;asc=1&amp;page=17.html">
              Posixtime
            </a>
          </th><th colspan="100" class="desc">
            <a href="22%3Fsort=ModifiedTime&amp;asc=1&amp;page=17.html">
              Modifiedtime
            </a>
          </th>
        </tr>
          </thead>
          <tbody>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/995.html">#995</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">kindly
                          </td>
                          <td class="reporter">kindly
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">wontfix
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/995.html">consolidate caching</a>
                          </td>
                          <td class="description">
                            <p>
Try and minimise the amount of different caching methodologies, especially for api calls.
</p>

                            
                          </td>
                          <td class="PosixTime">1298283499000000
                          </td>
                          <td class="ModifiedTime">1311179009000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/537.html">#537</a>
                          </td>
                          <td class="type">task
                          </td>
                          <td class="owner">wwaites
                          </td>
                          <td class="reporter">wwaites
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">duplicate
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/537.html">Caching and Performance improvement</a>
                          </td>
                          <td class="description">
                            <p>
There are several places where performance is unacceptably slow. Even in places where it is not, the system could still be more responsive for read requests.
</p>
<p>
Introducing caching has to be done carefully and should be done in a <em>standards compliant manner</em>.
</p>
<h2 id="Generalstrategy">General strategy</h2>
<ul><li>Where possible, cache output within the pylons app (beaker).
</li><li>Facilitate external caching in an end-user's web browser or a caching proxy
</li><li>Slightly stale data is not necessarily much of a problem so allow the output to be cached for a relatively short period (e.g. 5-15 minutes).
</li><li>When cache expiry has been reached, a request will be made to the server. The server should check if its internally cached data is still valid, and serve that, otherwise regenerate the data.
</li></ul><h2 id="Tasks">Tasks</h2>
<p>
These tasks should be broken into sub-tickets:
</p>
<ul><li>caching of parts of templates that are expensive to render (package list, tag list, group list)
</li><li>caching of entire output using beaker particularly for API read operations.
</li><li>need to perform a check to see if the cache should be invalidated by checking if anything in the output would have changed -- i.e. checking timestamps on package modifications. this is a natural place to introduce the ETag which will help browsers and web caches.
</li><li>cache infrastructure front end - varnish, squid, etc. To do this right, the controllers need to set the cache control headers appropriately (max-age, must-revalidate). This is a good resource: <a class="ext-link" href="http://www.mnot.net/cache_docs/#CACHE-CONTROL"><span class="icon">​</span>http://www.mnot.net/cache_docs/#CACHE-CONTROL</a>
<ul><li>Deploy varnish on a host dedicated to this purpose for research. This will be useful for other sites as well
</li><li>Do not configure varnish to ignore cache control headers or otherwise behave in a non HTTP/1.1 compliant manner
</li></ul></li></ul><h2 id="FutureWork">Future Work</h2>
<ul><li>Investigate ckanclient library maintaining a local cache as a web browser would
</li><li>Investigate using a CDN like Google Storage or Amazon for serving cached data.
</li></ul>
                            
                          </td>
                          <td class="PosixTime">1283184362000000
                          </td>
                          <td class="ModifiedTime">1311178929000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/543.html">#543</a>
                          </td>
                          <td class="type">task
                          </td>
                          <td class="owner">wwaites
                          </td>
                          <td class="reporter">rgrp
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">duplicate
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/543.html">Investigate partial page caching and edge-side includes</a>
                          </td>
                          <td class="description">
                            <p>
Edge-side includes or partial page caching are a standard way to deal with caching of pages in which some (usually small) part of the content cannot be cached or should be cached in a different manner (e.g. much more briefly) than the rest of the page.
</p>
<p>
Edge-side includes have the advantage that they integrate with general 3rd-party caching systems such as varnish.
</p>
<p>
Introducing either partial page or ESI will require some overhaul work to change the page render processing somewhat.
</p>

                            
                          </td>
                          <td class="PosixTime">1283244784000000
                          </td>
                          <td class="ModifiedTime">1311178918000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1167.html">#1167</a>
                          </td>
                          <td class="type">task
                          </td>
                          <td class="owner">
                          </td>
                          <td class="reporter">nils.toedtmann
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1167.html">Create a standard CKAN system image for Amazon EC2 (AMI)</a>
                          </td>
                          <td class="description">
                            <p>
We should create a public AMI with CKAN pre-installed and configured such that users can easily create their own EC2 machine with a running CKAN to play with.
</p>
<p>
There are three phases:
</p>
<ol><li>[nils] Deploy an empty EC2 instance to become the CKAN image master instance
</li><li>Install a CKAN and give it a standard configuration.
</li><li>[nils] Create a AMI from the CKAN image master instance and publish it.
</li></ol><p>
I am happy to do first and last. Who is installing and configuring CKAN?
</p>
<p>
Unfortunately AMIs are specific to region, architecture and storage type. We cannot maintain too many images, so a number of choices have to be made:
</p>
<ul><li>Which distribution/version? <strong>Ubuntu 10.04 LTS</strong>
</li><li>Which architecture/instance-type? I suggest 64-bit/t1.micro
</li><li>Which region? I suggest us-east-1 and maybe eu-west-1
</li><li>Which storage type? <strong>EBS</strong> (way easier to make an AMI from than instance-store)
</li><li>Install CKAN from deb packages via mercurial/virtualenv? I assume the latter because the AMI is targeted to developers?
</li></ul><hr />
<p>
<a class="ext-link" href="http://alestic.com/2009/06/ec2-ami-bundle"><span class="icon">​</span>1</a>
<a class="ext-link" href="http://uec-images.ubuntu.com/releases/10.04/release/"><span class="icon">​</span>2</a>
</p>

                            
                          </td>
                          <td class="PosixTime">1306423016000000
                          </td>
                          <td class="ModifiedTime">1311178516000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/225.html">#225</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">rgrp
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">invalid
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/225.html">UI Review - swap URL order</a>
                          </td>
                          <td class="description">
                            <p>
Not so keen on URLS such as /package/edit/mypackagename. These seem to be task-oriented rather than resource oriented (which would be /package/mypackagename/edit), and unstable: there is a common root for /package/edit/mypackage and /package/history/mypackage which is not reflected in the URL structure.
</p>

                            
                          </td>
                          <td class="PosixTime">1260880487000000
                          </td>
                          <td class="ModifiedTime">1311178276000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/987.html">#987</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">pudo
                          </td>
                          <td class="reporter">pudo
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">duplicate
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/987.html">Common harvesting framework</a>
                          </td>
                          <td class="description">
                            <p>
We are now harvesting metadata from other sources in various places around CKAN. Such harvesting can include: 
</p>
<ul><li>CSW/WFS for INSPIRE/UKLII (yields CKAN packages)
</li><li>Catalogue scraping for LOD2 experiments (yields RDF graphs)
</li><li>Atom/DCat for LOD2 production (yields RDF graphs) 
</li><li>OAI-PMH for <a class="ext-link" href="http://datadryad.org/"><span class="icon">​</span>http://datadryad.org/</a> and other dspace (yields CKAN packages)
</li></ul><p>
We should aim to consolidate the harvesting clients into a common system that is easy to extend when needed and can be re-used in different scenarios. 
</p>
<p>
In general, such a system would have the following stages: 
</p>
<ul><li>Source selection: find what to download/scrape/harvest/parse
</li><li>Index retrieval (i.e. package index) 
</li><li>Item retrieval (i.e. package entity)
</li><li>(Optional: Serialization) 
</li><li>Normalisation 
</li><li><a class="missing wiki">Loading/Merging?</a> into CKAN
</li></ul><p>
Exisiting harvesters are at: 
</p>
<ul><li>CSW: <a class="ext-link" href="https://bitbucket.org/okfn/ckanext-csw/src/"><span class="icon">​</span>https://bitbucket.org/okfn/ckanext-csw/src/</a>
</li><li>Scraper+CKAN: <a class="ext-link" href="https://bitbucket.org/pudo/dcat-tools/src/d5d96b06ec9a/dcat/crawl/"><span class="icon">​</span>https://bitbucket.org/pudo/dcat-tools/src/d5d96b06ec9a/dcat/crawl/</a>
</li></ul>
                            
                          </td>
                          <td class="PosixTime">1297684756000000
                          </td>
                          <td class="ModifiedTime">1311177705000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/355.html">#355</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">rgrp
                          </td>
                          <td class="reporter">rgrp
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/355.html">Dashes versus underscores in package names</a>
                          </td>
                          <td class="description">
                            <p>
Sort out how we deal with dashes versus underscores in package names.
</p>

                            
                          </td>
                          <td class="PosixTime">1277221996000000
                          </td>
                          <td class="ModifiedTime">1311177552000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/859.html">#859</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">pudo
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">invalid
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/859.html">Tests for User model</a>
                          </td>
                          <td class="description">
                            <p>
Test coverage of ckan.model.user is 53%. Notable exception - setting password. Room for improvement?
</p>

                            
                          </td>
                          <td class="PosixTime">1291724348000000
                          </td>
                          <td class="ModifiedTime">1311177461000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/856.html">#856</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">wwaites
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">invalid
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/856.html">Tests for caching</a>
                          </td>
                          <td class="description">
                            <p>
Test coverage for ckan.lib.cache is only 40%. Can that be usefully improved?
</p>

                            
                          </td>
                          <td class="PosixTime">1291724064000000
                          </td>
                          <td class="ModifiedTime">1311177085000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/855.html">#855</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">pudo
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">invalid
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/855.html">Authenticator tests</a>
                          </td>
                          <td class="description">
                            <p>
The coverage tool (run by buildbot in the ckan build) reports that only 38% of lines of ckan.lib.authenticator are run in tests. This suggests a need for more tests.
</p>

                            
                          </td>
                          <td class="PosixTime">1291723967000000
                          </td>
                          <td class="ModifiedTime">1311176988000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/812.html">#812</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">
                          </td>
                          <td class="reporter">cygri
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-backlog.html">ckan-backlog</a>
                          </td>
                          <td class="status">new
                          </td>
                          <td class="resolution">
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/812.html">Package edit form only allows three extra fields</a>
                          </td>
                          <td class="description">
                            <h1 id="Rationale">Rationale</h1>
<p>
The package edit form is restricted to three extra fields. To enter more than three fields, one has to save the package and hit edit again (or hit preview).
</p>
<h1 id="Implementation">Implementation</h1>
<p>
A mechanism similar to the one for resources (where you can add lines as you go) would solve this. So, have a button that adds more extra field rows via JS. (Extra fields don't need up/down buttons that the Resource table has)
</p>
<p>
Nice to have: a blank field is added when you tab from the last filled-in field in the table.
</p>

                            
                          </td>
                          <td class="PosixTime">1289995010000000
                          </td>
                          <td class="ModifiedTime">1311176917000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/460.html">#460</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">pudo
                          </td>
                          <td class="reporter">johnbywater
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/460.html">State field changed by non-sysadmin</a>
                          </td>
                          <td class="description">
                            <p>
This package:
</p>
<p>
<a class="ext-link" href="http://ckan.net/package/dbtune-audioscrobbler"><span class="icon">​</span>http://ckan.net/package/dbtune-audioscrobbler</a>
</p>
<p>
was:
</p>
<ol><li>created by Richard (logged-in)
</li><li>edited by Richard (logged-in)
</em></li></ol><p>
(According to the logs, at this point the state was changed from 'active' to 'deleted') -- RP was it set to 'deleted' or just <em>?
</p>
<ol start="3"><li>pudo changed the state back to active
</li></ol><p>
Similarly an incident with bibbase package where field set to <em> (see <a class="ext-link" href="http://ckan.net/revision/diff/bibbase?diff=702bb0a3-03b7-49ac-87ad-e489c414962f&amp;oldid=5447842d-b6ed-41d9-9cfd-8bb73b85c409"><span class="icon">​</span>http://ckan.net/revision/diff/bibbase?diff=702bb0a3-03b7-49ac-87ad-e489c414962f&amp;oldid=5447842d-b6ed-41d9-9cfd-8bb73b85c409</a>)
</em></p>
<p>
Need to investigate how this got changed, fix if necessary and report back to Richard. Note that package 'admins' as well as sysadmins can change the state of a package (though note that bibbase did not appear to have an owner).
</p>
<p>
Suggested solution (for setting to <em>):
</em></p>
<ul><li>Ensure in ckan/forms.py that there is a validator for state field that ensures only set to valid values.
</li><li>Check that we do not allow state to be changed in the api except by package owner or sysadmin
</li></ul>
                            
                          </td>
                          <td class="PosixTime">1282300002000000
                          </td>
                          <td class="ModifiedTime">1311176868000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/668.html">#668</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">thejimmyg
                          </td>
                          <td class="reporter">Colin Calnan
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">invalid
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/668.html">Caching issues on API v1</a>
                          </td>
                          <td class="description">
                            <p>
It seems like the API v1 on CKAN metastable (cset:ec21f8e1c87e) has some caching issues.
</p>
<p>
Steps to test:
</p>
<ol><li>Modify a dataset on datadotgc.ca, redirects to CKAN 
</li></ol><ol start="2"><li>On save, redirects to <a class="ext-link" href="http://www.datadotgc.ca/update/geogratisnat_hydrography_v100"><span class="icon">​</span>http://www.datadotgc.ca/update/geogratisnat_hydrography_v100</a> which in turn redirects to <a class="ext-link" href="http://www.datadotgc.ca/dataset/geogratisnat_hydrography_v100"><span class="icon">​</span>http://www.datadotgc.ca/dataset/geogratisnat_hydrography_v100</a>
</li></ol><ol start="3"><li>You can see that the Dataset has not updated correctly. Run a check on the API v1 - <a class="ext-link" href="http://ca.ckan.net/api/1/rest/package/geogratisnat_hydrography_v100"><span class="icon">​</span>http://ca.ckan.net/api/1/rest/package/geogratisnat_hydrography_v100</a> the updates are not present
</li></ol><ol start="4"><li>Check the v2 of the API - <a class="ext-link" href="http://ca.ckan.net/api/rest/package/geogratisnat_hydrography_v100"><span class="icon">​</span>http://ca.ckan.net/api/rest/package/geogratisnat_hydrography_v100</a>, the updates are present.
</li></ol><ol start="5"><li>Setting the headers to 'Cache-control: no-cache' or 'Pragma: no-cache' does not work either.
</li></ol>
                            
                          </td>
                          <td class="PosixTime">1285953542000000
                          </td>
                          <td class="ModifiedTime">1311176649000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/362.html">#362</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">invalid
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/362.html">Ratings should not be created with a GET</a>
                          </td>
                          <td class="description">
                            <h2 id="Background">Background</h2>
<p>
In the Web UI, when you rate a package it simply links to something like:
</p>
<p>
<a class="ext-link" href="http://ckan.net/package/rate/mke-liquor-licenses?rating=3"><span class="icon">​</span>http://ckan.net/package/rate/mke-liquor-licenses?rating=3</a>
</p>
<p>
This creates a GET request. 
</p>
<p>
This is bad because:
</p>
<ul><li>Search engine crawlers follow links to find pages, and in this case end up creating a rating (although we've got a robots.txt to try and avoid this)
</li><li>There are occasions when we want to make a CKAN instance read-only, so we put a &lt;<a class="missing wiki">LimitExcept?</a> GET&gt; Apache instruction in. But the database may still get written for these ratings.
</li><li>Best practise for web requests is for GET to be a read-only request.
</li></ul>
                            
                          </td>
                          <td class="PosixTime">1278925451000000
                          </td>
                          <td class="ModifiedTime">1311176564000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/312.html">#312</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">rgrp
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">invalid
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/312.html">Race condition creating PackageRating</a>
                          </td>
                          <td class="description">
                            <p>
On ckan.net there are a few packages which cause a 403 exception when you try to rate them:
<a class="ext-link" href="http://www.ckan.net/package/rate/coins-data?rating=3"><span class="icon">​</span>http://www.ckan.net/package/rate/coins-data?rating=3</a>
</p>
<p>
The exception is occuring here:
ckan.rating:39 in set_rating
rating_obj = rating_query.one()
<a class="missing wiki">InvalidRequestError?</a>: Multiple rows returned for one()
</p>
<p>
It looks like this package got rated twice in quick succession, creating two similar <a class="missing wiki">PackageRating?</a> objects. This race condition needs to be solved and these particular rating objects repaired.
</p>

                            
                          </td>
                          <td class="PosixTime">1273482785000000
                          </td>
                          <td class="ModifiedTime">1311176173000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/200.html">#200</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">rgrp
                          </td>
                          <td class="reporter">rgrp
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">invalid
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/200.html">PythonDistribution write method should write all available metadata</a>
                          </td>
                          <td class="description">
                            <p>
Current write method just creates a bare bones package and does not write any of the available metadata other than name.
</p>

                            
                          </td>
                          <td class="PosixTime">1259229583000000
                          </td>
                          <td class="ModifiedTime">1311176118000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/96.html">#96</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">rgrp
                          </td>
                          <td class="reporter">rgrp
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">invalid
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/96.html">info command must give up to date information for python-type distributions</a>
                          </td>
                          <td class="description">
                            <p>
(2008-09-10) at present when setup.py is edited info command may not give up to date information if pkg-info (in egg.info) is not rebuilt.
</p>
<p>
Suggest: info command needs to rebuilds pkg-info in python-type distributions.
</p>

                            
                          </td>
                          <td class="PosixTime">1249982410000000
                          </td>
                          <td class="ModifiedTime">1311176063000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1118.html">#1118</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">
                          </td>
                          <td class="reporter">johnlawrenceaspden
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">invalid
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1118.html">tests are testing something other than the behaviour seen in the browser</a>
                          </td>
                          <td class="description">
                            <p>
I'm finding that if I try to take an action with insufficient credentials from a test then I often (but not always) get a 401 error, whereas in the browser I get redirected to the login page.
</p>
<p>
It's a bit worrying that the program in its test environment doesn't behave like it does in the browser.
</p>

                            
                          </td>
                          <td class="PosixTime">1304093017000000
                          </td>
                          <td class="ModifiedTime">1311174062000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1094.html">#1094</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">thejimmyg
                          </td>
                          <td class="reporter">thejimmyg
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.5.html">ckan-v1.5</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">duplicate
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1094.html">[super] Refactor the Auth System</a>
                          </td>
                          <td class="description">
                            <p>
Here are some proposed changes related to CKAN's authorization system - they aren't very big, but should provide for some forthcoming use cases including <a class="closed ticket" href="../ticket/787.html" title="task: Auth API (closed: fixed)">#787</a>.
</p>
<p>
Two man reasons for the changes are:
</p>
<ul><li>We have a completely refactored architecture now which introduces a logic layer. These Auth changes are designed to better support the way we work with that layer.
</li></ul><ul><li>Different CKAN extension apps may need radically different authentication/authorisation so we need to allow whatever we have to be override-able.
</li></ul><p>
The first two changes revolve around the is_authorized method, which
is called by the logic layer to ask whether a particular user (e.g.
Bob) is allowed to do a certain action (e.g. edit) on a certain object (e.g. Package).
</p>
<ol><li>The first thing the is_authorized method is a hook to a plugin
</li></ol><p>
which *overrides* the current call with its own implementation (note: in previous discussions we have considered allowing a chain of plugins, no longer!)
</p>
<p>
Reason: authorization can be completely delegated to another system
(or partially)
</p>
<ol start="2"><li>is_authorized method currently takes (username, action, object)
</li></ol><p>
but for action=create_package, the object supplied is System, and for action=edit the object supplied is the package. Instead action should always be the string name of a function in the logic layer and object should always be the object passed to that function. This means our auth system is based around the actual actions we are performing (rather than a model them) and with the actual data that forms the action (rather than a related object). You never need a System object in this model.
</p>
<ol start="3"><li>Rename these two classes to better reflect what they are
<ul><li><a class="missing wiki">AuthorizationGroup?</a> -&gt; <a class="missing wiki">UserGroup?</a>
</li><li>Group -&gt; <a class="missing wiki">PackageGroup?</a>
</li></ul></li></ol><ol start="4"><li>Rename the Editor role to <a class="missing wiki">PriveledgeUser?</a> since Editors sometimes can't edit.
</li></ol><p>
Although this sounds a bit radical we already have auth extensions.
</p>
<h2 id="Read-onlyCKANWebUI">Read-only CKAN Web UI</h2>
<p>
(Additional requirement from <a class="closed ticket" href="../ticket/764.html" title="enhancement: Read-only CKAN Web UI (closed: duplicate)">#764</a>)
</p>
<p>
Whilse using CKAN web interface, you are not tempted to edit stuff:
</p>
<ul><li>You know at all times this CKAN is read-only
</li><li>All editing facilities are still seen but greyed-out with an indication why it is.
</li></ul>
                            
                          </td>
                          <td class="PosixTime">1303117973000000
                          </td>
                          <td class="ModifiedTime">1311173649000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/651.html">#651</a>
                          </td>
                          <td class="type">requirement
                          </td>
                          <td class="owner">
                          </td>
                          <td class="reporter">pudo
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/651.html">Improve javascript helper for package/user addition on groups/authzgroups</a>
                          </td>
                          <td class="description">
                            <p>
This needs to be abstracted and we still need to be able to remove items before saving. 
</p>

                            
                          </td>
                          <td class="PosixTime">1284972211000000
                          </td>
                          <td class="ModifiedTime">1311171104000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/861.html">#861</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">wwaites
                          </td>
                          <td class="reporter">wwaites
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">invalid
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/861.html">unicode errors creating rdf output</a>
                          </td>
                          <td class="description">
                            <p>
<a class="ext-link" href="http://bitbucket.org/ww/ckanrdf/changeset/63b60d3a253d"><span class="icon">​</span>http://bitbucket.org/ww/ckanrdf/changeset/63b60d3a253d</a>
</p>

                            
                          </td>
                          <td class="PosixTime">1291726125000000
                          </td>
                          <td class="ModifiedTime">1311168845000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1230.html">#1230</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">
                          </td>
                          <td class="reporter">kindly
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-10-28.html">ckan-sprint-2011-10-28</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1230.html">Make sure plugins tables work in tests.</a>
                          </td>
                          <td class="description">
                            <p>
Dgu tests failed as harvesting table are not created at the correct point.
</p>

                            
                          </td>
                          <td class="PosixTime">1311100811000000
                          </td>
                          <td class="ModifiedTime">1311154142000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1219.html">#1219</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">
                          </td>
                          <td class="reporter">timmcnamara
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1219.html">CSS issues on IE7</a>
                          </td>
                          <td class="description">
                            <p>
As reported on <a class="ext-link" href="http://lists.okfn.org/pipermail/ckan-dev/2011-July/001043.html"><span class="icon">​</span>ckan-dev</a>:
</p>
<blockquote class="citation">
<p>
items in the footer of CKAN ("Packages", "Groups &amp; Tags", "About", "Language", etc.) are shown vertically instead of horizontally in IE7. This works fine in later browsers like IE8, IE9, FF4, and latest Opera and Chrome.
</p>
</blockquote>
<blockquote class="citation">
<p>
This seems to exist in all recent CKAN versions up to 1.4.1a.
</p>
</blockquote>

                            
                          </td>
                          <td class="PosixTime">1310423688000000
                          </td>
                          <td class="ModifiedTime">1310740534000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1225.html">#1225</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-10-28.html">ckan-sprint-2011-10-28</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1225.html">Tool for mass tag changes</a>
                          </td>
                          <td class="description">
                            <p>
Using ckanapi
</p>

                            
                          </td>
                          <td class="PosixTime">1310642161000000
                          </td>
                          <td class="ModifiedTime">1310642407000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1223.html">#1223</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">pudo
                          </td>
                          <td class="reporter">pudo
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1223.html">Caching of static files</a>
                          </td>
                          <td class="description">
                            <p>
StaticURLParser can have caching - use it
</p>

                            
                          </td>
                          <td class="PosixTime">1310573854000000
                          </td>
                          <td class="ModifiedTime">1310573893000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1209.html">#1209</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">
                          </td>
                          <td class="reporter">kindly
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1209.html">sort out rendering of formalchemy package preview</a>
                          </td>
                          <td class="description">
                            <p>
Got broken due to the moderated edits changes <a class="closed ticket" href="../ticket/1141.html" title="CREP: [super] Moderated Edits User Interface (closed: fixed)">#1141</a>.
</p>
<p>
Need to make sure preview works.
</p>

                            
                          </td>
                          <td class="PosixTime">1309817240000000
                          </td>
                          <td class="ModifiedTime">1310571715000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1205.html">#1205</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">kindly
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1205.html">db upgrade problem on cz.ckan.net</a>
                          </td>
                          <td class="description">
                            <p>
When upgrading database for cz.ckan.net (psql.okfn.org/cz.okfn.org) an error occurred (see below).
</p>
<p>
cz.ckan.net has been running on eu3 and this updrade was part of moving it to eu19, with a more recent version of ckan.
</p>
<p>
In the meantime I've reverted the db to the old version (pre-upgrade). 
</p>
<p>
cz.ckan.net is not working properly until this is fixed.
</p>
<pre class="wiki">okfn@eu19:~$ paster --plugin ckan db upgrade --config=/etc/ckan/cz/cz.ini
/usr/lib/pymodules/python2.6/ckan_deps/sqlalchemy/engine/url.py:105: SADeprecationWarning: The SQLAlchemy PostgreSQL dialect has been renamed from 'postgres' to 'postgresql'. The new URL format is postgresql[+driver]://&lt;user&gt;:&lt;pass&gt;@&lt;host&gt;/&lt;dbname&gt;
  module = __import__('sqlalchemy.dialects.%s' % (dialect, )).dialects
2011-06-29 09:07:41,294 INFO  [migrate.versioning.api] 28 -&gt; 29... 
/usr/lib/pymodules/python2.6/ckan_deps/sqlalchemy/engine/reflection.py:46: SAWarning: Skipped unsupported reflection of expression-based index idx_pkg_lname
  ret = fn(self, con, *args, **kw)
/usr/lib/pymodules/python2.6/ckan_deps/sqlalchemy/engine/reflection.py:46: SAWarning: Skipped unsupported reflection of expression-based index idx_pkg_slname
  ret = fn(self, con, *args, **kw)
/usr/lib/pymodules/python2.6/ckan_deps/sqlalchemy/engine/reflection.py:46: SAWarning: Skipped unsupported reflection of expression-based index idx_pkg_suname
  ret = fn(self, con, *args, **kw)
/usr/lib/pymodules/python2.6/ckan_deps/sqlalchemy/engine/reflection.py:46: SAWarning: Skipped unsupported reflection of expression-based index idx_pkg_uname
  ret = fn(self, con, *args, **kw)
Traceback (most recent call last):
  File "/usr/bin/paster", line 18, in &lt;module&gt;
    command.run()
  File "/usr/lib/pymodules/python2.6/paste/script/command.py", line 84, in run
    invoke(command, command_name, options, args[1:])
  File "/usr/lib/pymodules/python2.6/paste/script/command.py", line 123, in invoke
    exit_code = runner.run(args)
  File "/usr/lib/pymodules/python2.6/paste/script/command.py", line 218, in run
    result = self.command()
  File "/usr/lib/pymodules/python2.6/ckan/lib/cli.py", line 84, in command
    model.repo.upgrade_db()
  File "/usr/lib/pymodules/python2.6/ckan/model/__init__.py", line 163, in upgrade_db
    mig.upgrade(self.metadata.bind, self.migrate_repository, version=version)
  File "/usr/lib/pymodules/python2.6/ckan_deps/migrate/versioning/api.py", line 185, in upgrade
    return _migrate(url, repository, version, upgrade=True, err=err, **opts)
  File "&lt;string&gt;", line 2, in _migrate
  File "/usr/lib/pymodules/python2.6/ckan_deps/migrate/versioning/util/__init__.py", line 160, in with_engine
    return f(*a, **kw)
  File "/usr/lib/pymodules/python2.6/ckan_deps/migrate/versioning/api.py", line 364, in _migrate
    schema.runchange(ver, change, changeset.step)
  File "/usr/lib/pymodules/python2.6/ckan_deps/migrate/versioning/schema.py", line 83, in runchange
    change.run(self.engine, step)
  File "/usr/lib/pymodules/python2.6/ckan_deps/migrate/versioning/script/py.py", line 140, in run
    script_func(engine)
  File "/usr/lib/pymodules/python2.6/ckan/migration/versions/029_version_groups.py", line 152, in upgrade
    migrate_engine.execute(q)
  File "/usr/lib/pymodules/python2.6/ckan_deps/sqlalchemy/engine/base.py", line 1788, in execute
    return connection.execute(statement, *multiparams, **params)
  File "/usr/lib/pymodules/python2.6/ckan_deps/sqlalchemy/engine/base.py", line 1191, in execute
    params)
  File "/usr/lib/pymodules/python2.6/ckan_deps/sqlalchemy/engine/base.py", line 1271, in _execute_clauseelement
    return self.__execute_context(context)
  File "/usr/lib/pymodules/python2.6/ckan_deps/sqlalchemy/engine/base.py", line 1302, in __execute_context
    context.parameters[0], context=context)
  File "/usr/lib/pymodules/python2.6/ckan_deps/sqlalchemy/engine/base.py", line 1401, in _cursor_execute
    context)
  File "/usr/lib/pymodules/python2.6/ckan_deps/sqlalchemy/engine/base.py", line 1394, in _cursor_execute
    context)
  File "/usr/lib/pymodules/python2.6/ckan_deps/sqlalchemy/engine/default.py", line 299, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (IntegrityError) insert or update on table "package_group_revision" violates foreign key constraint "package_group_revision_continuity_id_fkey"
DETAIL:  Key (continuity_id)=(7f373978-40a0-4848-bdc9-018ad213aa0b) is not present in table "package_group".
 'INSERT INTO package_group_revision (id, package_id, group_id, state, revision_id, continuity_id) VALUES (%(id)s, %(package_id)s, %(group_id)s, %(state)s, %(revision_id)s, %(continuity_id)s)' {'state': u'active', 'package_id': u'14d76e9e-028c-49c1-955b-ef30d4abb970', 'continuity_id': u'7f373978-40a0-4848-bdc9-018ad213aa0b', 'revision_id': u'24a11f58-2ff9-46f3-b113-0bf7f0baf254', 'group_id': u'4b832199-b8e3-4989-9b5d-de8dd6322612', 'id': u'7a3863bd-3054-40c8-bb3d-68b73096c108'}
</pre>
                            
                          </td>
                          <td class="PosixTime">1309339700000000
                          </td>
                          <td class="ModifiedTime">1310568631000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1128.html">#1128</a>
                          </td>
                          <td class="type">task
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-10-28.html">ckan-sprint-2011-10-28</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1128.html">Upload Scotland gov data</a>
                          </td>
                          <td class="description">
                            <p>
Upload to ckan.net:
<a class="ext-link" href="https://sites.google.com/site/scotlandsdata/"><span class="icon">​</span>https://sites.google.com/site/scotlandsdata/</a>
</p>

                            
                          </td>
                          <td class="PosixTime">1304712293000000
                          </td>
                          <td class="ModifiedTime">1310568028000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1222.html">#1222</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-10-28.html">ckan-sprint-2011-10-28</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1222.html">Mailer has no tests</a>
                          </td>
                          <td class="description">
                            
                            
                          </td>
                          <td class="PosixTime">1310479136000000
                          </td>
                          <td class="ModifiedTime">1310556618000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1221.html">#1221</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-10-28.html">ckan-sprint-2011-10-28</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1221.html">Password reset tidy up</a>
                          </td>
                          <td class="description">
                            <ul><li>No tests.
</li><li>500 error given when user is not found.
</li></ul>
                            
                          </td>
                          <td class="PosixTime">1310475661000000
                          </td>
                          <td class="ModifiedTime">1310556607000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1186.html">#1186</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1186.html">Password reset facility</a>
                          </td>
                          <td class="description">
                            <p>
You can register a user with password and (optional) email address. But if you forget the password you can't then log in again. We need a password reset facility that sends and email with a new password.
</p>

                            
                          </td>
                          <td class="PosixTime">1308142766000000
                          </td>
                          <td class="ModifiedTime">1310556519000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1199.html">#1199</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">pudo
                          </td>
                          <td class="reporter">pudo
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1199.html">Implement an email function for users.</a>
                          </td>
                          <td class="description">
                            <p>
We need an email function in CKAN to accept messages sent to users. The basic signature will be: 
</p>
<ul><li>mail_user(user_obj, subject, body, mime_type='text/plain', headers={})
</li></ul><p>
This has a number of use cases: 
</p>
<ul><li>Retrieval of lost passwords
</li><li>E-Mail confirmation 
</li></ul><p>
Finally, the mail function should be exposed in the API for sysadmin clients. This way we can have scripts traverse CKAN for 404s, invalid data or missing fields and ping users about that automatically (requires traversal by revision, not package, to get the associated users). 
</p>
<h2 id="Implementation">Implementation</h2>
<p>
Note we have already written code like this (*and* tested it) in isitopen:
</p>
<ul><li><a class="ext-link" href="https://bitbucket.org/okfn/isitopen/src/bb2cbd146fa5/isitopen/lib/mailer.py"><span class="icon">​</span>https://bitbucket.org/okfn/isitopen/src/bb2cbd146fa5/isitopen/lib/mailer.py</a>
</li><li><a class="ext-link" href="https://bitbucket.org/okfn/isitopen/src/bb2cbd146fa5/isitopen/tests/lib/test_mailer.py"><span class="icon">​</span>https://bitbucket.org/okfn/isitopen/src/bb2cbd146fa5/isitopen/tests/lib/test_mailer.py</a>
</li></ul>
                            
                          </td>
                          <td class="PosixTime">1308821986000000
                          </td>
                          <td class="ModifiedTime">1310555589000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1218.html">#1218</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">minspamboks@…
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-sprint-2011-10-28.html">ckan-sprint-2011-10-28</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1218.html">Colour the History tab icon</a>
                          </td>
                          <td class="description">
                            <p>
Change the color of the "History" tab icon to yellowish, like the rest of the icons in the other tabs ("View" and "Edit", "Authorization").
</p>
<h2 id="Reasoning">Reasoning</h2>
<p>
When you view a data package, for instance
<a class="ext-link" href="http://ckan.net/package/thesaurus-w"><span class="icon">​</span>http://ckan.net/package/thesaurus-w</a>, you will see "View", "Edit",
"History" tabs on the top. "History" tab has a black-and-white icon
which makes it look like an inactive/disabled tab (since the text is
also grayed out when the tab is not selected). This is not a major
issue, but it is a little bit confusing for the users. This icon
exists in v1.3.2 and also in v1.4.1a (that runs on ckan.net).
</p>
<p>
The simple solution would be to change the color of the "History" tab icon and give it the same yellowish color like the rest of the icons in the other tabs (e.g. "View" and "Edit").
</p>

                            
                          </td>
                          <td class="PosixTime">1310375768000000
                          </td>
                          <td class="ModifiedTime">1310389390000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1215.html">#1215</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1215.html">Edit Resources table - removing all rows prevents adding them again</a>
                          </td>
                          <td class="description">
                            <p>
I'm not sure if this was reported earlier, but I have found a minor bug in the "Add new package" form. As far as I can see this bug exists in v1.3.2 and also in v1.4.1a (that runs on ckan.net). This is a problem with adding new resources in "Resources" section. To reproduce the bug do the following:
</p>
<ol><li>Go to "Add new package", for instance <a class="ext-link" href="http://ckan.net/package/new"><span class="icon">​</span>http://ckan.net/package/new</a>
</li><li>Scroll down to "Resources" section.
</li><li>Click on "Remove this row" link (red circle).
</li><li>Say "Yes" to "Are you sure you wish to remove this row?"
</li><li>Now there should be no rows. Only the header "URL*   Format  Description"
</li><li>Click on "Add row to table"
</li><li>All you get now is another row with table header "URL*        Format Description". You will not be able to add any resources now. Solution is to reload the page.
</li></ol><p>
The simplest solution to this bug will be to hide the "Remove this
row" link if there is only one row.
</p>

                            
                          </td>
                          <td class="PosixTime">1310133224000000
                          </td>
                          <td class="ModifiedTime">1310385485000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1095.html">#1095</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">kindly
                          </td>
                          <td class="reporter">kindly
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1095.html">add way to pass in schema to logic layer.</a>
                          </td>
                          <td class="description">
                            <p>
We need a way to pass in schemas to the logic layer to deal with edge cases. 
</p>

                            
                          </td>
                          <td class="PosixTime">1303221854000000
                          </td>
                          <td class="ModifiedTime">1310134959000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1125.html">#1125</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">nils.toedtmann
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1125.html">Debian package "ckan" should not depend on "postgresql"</a>
                          </td>
                          <td class="description">
                            <p>
The debian package "ckan" with the two scripts "ckan-create-instance" and "ckan-instance-maintenance" depends against "postgresql". But "ckan-create-instance" is quite handy even when the DB is remote: it creates all the data dirs with the correct permissions, and the ckan and apache configs.
</p>
<p>
Please add a flag "--without-local-db" to "ckan-create-instance" and remove the postgres dependancy from the debain package.
</p>

                            
                          </td>
                          <td class="PosixTime">1304538095000000
                          </td>
                          <td class="ModifiedTime">1310134813000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/941.html">#941</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">thejimmyg
                          </td>
                          <td class="reporter">rgrp
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.5.html">ckan-v1.5</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">wontfix
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/941.html">Submit apps or ideas for apps related to datasets (extension)</a>
                          </td>
                          <td class="description">
                            <p>
The basic purpose of this extension is provide a way to record  'apps' (applications) that relate to datasets in CKAN. Both existing apps and ideas for apps should be permitted.
</p>

                            
                          </td>
                          <td class="PosixTime">1296403099000000
                          </td>
                          <td class="ModifiedTime">1310134339000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/972.html">#972</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">sebbacon
                          </td>
                          <td class="reporter">rgrp
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.5.html">ckan-v1.5</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">wontfix
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/972.html">Merge 'extras' into main package dict rather than having separate key</a>
                          </td>
                          <td class="description">
                            <p>
Rather than have a separate 'extras' key all the extras fields should be consolidated into the main package dict when presenting the package internally or e.g. via the API.
</p>
<p>
Why? Extras are really just an artefact of our internal storage model. Clients of the system (both internal and external) should just see a set of key/values with no distinction between extras and non-extras.
</p>
<h2 id="Issues">Issues</h2>
<ul><li>Possible breaking change to the API (could enforce backwards compatibility by keepings extras for the time being)
</li></ul><p>
Possible subticket of forms refactoring: <a class="closed ticket" href="../ticket/961.html" title="enhancement: [super] Refactoring of forms, validation and model synchronization (closed: fixed)">#961</a>
</p>

                            
                          </td>
                          <td class="PosixTime">1297332282000000
                          </td>
                          <td class="ModifiedTime">1310134129000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1163.html">#1163</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">rgrp
                          </td>
                          <td class="reporter">rgrp
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-backlog.html">ckan-backlog</a>
                          </td>
                          <td class="status">new
                          </td>
                          <td class="resolution">
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1163.html">Improvements to Storage Extension</a>
                          </td>
                          <td class="description">
                            <p>
Storage is now working but there are 
</p>
<ul><li>Integrate with Resources (e.g. create a resource for each file upload and give option to associate with a package)
<ul><li>Should we introduce rule that files *not* associated with a Resource are periodically deleted?
</li></ul></li><li>Allow setting of a file name/path before upload
</li><li>Allow for file overwriting/deleting etc (how should this work -- do we want to allow this sort of thing)
</li><li>Integrate local file upload stuff in api/auth/*
</li></ul><h2 id="DifferentBackendIssues">Different Backend Issues</h2>
<p>
Local file store is rather different from 'remote' storage in various ways:
</p>
<ul><li>For remote you don't want to use many buckets as there are bucket limits while for local you want to. Should we there have a single path that users provide which we then partition differently for different backends.
</li></ul>
                            
                          </td>
                          <td class="PosixTime">1306408778000000
                          </td>
                          <td class="ModifiedTime">1310133808000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/764.html">#764</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">thejimmyg
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.5.html">ckan-v1.5</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">duplicate
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/764.html">Read-only CKAN Web UI</a>
                          </td>
                          <td class="description">
                            <p>
Whilse using CKAN web interface, you are not tempted to edit stuff:
</p>
<ul><li>You know at all times this CKAN is read-only
</li><li>All editing facilities are still seen but greyed-out with an indication why it is.
</li></ul>
                            
                          </td>
                          <td class="PosixTime">1288091619000000
                          </td>
                          <td class="ModifiedTime">1310133334000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/358.html">#358</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">rgrp
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.5.html">ckan-v1.5</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">duplicate
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/358.html">Resources in REST API</a>
                          </td>
                          <td class="description">
                            <p>
(spun out of <a class="closed ticket" href="../ticket/336.html" title="defect: Resource Search API (closed: fixed)">ticket:336</a>)
</p>
<p>
Resource added to model API at:
</p>
<p>
api/rest/resource
</p>
<h3 id="Examplemodelrequest">Example model request</h3>
<p>
GET to: /api/2/rest/resource/a3dd8f64-9078-4f04-845c-e3f047125028
</p>
<p>
returns:
</p>
<pre class="wiki"> [{"id": "a3dd8f64-9078-4f04-845c-e3f047125028",
   "package_id": "b8a325c8-af2a-43f3-8245-9db7d73dfbfe",
   "URL": "http://scraperwiki.com/lincolnshire-councillors", 
   "format": "CSV", 
   "Description": "Scrape of www.lincs.gov/councillors.pdf by ScraperWiki.",
   "hash": "", 
   "position": 2
 }]
</pre><h2 id="Authorization">Authorization</h2>
<ol><li>Have it generic (ie. not per resource) and use an action/role on system
</li><li>Require all resources to attach to packages an inherit their permissions (i.e. read/write etc if and only read/write on associated packages)
</li><li>Introduce Resource in authorization system (requires migration)
</li></ol><p>
Mixed model
</p>
<pre class="wiki">Create / Edit:

if resource associated to package:
    check_permissions(package, update)
else:
    check_system_permissions(c.user, model.Action.Resouce Create/Update, model.System)
</pre>
                            
                          </td>
                          <td class="PosixTime">1277483282000000
                          </td>
                          <td class="ModifiedTime">1310128782000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1009.html">#1009</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">pudo
                          </td>
                          <td class="reporter">rgrp
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-backlog.html">ckan-backlog</a>
                          </td>
                          <td class="status">new
                          </td>
                          <td class="resolution">
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1009.html">Improvements to user accounts sytem</a>
                          </td>
                          <td class="description">
                            <ul><li>Forgot password (email a new password)
</li><li>Confirm email
</li><li>Do not show register page if you are logged in (redirect to home page)
</li><li><a class="closed ticket" href="../ticket/1010.html" title="enhancement: List CKAN users in WUI (closed: fixed)">ticket:1010</a> - listing of users.
<ul><li>Do not use /user for general user account home page (either user normal user page /user/{id} or /user/myaccount)
</li></ul></li></ul>
                            
                          </td>
                          <td class="PosixTime">1298635991000000
                          </td>
                          <td class="ModifiedTime">1310128574000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/910.html">#910</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">pudo
                          </td>
                          <td class="reporter">pudo
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.5.html">ckan-v1.5</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">invalid
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/910.html">Refactor CKANrdf to support extras</a>
                          </td>
                          <td class="description">
                            <p>
Extra fields should be represented in some manner. 
</p>

                            
                          </td>
                          <td class="PosixTime">1295266026000000
                          </td>
                          <td class="ModifiedTime">1310128544000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/810.html">#810</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">pudo
                          </td>
                          <td class="reporter">pudo
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.5.html">ckan-v1.5</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">wontfix
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/810.html">Move "add packages" field up in group form</a>
                          </td>
                          <td class="description">
                            <p>
Subticket of forms super ticket <a class="closed ticket" href="../ticket/961.html" title="enhancement: [super] Refactoring of forms, validation and model synchronization (closed: fixed)">#961</a>
</p>

                            
                          </td>
                          <td class="PosixTime">1289992287000000
                          </td>
                          <td class="ModifiedTime">1310128477000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/559.html">#559</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">pudo
                          </td>
                          <td class="reporter">pudo
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.5.html">ckan-v1.5</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">invalid
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/559.html">Fix package lookup on group edit form</a>
                          </td>
                          <td class="description">
                            <p>
Lookup is needed to add a package but won't show up at some times. 
</p>
<p>
Originally reported by Anja Jentzsch, re questions. 
</p>

                            
                          </td>
                          <td class="PosixTime">1283542776000000
                          </td>
                          <td class="ModifiedTime">1310127694000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1053.html">#1053</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.5.html">ckan-v1.5</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1053.html">Deletion in Model API</a>
                          </td>
                          <td class="description">
                            <p>
Currently in the API if you DELETE a package/group/user (and you have the required permissions) then it purges the object, when it should probably just set the state to deleted.
</p>
<p>
There is no way to delete objects at the moment - changes to 'state' are ignored in the API.
</p>
<p>
Do we need an alternative way to purge objects in the API?
</p>

                            
                          </td>
                          <td class="PosixTime">1300790039000000
                          </td>
                          <td class="ModifiedTime">1310126546000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/961.html">#961</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">kindly
                          </td>
                          <td class="reporter">rgrp
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.5.html">ckan-v1.5</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/961.html">[super] Refactoring of forms, validation and model synchronization</a>
                          </td>
                          <td class="description">
                            <p>
This is a meta-ticket to hold all of the work on refactoring forms, validation and model-synchronization in CKAN.
</p>
<p>
ckan-dev thread: <a class="ext-link" href="http://lists.okfn.org/pipermail/ckan-dev/2011-January/000180.html"><span class="icon">​</span>http://lists.okfn.org/pipermail/ckan-dev/2011-January/000180.html</a>
</p>
<h2 id="TheIssue">The Issue</h2>
<p>
From <a class="closed ticket" href="../ticket/926.html" title="enhancement: Pick a simpler form framework (closed: fixed)">#926</a>:
</p>
<p>
The current formalchemy setup conflates view, controller and model code in a way that makes it hard to debug and customise.
</p>
<p>
From <a class="ext-link" href="http://lists.okfn.org/pipermail/ckan-dev/2011-January/000181.html"><span class="icon">​</span>http://lists.okfn.org/pipermail/ckan-dev/2011-January/000181.html</a>:
</p>
<p>
... FormAlchemy, in retrospect, was probably a mistake as it merges too much model/validation/form generation into one thing.
</p>
<p>
At least 3 functions involved [in this area]:
</p>
<ol><li>Generating (or just filling) a form template with 'form data' (and errors)
</li><li>Converting model data to form data (also happens for APIs in fact) -- let's call this 'dict-ization'
</li><li>Converting form data to model data (and validating) (inverse of previous step)
</li></ol><h2 id="RelatedTickets">Related Tickets</h2>
<ul><li><a class="closed ticket" href="../ticket/926.html" title="enhancement: Pick a simpler form framework (closed: fixed)">#926</a> - Pick a simpler form framework
</li><li><a class="closed ticket" href="../ticket/1046.html" title="enhancement: Dictization and the new logic layer (closed: fixed)">#1046</a> 'dictization' and the logic layer - serialization / deserialization of package (and other domain objects) to standard intermediate format such as json-convertable python dict
<ul><li><a class="closed ticket" href="../ticket/1079.html" title="enhancement: Refactor API to use new logic layer and dictization (closed: fixed)">#1079</a> Refactor API to use new logic layer and dictization
</li><li><a class="closed ticket" href="../ticket/1078.html" title="enhancement: Refactors WUI controllers and forms to use logic layer (closed: fixed)">#1078</a> Refactor WUI controllers and forms to use logic layer
</li><li>cf existing dumper and importer code
</li><li>This will fix <a class="closed ticket" href="../ticket/662.html" title="defect: Can't put entity that is returned by posting to package register (closed: fixed)">#662</a>
</li></ul></li><li>[not ticketed yet] - validation layer (should work on serialized objects?)
</li><li><a class="closed ticket" href="../ticket/662.html" title="defect: Can't put entity that is returned by posting to package register (closed: fixed)">#662</a> - Can't put entity that is returned by posting to package register (Defect)
</li><li><a class="closed ticket" href="../ticket/972.html" title="enhancement: Merge 'extras' into main package dict rather than having separate key (closed: wontfix)">#972</a> - Merge 'extras' into main package dict rather than having separate key
</li><li><a class="closed ticket" href="../ticket/1035.html" title="enhancement: Form impressions given an ID (closed: wontfix)">#1035</a> - Form impressions are given IDs
</li><li><a class="closed ticket" href="../ticket/810.html" title="enhancement: Move &#34;add packages&#34; field up in group form (closed: wontfix)">#810</a> - Move "add packages" field up in group form (easier to do this once forms are done)
</li></ul>
                            
                          </td>
                          <td class="PosixTime">1297069849000000
                          </td>
                          <td class="ModifiedTime">1310126100000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/363.html">#363</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">kindly
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-backlog.html">ckan-backlog</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">wontfix
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/363.html">Blank revisions</a>
                          </td>
                          <td class="description">
                            <p>
Occasionally we seem to get revisions that are not connected to packages. These shouldn't appear, since all revisioned objects are linked to a package aren't they?
</p>
<p>
They appear on the 'Recently changed' list on the home page with an empty 'Packages' column.
</p>

                            
                          </td>
                          <td class="PosixTime">1278947772000000
                          </td>
                          <td class="ModifiedTime">1310125872000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/952.html">#952</a>
                          </td>
                          <td class="type">task
                          </td>
                          <td class="owner">wwaites
                          </td>
                          <td class="reporter">pudo
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-backlog.html">ckan-backlog</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">invalid
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/952.html">CKAN should run under nginx/uswgi</a>
                          </td>
                          <td class="description">
                            <p>
second part of <a class="closed ticket" href="../ticket/908.html" title="defect: Issues deploying extensions with modwsgi / uwsgi (closed: fixed)">#908</a>
</p>

                            
                          </td>
                          <td class="PosixTime">1296730498000000
                          </td>
                          <td class="ModifiedTime">1310125204000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/728.html">#728</a>
                          </td>
                          <td class="type">requirement
                          </td>
                          <td class="owner">amercader
                          </td>
                          <td class="reporter">johnbywater
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-backlog.html">ckan-backlog</a>
                          </td>
                          <td class="status">assigned
                          </td>
                          <td class="resolution">
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/728.html">CSW Harvesting shall be optimised in respect of reharvesting only records that have changed</a>
                          </td>
                          <td class="description">
                            <p>
Hi Will, this is important again because some CSW servers we use have over 300 documents in. Could you take a look at modifying the filter please?
</p>

                            
                          </td>
                          <td class="PosixTime">1287675340000000
                          </td>
                          <td class="ModifiedTime">1310124784000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1201.html">#1201</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">
                          </td>
                          <td class="reporter">kindly
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-backlog.html">ckan-backlog</a>
                          </td>
                          <td class="status">new
                          </td>
                          <td class="resolution">
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1201.html">seperate out logic in atom feeds to logic layer.</a>
                          </td>
                          <td class="description">
                            <p>
Simplify the logic in the atom feed an make all feeds use logic layer to return lists.
</p>

                            
                          </td>
                          <td class="PosixTime">1308928892000000
                          </td>
                          <td class="ModifiedTime">1310124297000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1070.html">#1070</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">rgrp
                          </td>
                          <td class="reporter">rgrp
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.5.html">ckan-v1.5</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1070.html">Plan a new domain model and layer architecture for CKAN</a>
                          </td>
                          <td class="description">
                            <p>
See <a class="ext-link" href="http://wiki.ckan.net/Domain_Model"><span class="icon">​</span>http://wiki.ckan.net/Domain_Model</a> especially section on v2.
</p>
<ul><li>New domain model is planned but not yet finally agreed.
</li><li>Layer architecture is complete and implemented
</li></ul>
                            
                          </td>
                          <td class="PosixTime">1301910940000000
                          </td>
                          <td class="ModifiedTime">1310117129000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1210.html">#1210</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.5-sprint-4.html">ckan-v1.5-sprint-4</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1210.html">POST application/json error handling with newer WebOb</a>
                          </td>
                          <td class="description">
                            <p>
<a class="missing wiki">WebOb?</a> from v1.0.7 has some interesting new behaviour with reading request data for different Content-Types:
</p>
<ul><li>It seems that looking at request.body mangles request.POST. See fix in ckan cset:e83bad9caa1b (problem with <a class="missing wiki">WebOb?</a> v1.0.7 but may go back to v1.0.4?)
</li></ul><ul><li>A particular request caused an <a class="missing wiki">AssertionError?</a> during looking at request.body, so we need to enclose this in a try/except. I couldn't recreate it in a test unfortunately (problem with <a class="missing wiki">WebOb?</a> v1.0.7 but may go back to v1.0.2?)
</li></ul><p>
Example:
</p>
<pre class="wiki">Module ckan.controllers.api:206 in create
&lt;&lt;          log.debug('create: %s' % (context))
               try:
                   request_data = self._get_request_data()
               except ValueError, inst:
                   response.status_int = 400
&gt;&gt;  request_data = self._get_request_data()
Module ckan.lib.base:149 in _get_request_data
&lt;&lt;          cls.log.debug('Retrieving request params: %r' % request.params)
               cls.log.debug('Retrieving request POST: %r' % request.POST)
               cls.log.debug('Retrieving request POST body: %r' % request.body)
               if request.POST:
                   try:
&gt;&gt;  cls.log.debug('Retrieving request POST body: %r' % request.body)
Module paste.registry:137 in __getattr__
&lt;&lt;      
           def __getattr__(self, attr):
               return getattr(self._current_obj(), attr)
           
           def __setattr__(self, attr, value):
&gt;&gt;  return getattr(self._current_obj(), attr)
Module webob.request:470 in _body__get
&lt;&lt;          Return the content of the request body.
               """
               self.make_body_seekable() # we need this to have content_length
               r = self.body_file.read(self.content_length)
               self.body_file.seek(0)
&gt;&gt;  self.make_body_seekable() # we need this to have content_length
Module webob.request:697 in make_body_seekable
&lt;&lt;              self.body_file_raw.seek(0)
               else:
                   self.copy_body()
&gt;&gt;  self.copy_body()
Module webob.request:714 in copy_body
&lt;&lt;                  self.body = self.body_file_raw.read(length)
               elif self.is_body_readable:
                   self.body = self.body_file_raw.read()
                   self._copy_body_tempfile()
               else:
&gt;&gt;  self.body = self.body_file_raw.read()
Module webob.request:1190 in read
&lt;&lt;      def read(self, size=-1):
               body = self._get_body()
               if size &lt; 0:
                   v = body[self.position:]
&gt;&gt;  body = self._get_body()
Module webob.request:1207 in _get_body
&lt;&lt;                  self._body = _encode_multipart(self.vars, self.content_type)
                   else:
                       assert 0, ('Bad content type: %r' % self.content_type)
               return self._body
&gt;&gt;  assert 0, ('Bad content type: %r' % self.content_type)
AssertionError: Bad content type: '; charset=utf-8'
</pre>
                            
                          </td>
                          <td class="PosixTime">1309949451000000
                          </td>
                          <td class="ModifiedTime">1309974781000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1158.html">#1158</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">pudo
                          </td>
                          <td class="reporter">pudo
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/pdeu-1.html">pdeu-1</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1158.html">Put PDEU into read-only mode and remove unneeded functions</a>
                          </td>
                          <td class="description">
                            <p>
PDEU should be in a mode where: 
</p>
<ul><li>Users cannot edit or create packages
</li><li>Users cannot sign up on their own
</li><li><a class="missing wiki">AuthorizationGroups?</a> and <a class="missing wiki">RevisionHistory?</a> is completely gone from the UI 
</li><li>Groups have been repurposed as Subjects
</li></ul>
                            
                          </td>
                          <td class="PosixTime">1306337786000000
                          </td>
                          <td class="ModifiedTime">1309804060000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1160.html">#1160</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">amercader
                          </td>
                          <td class="reporter">amercader
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/pdeu-1.html">pdeu-1</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">wontfix
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1160.html">Havest CSW servers on PDEU</a>
                          </td>
                          <td class="description">
                            <p>
It could be interesting for the publicdata.eu project to add some CSW datasources. Thanks to the INSPIRE directive, there are quite a few national catalogs of geodata that could be worth harvesting.
Work on this should include:
</p>
<ul><li>Compose Endpoint List (1d)
</li><li>Harvest on staging system and evaluate which sources have useful material (2d)
</li></ul><p>
First point is being performed in this GDoc:
<a class="ext-link" href="https://spreadsheets.google.com/spreadsheet/ccc?key=0Atp3cZFjuIOAdDBVQWRINnlfN1d0b2lleHVEdjBSb2c&amp;authkey=CNu4hsEB&amp;hl=en_US#gid=0"><span class="icon">​</span>https://spreadsheets.google.com/spreadsheet/ccc?key=0Atp3cZFjuIOAdDBVQWRINnlfN1d0b2lleHVEdjBSb2c&amp;authkey=CNu4hsEB&amp;hl=en_US#gid=0</a>
</p>

                            
                          </td>
                          <td class="PosixTime">1306407271000000
                          </td>
                          <td class="ModifiedTime">1309804038000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1157.html">#1157</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">pudo
                          </td>
                          <td class="reporter">pudo
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/pdeu-1.html">pdeu-1</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1157.html">A simple theme for publicdata.eu, CKAN</a>
                          </td>
                          <td class="description">
                            <p>
Change the visual style of CKAN to be more like these sites: 
</p>
<ul><li><a class="missing wiki">GitHub?</a>
</li><li>Quora 
</li><li>Google Projects
</li></ul><p>
This does not include major UX work. 
</p>

                            
                          </td>
                          <td class="PosixTime">1306337573000000
                          </td>
                          <td class="ModifiedTime">1309804029000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1193.html">#1193</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">kindly
                          </td>
                          <td class="reporter">kindly
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1193.html">bug with new formalchemy causing all resouces to be deleted</a>
                          </td>
                          <td class="description">
                            <p>
The new formalchemy stores dict in a new format.
</p>

                            
                          </td>
                          <td class="PosixTime">1308525655000000
                          </td>
                          <td class="ModifiedTime">1309768960000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1206.html">#1206</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">wwaites
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1206.html">"Content-Type json" header scuppers package POST</a>
                          </td>
                          <td class="description">
                            <p>
Compare these two requests to create a package:
</p>
<pre class="wiki">curl http://test.ckan.net/api/rest/package -d '{name:"test"}' -H 'Content-Type: application/json' -H 'X-CKAN-API-KEY: tester'
curl http://test.ckan.net/api/rest/package -d '{name:"test"}' -H 'X-CKAN-API-KEY: tester'
</pre><p>
The second one gets the payload through (ckan log):
</p>
<pre class="wiki">Retrieving request params: UnicodeMultiDict([('{name:"test"}', u'')])
</pre><p>
But the first one causes a <a class="missing wiki">ServerError?</a> because the payload (name:&#34;test&#34;) doesn't make it to request.POST or request.params:
</p>
<pre class="wiki">Retrieving request params: UnicodeMultiDict([])
</pre><p>
The only difference is the "<a class="missing wiki">ContentType?</a>: application/json" header, which seems a reasonable thing to include. Javascript lib backbone.js (for example) inserts this automatically.
</p>
<p>
So why does this header cause the payload to not get through to the request object?
</p>

                            
                          </td>
                          <td class="PosixTime">1309344348000000
                          </td>
                          <td class="ModifiedTime">1309450216000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1196.html">#1196</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.5-sprint-3.html">ckan-v1.5-sprint-3</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1196.html">Markdown logging ignores config settings</a>
                          </td>
                          <td class="description">
                            <p>
Markdown produces Debug logging, even when the pylons logging config is set to level of Info or Warning. This clogs up the logfile.
</p>

                            
                          </td>
                          <td class="PosixTime">1308743476000000
                          </td>
                          <td class="ModifiedTime">1308743857000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1191.html">#1191</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.5-sprint-3.html">ckan-v1.5-sprint-3</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1191.html">Unicode in user password gives 500 error on user registration</a>
                          </td>
                          <td class="description">
                            <p>
Create/register a user with a unicode character in the password. It creates the user, but the redirect to the user page doesn't work and results in 500 error.
</p>

                            
                          </td>
                          <td class="PosixTime">1308312895000000
                          </td>
                          <td class="ModifiedTime">1308650930000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1164.html">#1164</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">amercader
                          </td>
                          <td class="reporter">amercader
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/pdeu-1.html">pdeu-1</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1164.html">Cloropleth Map of European Data Availability for PDEU</a>
                          </td>
                          <td class="description">
                            <p>
A nice map in the homepage showing the availability of data across Europe
</p>

                            
                          </td>
                          <td class="PosixTime">1306408824000000
                          </td>
                          <td class="ModifiedTime">1308647224000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1162.html">#1162</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">amercader
                          </td>
                          <td class="reporter">amercader
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/pdeu-1.html">pdeu-1</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1162.html">Define a common extra for storing the geographic extent</a>
                          </td>
                          <td class="description">
                            <p>
We need a common extra across the different harvested sources that defines the extent of the data. We will have mainly national level catalogues, but also at a lower level (region, city).
</p>
<p>
Relevant discussion:
<a class="ext-link" href="http://lists.okfn.org/pipermail/ckan-discuss/2011-May/001245.html"><span class="icon">​</span>http://lists.okfn.org/pipermail/ckan-discuss/2011-May/001245.html</a>
</p>

                            
                          </td>
                          <td class="PosixTime">1306408704000000
                          </td>
                          <td class="ModifiedTime">1308647187000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1033.html">#1033</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1033.html">Register user with blank password causes 500</a>
                          </td>
                          <td class="description">
                            <p>
Go to <a class="ext-link" href="http://ckan.net/user/register"><span class="icon">​</span>http://ckan.net/user/register</a> and fill in all the fields apart from password. On submit you get 500 error.
</p>

                            
                          </td>
                          <td class="PosixTime">1299796274000000
                          </td>
                          <td class="ModifiedTime">1308310446000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1187.html">#1187</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.5-sprint-3.html">ckan-v1.5-sprint-3</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1187.html">Stop spam users with links in the 'about' field</a>
                          </td>
                          <td class="description">
                            <p>
When you edit a user, you should be stopped from putting links in the 'about' field, because this is a common tactic by spammers.
</p>

                            
                          </td>
                          <td class="PosixTime">1308142999000000
                          </td>
                          <td class="ModifiedTime">1308143605000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1178.html">#1178</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">
                          </td>
                          <td class="reporter">fccoelho
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1178.html">Local storage issue with ckanext-storage</a>
                          </td>
                          <td class="description">
                            <p>
I have followed the instruction for installation a configuration of ckanext-storage, but I am getting this error when I try to access the /storage/upload url:
</p>
<p>
URL: <a class="ext-link" href="http://ckan.emap.fgv.br/storage/upload"><span class="icon">​</span>http://ckan.emap.fgv.br/storage/upload</a>
Module weberror.errormiddleware:162 in <span class="underline">call</span>
&lt;&lt;              <span class="underline">traceback_supplement</span> = Supplement, self, environ
</p>
<blockquote>
<p>
sr_checker = <a class="missing wiki">ResponseStartChecker?</a>(start_response)
app_iter = self.application(environ, sr_checker)
return self.make_catching_iter(app_iter, environ, sr_checker)
</p>
</blockquote>
<blockquote>
<p>
except:
</p>
<blockquote class="citation">
<blockquote class="citation">
<blockquote>
<p>
app_iter = self.application(environ, sr_checker)
</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<p>
Module beaker.middleware:73 in <span class="underline">call</span>
&lt;&lt;                                                     self.cache_manager)
</p>
<blockquote>
<p>
environ[self.environ_key] = self.cache_manager
return self.app(environ, start_response)
</p>
<blockquote class="citation">
<blockquote class="citation">
<blockquote>
<p>
return self.app(environ, start_response)
</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<p>
Module beaker.middleware:152 in <span class="underline">call</span>
&lt;&lt;                          headers.append(('Set-cookie', cookie))
</p>
<blockquote>
<p>
return start_response(status, headers, exc_info)
</p>
</blockquote>
<blockquote>
<p>
return self.wrap_app(environ, session_start_response)
</p>
</blockquote>
<p>
          
</p>
<blockquote>
<p>
def _get_session(self):
</p>
<blockquote class="citation">
<blockquote class="citation">
<blockquote>
<p>
return self.wrap_app(environ, session_start_response)
</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<p>
Module routes.middleware:130 in <span class="underline">call</span>
&lt;&lt;                  environ<a class="missing wiki">SCRIPT_NAME?</a> = environ<a class="missing wiki">SCRIPT_NAME?</a>[:-1]
              
</p>
<blockquote>
<p>
response = self.app(environ, start_response)
</p>
</blockquote>
<p>
              
</p>
<blockquote>
<p>
# Wrapped in try as in rare cases the attribute will be gone already
</p>
<blockquote class="citation">
<blockquote class="citation">
<blockquote>
<p>
response = self.app(environ, start_response)
</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<p>
Module pylons.wsgiapp:124 in <span class="underline">call</span>
&lt;&lt;                  return <a class="missing wiki">% paste.registry.restorer.get_request_id(environ)?</a>
              
</p>
<blockquote>
<p>
controller = self.resolve(environ, start_response)
response = self.dispatch(controller, environ, start_response)
</p>
</blockquote>
<p>
              
</p>
<blockquote class="citation">
<blockquote class="citation">
<blockquote>
<p>
controller = self.resolve(environ, start_response)
</p>
</blockquote>
</blockquote>
</blockquote>
<p>
Module pylons.wsgiapp:263 in resolve
&lt;&lt;          if self.log_debug:
</p>
<blockquote>
<p>
log.debug("Resolved URL to controller: %r", controller)
</p>
</blockquote>
<blockquote>
<p>
return self.find_controller(controller)
</p>
</blockquote>
<p>
          
</p>
<blockquote>
<p>
def find_controller(self, controller):
</p>
<blockquote class="citation">
<blockquote class="citation">
<blockquote>
<p>
return self.find_controller(controller)
</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<p>
Module ckan.config.environment:39 in find_controller
&lt;&lt;          # Check to see if its a dotted name
</p>
<blockquote>
<p>
if '.' in controller or ':' in controller:
</p>
<blockquote>
<p>
mycontroller = pkg_resources.<a class="missing wiki">EntryPoint?</a>.parse('x=%s' % controller).load(False)
self.controller_classes[controller] = mycontroller
return mycontroller
</p>
<blockquote class="citation">
<blockquote class="citation">
<blockquote>
<p>
mycontroller = pkg_resources.<a class="missing wiki">EntryPoint?</a>.parse('x=%s' % controller).load(False)
</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<p>
Module pkg_resources:1954 in load
&lt;&lt;      def load(self, require=True, env=None, installer=None):
</p>
<blockquote>
<p>
if require: self.require(env, installer)
entry = <span class="underline">import</span>(self.module_name, globals(),globals(), <a class="missing wiki">__name__?</a>)
for attr in self.attrs:
</p>
<blockquote>
<p>
try:
</p>
<blockquote class="citation">
<blockquote class="citation">
<blockquote>
<p>
entry = <span class="underline">import</span>(self.module_name, globals(),globals(), <a class="missing wiki">__name__?</a>)
</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<p>
Module ?:87 in &lt;module&gt;
&lt;&lt;  class StorageAPIController(<a class="missing wiki">BaseController?</a>):
</p>
<blockquote>
<p>
ofs = get_ofs()
</p>
</blockquote>
<p>
          
</p>
<blockquote class="citation">
<blockquote class="citation">
<blockquote>
<p>
class StorageAPIController(<a class="missing wiki">BaseController?</a>):
</p>
</blockquote>
</blockquote>
</blockquote>
<p>
Module ?:88 in StorageAPIController
&lt;&lt;  class StorageAPIController(<a class="missing wiki">BaseController?</a>):
</p>
<blockquote>
<p>
ofs = get_ofs()
</p>
</blockquote>
<p>
          
</p>
<blockquote>
<p>
@jsonpify
</p>
<blockquote class="citation">
<blockquote class="citation">
<blockquote>
<p>
ofs = get_ofs()
</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<p>
Module ?:69 in get_ofs
&lt;&lt;              continue
</p>
<blockquote>
<p>
kw[k[4:]] = v
</p>
</blockquote>
<blockquote>
<p>
ofs = get_impl(storage_backend)(<strong>kw)
return ofs
</strong></p>
<blockquote class="citation">
<blockquote class="citation">
<blockquote>
<p>
ofs = get_impl(storage_backend)(<strong>kw)
</strong></p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<p>
Module ofs.local.pairtreestore:26 in <span class="underline">init</span>
&lt;&lt;          self.hashing_type = hashing_type
</p>
<blockquote>
<p>
self.shorty_length = shorty_length
self._open_store()
</p>
</blockquote>
<p>
          
</p>
<blockquote>
<p>
def _open_store(self):
</p>
<blockquote class="citation">
<blockquote class="citation">
<blockquote>
<p>
self._open_store()
</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<p>
Module ofs.local.pairtreestore:30 in _open_store
&lt;&lt;      def _open_store(self):
</p>
<blockquote>
<p>
if self.hashing_type:
</p>
<blockquote>
<p>
self._store = <a class="missing wiki">PairtreeStorageClient?</a>(self.uri_base, self.storage_dir, shorty_length=self.shorty_length, hashing_type=self.hashing_type)
</p>
</blockquote>
<p>
else:
</p>
<blockquote>
<p>
self._store = <a class="missing wiki">PairtreeStorageClient?</a>(self.uri_base, self.storage_dir, shorty_length=shorty_length)
</p>
<blockquote class="citation">
<blockquote class="citation">
<blockquote>
<p>
self._store = <a class="missing wiki">PairtreeStorageClient?</a>(self.uri_base, self.storage_dir, shorty_length=self.shorty_length, hashing_type=self.hashing_type)
</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<p>
Module pairtree.pairtree_client:91 in <span class="underline">init</span>
&lt;&lt;          self._decode = re.compile(r"\<sup>(..)", re.U)
              
</sup></p>
<blockquote>
<p>
self._init_store()
</p>
</blockquote>
<p>
      
</p>
<blockquote>
<p>
def <span class="underline">char2hex(self, m):
</span></p>
<blockquote class="citation">
<blockquote class="citation">
<blockquote>
<p>
self._init_store()
</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<p>
Module pairtree.pairtree_client:264 in _init_store
&lt;&lt;                      self.uri_base = prefix
</p>
<blockquote>
<p>
else:
</p>
<blockquote>
<p>
raise NotAPairtreeStoreException
</p>
</blockquote>
</blockquote>
<p>
      
</p>
<blockquote>
<p>
if not os.path.isdir(self.store_dir):
</p>
<blockquote class="citation">
<blockquote class="citation">
<blockquote>
<p>
raise NotAPairtreeStoreException
</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<p>
NotAPairtreeStoreException:
CGI Variables
AUTH_TYPE         'cookie'
DOCUMENT_ROOT         '/etc/apache2/htdocs'
GATEWAY_INTERFACE         'CGI/1.1'
HTTP_ACCEPT         'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8'
HTTP_ACCEPT_CHARSET         'ISO-8859-1,utf-8;q=0.7,*;q=0.7'
HTTP_ACCEPT_ENCODING         'gzip, deflate'
HTTP_ACCEPT_LANGUAGE         'pt-br,pt;q=0.8,en-us;q=0.5,en;q=0.3'
HTTP_CONNECTION         'keep-alive'
HTTP_COOKIE         '<span class="underline">utma=4669863.1260802706.1295364409.1306935693.1306960483.86; </span>utmz=4669863.1295364409.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); SESS61faf7f7d2406929b2f9eb4cbfff17d2=a3306f5d1194cf0d8a51dbf7b42c1259; ckan=d4951177ef995d92f0f987d481bd9180aa0f89e4518921db9cd9b6ac75fdd3fab4a25d06; auth_tkt="c6c3c3e0b3fe7bb765356659992760b24da43221flaviouserid_type:unicode"; auth_tkt="c6c3c3e0b3fe7bb765356659992760b24da43221flaviouserid_type:unicode"; ckan_user="flavio"; ckan_display_name="Fl\xc3\xa1vio Code\xc3\xa7o Coelho"; ckan_apikey="c139718d-918f-4a2b-b219-e33cb05cbe23"; <span class="underline">utmc=4669863; hide_welcome_message=1'
HTTP_HOST         'ckan.emap.fgv.br'
HTTP_KEEP_ALIVE         '115'
HTTP_USER_AGENT         'Mozilla/5.0 (X11; Linux x86_64; rv:2.0.1) Gecko/20100101 Firefox/4.0.1'
PATH_INFO         '/storage/upload'
PATH_TRANSLATED         '/home/flavio/var/srvc/ckan.emap.fgv.br/pyenv/bin/ckan.emap.fgv.br.py/storage/upload'
REMOTE_ADDR         '10.250.48.110'
REMOTE_PORT         '57426'
REMOTE_USER         u'flavio'
REMOTE_USER_DATA         'userid_type:unicode'
REMOTE_USER_TOKENS         [<em>]
REQUEST_METHOD         'GET'
REQUEST_URI         '/storage/upload'
SCRIPT_FILENAME         '/home/flavio/var/srvc/ckan.emap.fgv.br/pyenv/bin/ckan.emap.fgv.br.py'
SERVER_ADDR         '10.252.2.60'
SERVER_ADMIN         '[no address given]'
SERVER_NAME         'ckan.emap.fgv.br'
SERVER_PORT         '80'
SERVER_PROTOCOL         'HTTP/1.1'
SERVER_SIGNATURE         '&lt;address&gt;Apache/2.2.16 (Debian) Server at ckan.emap.fgv.br Port 80&lt;/address&gt;\n'
SERVER_SOFTWARE         'Apache/2.2.16 (Debian)'
WSGI Variables
application         &lt;beaker.middleware.<a class="missing wiki">CacheMiddleware?</a> object at 0x7fc2999a6cd0&gt;
beaker.cache         &lt;beaker.cache.<a class="missing wiki">CacheManager?</a> object at 0x7fc2999a6d90&gt;
beaker.get_session         &lt;bound method <a class="missing wiki">SessionMiddleware?</a>._get_session of &lt;beaker.middleware.<a class="missing wiki">SessionMiddleware?</a> object at 0x7fc2999a6d10&gt;&gt;
beaker.session         {'locale': u'pt_BR', '_accessed_time': 1307373458.4790759, '_creation_time': 1302605470.0245121}
mod_wsgi.application_group         'dck093|'
mod_wsgi.callable_object         'application'
mod_wsgi.handler_script         </em>
mod_wsgi.input_chunked         '0'
mod_wsgi.listener_host         <em>
mod_wsgi.listener_port         '80'
mod_wsgi.process_group         'ckan'
mod_wsgi.request_handler         'wsgi-script'
mod_wsgi.script_reloading         '1'
mod_wsgi.version         (3, 3)
paste.cookies         (&lt;SimpleCookie: SESS61faf7f7d2406929b2f9eb4cbfff17d2='a3306f5d1194cf0d8a51dbf7b42c1259' __utma='4669863.1260802706.1295364409.1306935693.1306960483.86' __utmc='4669863' __utmz='4669863.1295364409.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)' auth_tkt='c6c3c3e0b3fe7bb765356659992760b24da43221flavio!userid_type:unicode' ckan='d4951177ef995d92f0f987d481bd9180aa0f89e4518921db9cd9b6ac75fdd3fab4a25d06' ckan_apikey='c139718d-918f-4a2b-b219-e33cb05cbe23' ckan_display_name='Fl\xc3\xa1vio Code\xc3\xa7o Coelho' ckan_user='flavio' hide_welcome_message='1'&gt;, '</em></span><em>utma=4669863.1260802706.1295364409.1306935693.1306960483.86; <span class="underline">utmz=4669863.1295364409.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); SESS61faf7f7d2406929b2f9eb4cbfff17d2=a3306f5d1194cf0d8a51dbf7b42c1259; ckan=d4951177ef995d92f0f987d481bd9180aa0f89e4518921db9cd9b6ac75fdd3fab4a25d06; auth_tkt="c6c3c3e0b3fe7bb765356659992760b24da43221flavio!userid _type:unicode"; auth_tkt="c6c3c3e0b3fe7bb765356659992760b24da43221fla...lcome_message=1')
paste.registry         &lt;paste.registry.Registry object at 0x7fc299de4f50&gt;
paste.throw_errors         True
pylons.environ_config         {'session': 'beaker.session', 'cache': 'beaker.cache'}
pylons.pylons         &lt;pylons.util.<a class="missing wiki">PylonsContext?</a> object at 0x7fc299e27d50&gt;
pylons.routes_dict         {'action': u'index', 'controller': u'ckanext.storage.controller:StorageController'}
repoze.who.identity         &lt;repoze.who identity (hidden, dict-like) at 140473773131872&gt;
repoze.who.logger         &lt;logging.Logger instance at 0x7fc2999a3b48&gt;
repoze.who.plugins         {'openid': &lt;<a class="missing wiki">OpenIdIdentificationPlugin?</a> 140473779397008&gt;, 'friendlyform': &lt;<a class="missing wiki">FriendlyFormPlugin?</a> 140473777417040&gt;, 'ckan.lib.authenticator:UsernamePasswordAuthenticator': &lt;ckan.lib.authenticator.<a class="missing wiki">UsernamePasswordAuthenticator?</a> object at 0x7fc299b93a50&gt;, 'auth_tkt': &lt;<a class="missing wiki">AuthTktCookiePlugin?</a> 140473779397136&gt;, 'ckan.lib.authenticator:OpenIDAuthenticator': &lt;ckan.lib.authenticator.OpenIDAuthenticator object at 0x7fc299b934d0&gt;}
routes.route         &lt;routes.route.Route object at 0x7fc299864090&gt;
routes.url         &lt;routes.util.URLGenerator object at 0x7fc299e27ed0&gt;
webob._parsed_query_vars         (GET([]), </span></em><span class="underline">)
webob.adhoc_attrs         {'language': 'en-us'}
wsgi process         'Multi process AND threads (?)'
wsgi.file_wrapper         &lt;built-in method file_wrapper of mod_wsgi.Adapter object at 0x7fc299dae4e0&gt;
wsgi.version         (1, 1)
wsgiorg.routing_args         (&lt;routes.util.URLGenerator object at 0x7fc299e27ed0&gt;, {'action': u'index', 'controller': u'ckanext.storage.controller:StorageController'})
Reply
        
Reply to all
        
Forward
                
        
Reply to all
paste@localhost to fccoelho
        
show details 10:17 (2 hours ago)
        
</span></p>
<ul><li>Show quoted text -
</li></ul><p>
CGI Variables
AUTH_TYPE         'cookie'
DOCUMENT_ROOT         '/etc/apache2/htdocs'
GATEWAY_INTERFACE         'CGI/1.1'
HTTP_ACCEPT         'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8'
HTTP_ACCEPT_CHARSET         'ISO-8859-1,utf-8;q=0.7,*;q=0.7'
HTTP_ACCEPT_ENCODING         'gzip, deflate'
HTTP_ACCEPT_LANGUAGE         'pt-br,pt;q=0.8,en-us;q=0.5,en;q=0.3'
HTTP_CONNECTION         'keep-alive'
HTTP_COOKIE         '<span class="underline">utma=4669863.1260802706.1295364409.1306935693.1306960483.86; </span>utmz=4669863.1295364409.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); SESS61faf7f7d2406929b2f9eb4cbfff17d2=a3306f5d1194cf0d8a51dbf7b42c1259; ckan=d4951177ef995d92f0f987d481bd9180aa0f89e4518921db9cd9b6ac75fdd3fab4a25d06; auth_tkt="c6c3c3e0b3fe7bb765356659992760b24da43221flaviouserid_type:unicode"; auth_tkt="c6c3c3e0b3fe7bb765356659992760b24da43221flaviouserid_type:unicode"; ckan_user="flavio"; ckan_display_name="Fl\xc3\xa1vio Code\xc3\xa7o Coelho"; ckan_apikey="c139718d-918f-4a2b-b219-e33cb05cbe23"; <span class="underline">utmc=4669863; hide_welcome_message=1'
HTTP_HOST         'ckan.emap.fgv.br'
HTTP_KEEP_ALIVE         '115'
HTTP_USER_AGENT         'Mozilla/5.0 (X11; Linux x86_64; rv:2.0.1) Gecko/20100101 Firefox/4.0.1'
PATH_INFO         '/storage/upload'
PATH_TRANSLATED         '/home/flavio/var/srvc/ckan.emap.fgv.br/pyenv/bin/ckan.emap.fgv.br.py/storage/upload'
REMOTE_ADDR         '10.250.48.110'
REMOTE_PORT         '57429'
REMOTE_USER         u'flavio'
REMOTE_USER_DATA         'userid_type:unicode'
REMOTE_USER_TOKENS         [<em>]
REQUEST_METHOD         'GET'
REQUEST_URI         '/storage/upload'
SCRIPT_FILENAME         '/home/flavio/var/srvc/ckan.emap.fgv.br/pyenv/bin/ckan.emap.fgv.br.py'
SERVER_ADDR         '10.252.2.60'
SERVER_ADMIN         '[no address given]'
SERVER_NAME         'ckan.emap.fgv.br'
SERVER_PORT         '80'
SERVER_PROTOCOL         'HTTP/1.1'
SERVER_SIGNATURE         '&lt;address&gt;Apache/2.2.16 (Debian) Server at ckan.emap.fgv.br Port 80&lt;/address&gt;\n'
SERVER_SOFTWARE         'Apache/2.2.16 (Debian)'
WSGI Variables
application         &lt;beaker.middleware.<a class="missing wiki">CacheMiddleware?</a> object at 0x7fc2999a6cd0&gt;
beaker.cache         &lt;beaker.cache.<a class="missing wiki">CacheManager?</a> object at 0x7fc2999a6d90&gt;
beaker.get_session         &lt;bound method <a class="missing wiki">SessionMiddleware?</a>._get_session of &lt;beaker.middleware.<a class="missing wiki">SessionMiddleware?</a> object at 0x7fc2999a6d10&gt;&gt;
beaker.session         {'locale': u'pt_BR', '_accessed_time': 1307373466.085686, '_creation_time': 1302605470.0245121}
mod_wsgi.application_group         'dck093|'
mod_wsgi.callable_object         'application'
mod_wsgi.handler_script         </em>
mod_wsgi.input_chunked         '0'
mod_wsgi.listener_host         <em>
mod_wsgi.listener_port         '80'
mod_wsgi.process_group         'ckan'
mod_wsgi.request_handler         'wsgi-script'
mod_wsgi.script_reloading         '1'
mod_wsgi.version         (3, 3)
paste.cookies         (&lt;SimpleCookie: SESS61faf7f7d2406929b2f9eb4cbfff17d2='a3306f5d1194cf0d8a51dbf7b42c1259' __utma='4669863.1260802706.1295364409.1306935693.1306960483.86' __utmc='4669863' __utmz='4669863.1295364409.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)' auth_tkt='c6c3c3e0b3fe7bb765356659992760b24da43221flavio!userid_type:unicode' ckan='d4951177ef995d92f0f987d481bd9180aa0f89e4518921db9cd9b6ac75fdd3fab4a25d06' ckan_apikey='c139718d-918f-4a2b-b219-e33cb05cbe23' ckan_display_name='Fl\xc3\xa1vio Code\xc3\xa7o Coelho' ckan_user='flavio' hide_welcome_message='1'&gt;, '</em></span><em>utma=4669863.1260802706.1295364409.1306935693.1306960483.86; <span class="underline">utmz=4669863.1295364409.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); SESS61faf7f7d2406929b2f9eb4cbfff17d2=a3306f5d1194cf0d8a51dbf7b42c1259; ckan=d4951177ef995d92f0f987d481bd9180aa0f89e4518921db9cd9b6ac75fdd3fab4a25d06; auth_tkt="c6c3c3e0b3fe7bb765356659992760b24da43221flavio!userid _type:unicode"; auth_tkt="c6c3c3e0b3fe7bb765356659992760b24da43221fla...lcome_message=1')
paste.registry         &lt;paste.registry.Registry object at 0x7fc29a9da850&gt;
paste.throw_errors         True
pylons.environ_config         {'session': 'beaker.session', 'cache': 'beaker.cache'}
pylons.pylons         &lt;pylons.util.<a class="missing wiki">PylonsContext?</a> object at 0x7fc29a9ef950&gt;
pylons.routes_dict         {'action': u'index', 'controller': u'ckanext.storage.controller:StorageController'}
repoze.who.identity         &lt;repoze.who identity (hidden, dict-like) at 140473790084352&gt;
repoze.who.logger         &lt;logging.Logger instance at 0x7fc2999a3b48&gt;
repoze.who.plugins         {'openid': &lt;<a class="missing wiki">OpenIdIdentificationPlugin?</a> 140473779397008&gt;, 'friendlyform': &lt;<a class="missing wiki">FriendlyFormPlugin?</a> 140473777417040&gt;, 'ckan.lib.authenticator:UsernamePasswordAuthenticator': &lt;ckan.lib.authenticator.<a class="missing wiki">UsernamePasswordAuthenticator?</a> object at 0x7fc299b93a50&gt;, 'auth_tkt': &lt;<a class="missing wiki">AuthTktCookiePlugin?</a> 140473779397136&gt;, 'ckan.lib.authenticator:OpenIDAuthenticator': &lt;ckan.lib.authenticator.OpenIDAuthenticator object at 0x7fc299b934d0&gt;}
routes.route         &lt;routes.route.Route object at 0x7fc299864090&gt;
routes.url         &lt;routes.util.URLGenerator object at 0x7fc29a9efcd0&gt;
webob._parsed_query_vars         (GET([]), </span></em><span class="underline">)
webob.adhoc_attrs         {'language': 'en-us'}
wsgi process         'Multi process AND threads (?)'
wsgi.file_wrapper         &lt;built-in method file_wrapper of mod_wsgi.Adapter object at 0x7fc29a9d7d50&gt;
wsgi.version         (1, 1)
wsgiorg.routing_args         (&lt;routes.util.URLGenerator object at 0x7fc29a9efcd0&gt;, {'action': u'index', 'controller': u'ckanext.storage.controller:StorageController'})
</span></p>

                            
                          </td>
                          <td class="PosixTime">1307373810000000
                          </td>
                          <td class="ModifiedTime">1308045351000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1147.html">#1147</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">kindly
                          </td>
                          <td class="reporter">kindly
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.5-sprint-1.html">ckan-v1.5-sprint-1</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1147.html">Add expired_id to all revision tables.</a>
                          </td>
                          <td class="description">
                            <p>
Revision tables need expired_id to make querying history AND pending changes more efficient.
</p>
<p>
This involves making a session extension and a large table migration.
</p>

                            
                          </td>
                          <td class="PosixTime">1305839833000000
                          </td>
                          <td class="ModifiedTime">1307957556000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1146.html">#1146</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">kindly
                          </td>
                          <td class="reporter">kindly
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.5-sprint-1.html">ckan-v1.5-sprint-1</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1146.html">make logic layer control its own state</a>
                          </td>
                          <td class="description">
                            <p>
Logic layer should not use any vdm defined state and should manage it itself.
</p>

                            
                          </td>
                          <td class="PosixTime">1305829117000000
                          </td>
                          <td class="ModifiedTime">1307957527000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1173.html">#1173</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">amercader
                          </td>
                          <td class="reporter">amercader
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/pdeu-1.html">pdeu-1</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1173.html">Offer a DCat representation for packages in the API</a>
                          </td>
                          <td class="description">
                            <p>
/api/rest/package/foo.rdf should return a DCat representation of the package. To create it, we will use the functions in ckanext-rdf.
</p>

                            
                          </td>
                          <td class="PosixTime">1306939639000000
                          </td>
                          <td class="ModifiedTime">1307615271000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1174.html">#1174</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">pudo
                          </td>
                          <td class="reporter">pudo
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/pdeu-1.html">pdeu-1</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">wontfix
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1174.html">API Representation Registry</a>
                          </td>
                          <td class="description">
                            <p>
As CKAN grows, more and more optional representations of packages will become used. Besides RDF (which is the motivation for this ticket), support for DSPL, home-grown XML, or CSV listings is imaginable. 
</p>
<p>
To properly support this CKAN should have an extensible representation registry that can be extended when new output types become available (and without changing the API in the process). This needs to integrate in two places: 
</p>
<ul><li>We need to add support for file format extensions to the package handler and REST API. 
</li><li>We need to add HTTP content type negotiation (Accept headers).
</li></ul><p>
To support this we should have a registry with two registers: 
</p>
<ul><li>to map format extensions to mime types (e.g. "json" -&gt; "application/json")
</li><li>to map mime types and entity types to converter functions (e.g. 8"application/json", ckan.model.Package) -&gt; func(obj, mime_type) )
</li></ul><p>
This should be set up on load_environment so that IConfigurer plugins can feed into it. 
</p>
<p>
The registry should then first be added to _finish in the REST API (which needs to be refactored to be passed the {format} part of the URL if one is given. Based on the format part and HTTP headers, an appropriate representation can be generated by the registry and then be returned to the user. 
</p>
<p>
Forwarding of requests to the regular WUI controllers with Accept headers set or a format specified can be implemented in a separate effort. 
</p>

                            
                          </td>
                          <td class="PosixTime">1307050992000000
                          </td>
                          <td class="ModifiedTime">1307615200000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1159.html">#1159</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">pudo
                          </td>
                          <td class="reporter">pudo
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/pdeu-1.html">pdeu-1</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1159.html">Add RDFa to CKAN package pages</a>
                          </td>
                          <td class="description">
                            <p>
RDFa can be used as a simple way to expose linked data or at least sameAs the API version of the data but we need to make sure we do not expose anything different from the "official" representation.
</p>

                            
                          </td>
                          <td class="PosixTime">1306337907000000
                          </td>
                          <td class="ModifiedTime">1307615133000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1180.html">#1180</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.5-sprint-3.html">ckan-v1.5-sprint-3</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1180.html">Links in markdown can be badly formed</a>
                          </td>
                          <td class="description">
                            <p>
User can insert bad anchor tags into the User-About and Package-Notes fields and when you view them (web interface) it causes a 500 error.
</p>
<p>
Need to improve filtering for anchors in markdown.
</p>
<pre class="wiki">&lt;a href="http://xxxsex.com&gt;nasty/website
</pre><p>
Also check this related exception:
</p>
<pre class="wiki">Module ckan.controllers.user:59 in read
&lt;&lt;          c.is_myself = user.name == c.user
               c.api_key = user.apikey
               c.about_formatted = self._format_about(user.about)
               revisions_q = model.Session.query(model.Revision
                       ).filter_by(author=user.name)
&gt;&gt;  c.about_formatted = self._format_about(user.about)
Module ckan.controllers.user:167 in _format_about
&lt;&lt;      def _format_about(self, about):
               about_formatted = ckan.misc.MarkdownFormat().to_html(about)
               return genshi.HTML(about_formatted) 
       
           def _get_form_password(self):
&gt;&gt;  return genshi.HTML(about_formatted)
WebApp Error: &lt;class 'genshi.input.ParseError'&gt;: junk characters in start tag: u'\u201dhttp://www.settingu': line 1, column 3
</pre>
                            
                          </td>
                          <td class="PosixTime">1307469037000000
                          </td>
                          <td class="ModifiedTime">1307544223000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1181.html">#1181</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1181.html">Link spam vulnerability in Notes and User-About fields</a>
                          </td>
                          <td class="description">
                            <p>
When viewing a user and a package, the about/notes fields contain Markdown, which may have links. These should have rel="nofollow" to discourage link spam.
</p>

                            
                          </td>
                          <td class="PosixTime">1307523160000000
                          </td>
                          <td class="ModifiedTime">1307532816000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1177.html">#1177</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">
                          </td>
                          <td class="reporter">fccoelho
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1177.html">routes.util.GenerationException</a>
                          </td>
                          <td class="description">
                            <blockquote>
<p>
Hello,
</p>
</blockquote>
<p>
I have done a recent update to mu ckan install, and I am now getting this error for all my packages:
</p>
<pre class="wiki">URL: http://ckan.emap.fgv.br/package/dengue-net
Module weberror.errormiddleware:162 in __call__
&lt;&lt;              __traceback_supplement__ = Supplement, self, environ
                   sr_checker = ResponseStartChecker(start_response)
                   app_iter = self.application(environ, sr_checker)
                   return self.make_catching_iter(app_iter, environ, sr_checker)
               except:
&gt;&gt;  app_iter = self.application(environ, sr_checker)
Module beaker.middleware:73 in __call__
&lt;&lt;                                                     self.cache_manager)
               environ[self.environ_key] = self.cache_manager
               return self.app(environ, start_response)
&gt;&gt;  return self.app(environ, start_response)
Module beaker.middleware:152 in __call__
&lt;&lt;                          headers.append(('Set-cookie', cookie))
                   return start_response(status, headers, exc_info)
               return self.wrap_app(environ, session_start_response)
          
           def _get_session(self):
&gt;&gt;  return self.wrap_app(environ, session_start_response)
Module routes.middleware:130 in __call__
&lt;&lt;                  environ['SCRIPT_NAME'] = environ['SCRIPT_NAME'][:-1]
              
               response = self.app(environ, start_response)
              
               # Wrapped in try as in rare cases the attribute will be gone already
&gt;&gt;  response = self.app(environ, start_response)
Module pylons.wsgiapp:125 in __call__
&lt;&lt;         
               controller = self.resolve(environ, start_response)
               response = self.dispatch(controller, environ, start_response)
              
               if 'paste.testing_variables' in environ and hasattr(response,
&gt;&gt;  response = self.dispatch(controller, environ, start_response)
Module pylons.wsgiapp:324 in dispatch
&lt;&lt;          if log_debug:
                   log.debug("Calling controller class with WSGI interface")
               return controller(environ, start_response)
          
           def load_test_env(self, environ):
&gt;&gt;  return controller(environ, start_response)
Module ckan.lib.base:118 in __call__
&lt;&lt;          # available in environ['pylons.routes_dict']   
               try:
                   return WSGIController.__call__(self, environ, start_response)
               finally:
                   model.Session.remove()
&gt;&gt;  return WSGIController.__call__(self, environ, start_response)
Module pylons.controllers.core:221 in __call__
&lt;&lt;                  return response(environ, self.start_response)
              
               response = self._dispatch_call()
               if not start_response_called:
                   self.start_response = start_response
&gt;&gt;  response = self._dispatch_call()
Module pylons.controllers.core:172 in _dispatch_call
&lt;&lt;              req.environ['pylons.action_method'] = func
                  
                   response = self._inspect_call(func)
               else:
                   if log_debug:
&gt;&gt;  response = self._inspect_call(func)
Module pylons.controllers.core:107 in _inspect_call
&lt;&lt;                        func.__name__, args)
               try:
                   result = self._perform_call(func, args)
               except HTTPException, httpe:
                   if log_debug:
&gt;&gt;  result = self._perform_call(func, args)
Module pylons.controllers.core:60 in _perform_call
&lt;&lt;          """Hide the traceback for everything above this method"""
               __traceback_hide__ = 'before_and_this'
               return func(**args)
          
           def _inspect_call(self, func):
&gt;&gt;  return func(**args)
Module ?:2 in read
Module ckan.lib.cache:167 in wrapper
&lt;&lt;      log = __import__("logging").getLogger("proxy_cache")
           def wrapper(func, *args, **kwargs):
               result = func(*args, **kwargs)
      
               pylons = get_pylons(args)
&gt;&gt;  result = func(*args, **kwargs)
Module ckan.controllers.package:208 in read
&lt;&lt;          #render the package
               PackageSaver().render_package(c.pkg)
               return render('package/read.html')
      
           def comments(self, id):
&gt;&gt;  return render('package/read.html')
Module ckan.lib.base:74 in render
&lt;&lt;     
           return cached_template(template_name, render_template, cache_key=cache_key,
                                  cache_type=cache_type, cache_expire=cache_expire)
                                  #, ns_options=('method'), method=method)
&gt;&gt;  cache_type=cache_type, cache_expire=cache_expire)
Module pylons.templating:249 in cached_template
&lt;&lt;          return content
           else:
               return render_func()
&gt;&gt;  return render_func()
Module ckan.lib.base:63 in render_template
&lt;&lt;              stream = item.filter(stream)
              
               return literal(stream.render(method=method, encoding=None))
          
           if 'Pragma' in response.headers:
&gt;&gt;  return literal(stream.render(method=method, encoding=None))
Module genshi.core:183 in render
&lt;&lt;              method = self.serializer or 'xml'
               generator = self.serialize(method=method, **kwargs)
               return encode(generator, method=method, encoding=encoding, out=out)
      
           def select(self, path, namespaces=None, variables=None):
&gt;&gt;  return encode(generator, method=method, encoding=encoding, out=out)
Module genshi.output:57 in encode
&lt;&lt;          _encode = lambda string: string
           if out is None:
               return _encode(''.join(list(iterator)))
           for chunk in iterator:
               out.write(_encode(chunk))
&gt;&gt;  return _encode(''.join(list(iterator)))
Module genshi.output:339 in __call__
&lt;&lt;          for filter_ in self.filters:
                   stream = filter_(stream)
               for kind, data, pos in stream:
                   cached = cache_get((kind, data))
                   if cached is not None:
&gt;&gt;  for kind, data, pos in stream:
Module genshi.output:670 in __call__
&lt;&lt;          _gen_prefix = _gen_prefix().next
      
               for kind, data, pos in stream:
                   output = cache_get((kind, data))
                   if output is not None:
&gt;&gt;  for kind, data, pos in stream:
Module genshi.output:771 in __call__
&lt;&lt;          push_text = textbuf.append
               pop_text = textbuf.pop
               for kind, data, pos in chain(stream, [(None, None, None)]):
      
                   if kind is TEXT:
&gt;&gt;  for kind, data, pos in chain(stream, [(None, None, None)]):
Module genshi.output:586 in __call__
&lt;&lt;      def __call__(self, stream):
               prev = (None, None, None)
               for ev in stream:
                   if prev[0] is START:
                       if ev[0] is END:
&gt;&gt;  for ev in stream:
Module genshi.core:288 in _ensure
&lt;&lt;      # unchanged
           yield event
           for event in stream:
               yield event
&gt;&gt;  for event in stream:
Module genshi.template.base:618 in _include
&lt;&lt;                      tmpl = self.loader.load(href, relative_to=event[2][0],
                                                   cls=cls or self.__class__)
                           for event in tmpl.generate(ctxt, **vars):
                               yield event
                       except TemplateNotFound:
&gt;&gt;  for event in tmpl.generate(ctxt, **vars):
Module genshi.template.base:618 in _include
&lt;&lt;                      tmpl = self.loader.load(href, relative_to=event[2][0],
                                                   cls=cls or self.__class__)
                           for event in tmpl.generate(ctxt, **vars):
                               yield event
                       except TemplateNotFound:
&gt;&gt;  for event in tmpl.generate(ctxt, **vars):
Module genshi.template.base:618 in _include
&lt;&lt;                      tmpl = self.loader.load(href, relative_to=event[2][0],
                                                   cls=cls or self.__class__)
                           for event in tmpl.generate(ctxt, **vars):
                               yield event
                       except TemplateNotFound:
&gt;&gt;  for event in tmpl.generate(ctxt, **vars):
Module genshi.template.base:605 in _include
&lt;&lt;          from genshi.template.loader import TemplateNotFound
      
               for event in stream:
                   if event[0] is INCLUDE:
                       href, cls, fallback = event[1]
&gt;&gt;  for event in stream:
Module genshi.template.markup:378 in _match
&lt;&lt;                      for event in self._match(self._flatten(template, ctxt,
                                                                  **vars),
                                                    ctxt, start=idx + 1, **vars):
                               yield event
&gt;&gt;  ctxt, start=idx + 1, **vars):
Module genshi.template.markup:327 in _match
&lt;&lt;                      break
      
               for event in stream:
      
                   # We (currently) only care about start and end events for matching
&gt;&gt;  for event in stream:
Module genshi.template.base:565 in _flatten
&lt;&lt;                  elif kind is EXPR:
                           result = _eval_expr(data, ctxt, vars)
                           if result is not None:
                               # First check for a string, otherwise the iterable test
&gt;&gt;  result = _eval_expr(data, ctxt, vars)
Module genshi.template.base:277 in _eval_expr
&lt;&lt;      if vars:
               ctxt.push(vars)
           retval = expr.evaluate(ctxt)
           if vars:
               ctxt.pop()
&gt;&gt;  retval = expr.evaluate(ctxt)
Module genshi.template.eval:178 in evaluate
&lt;&lt;          __traceback_hide__ = 'before_and_this'
               _globals = self._globals(data)
               return eval(self.code, _globals, {'__data__': data})
&gt;&gt;  return eval(self.code, _globals, {'__data__': data})
Module ?:16 in &lt;Expression u"h.subnav_link(c, h.icon('comments') + _('Comments &amp; Questions'), controller='package', action='comments', id=c.pkg.name)"&gt;
&lt;&lt;        &lt;/li&gt;
             &lt;li py:if="g.has_commenting"&gt;
                 ${h.subnav_link(c, h.icon('comments') + _('Comments &amp;amp; Questions'), controller='package', action='comments', id=c.pkg.name)}
             &lt;/li&gt;
             &lt;li&gt;${h.subnav_link(c, h.icon('page_white_stack') + _('History'), controller='package', action='history', id=c.pkg.name)}&lt;/li&gt;
&gt;&gt;  ${h.subnav_link(c, h.icon('comments') + _('Comments &amp;amp; Questions'), controller='package', action='comments', id=c.pkg.name)}
Module ckan.lib.helpers:126 in subnav_link
&lt;&lt;      return link_to(
               text,
               url_for(action=action, **kwargs),
               class_=('active' if c.action == action else '')
           )
&gt;&gt;  url_for(action=action, **kwargs),
Module routes.util:280 in url_for
&lt;&lt;          raise GenerationException(
                   "url_for could not generate URL. Called with args: %s %s" % \
                   (args, kargs))
           return url
&gt;&gt;  (args, kargs))
GenerationException: url_for could not generate URL. Called with args: () {'action': 'comments', 'controller': 'package', 'id': 'dengue-net'}
CGI Variables
AUTH_TYPE 	'cookie'
DOCUMENT_ROOT 	'/etc/apache2/htdocs'
GATEWAY_INTERFACE 	'CGI/1.1'
HTTP_ACCEPT 	'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8'
HTTP_ACCEPT_CHARSET 	'ISO-8859-1,utf-8;q=0.7,*;q=0.7'
HTTP_ACCEPT_ENCODING 	'gzip, deflate'
HTTP_ACCEPT_LANGUAGE 	'pt-br,pt;q=0.8,en-us;q=0.5,en;q=0.3'
HTTP_CONNECTION 	'keep-alive'
HTTP_COOKIE 	'__utma=4669863.1260802706.1295364409.1306935693.1306960483.86; __utmz=4669863.1295364409.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); SESS61faf7f7d2406929b2f9eb4cbfff17d2=a3306f5d1194cf0d8a51dbf7b42c1259; ckan=d4951177ef995d92f0f987d481bd9180aa0f89e4518921db9cd9b6ac75fdd3fab4a25d06; auth_tkt="c6c3c3e0b3fe7bb765356659992760b24da43221flavio!userid_type:unicode"; auth_tkt="c6c3c3e0b3fe7bb765356659992760b24da43221flavio!userid_type:unicode"; ckan_user="flavio"; ckan_display_name="Fl\xc3\xa1vio Code\xc3\xa7o Coelho"; ckan_apikey="c139718d-918f-4a2b-b219-e33cb05cbe23"; __utmc=4669863'
HTTP_HOST 	'ckan.emap.fgv.br'
HTTP_KEEP_ALIVE 	'115'
HTTP_REFERER 	'http://ckan.emap.fgv.br/'
HTTP_USER_AGENT 	'Mozilla/5.0 (X11; Linux x86_64; rv:2.0.1) Gecko/20100101 Firefox/4.0.1'
PATH_INFO 	'/package/dengue-net'
PATH_TRANSLATED 	'/home/flavio/var/srvc/ckan.emap.fgv.br/pyenv/bin/ckan.emap.fgv.br.py/package/dengue-net'
REMOTE_ADDR 	'10.250.48.110'
REMOTE_PORT 	'47624'
REMOTE_USER 	u'flavio'
REMOTE_USER_DATA 	'userid_type:unicode'
REMOTE_USER_TOKENS 	['']
REQUEST_METHOD 	'GET'
REQUEST_URI 	'/package/dengue-net'
SCRIPT_FILENAME 	'/home/flavio/var/srvc/ckan.emap.fgv.br/pyenv/bin/ckan.emap.fgv.br.py'
SERVER_ADDR 	'10.252.2.60'
SERVER_ADMIN 	'[no address given]'
SERVER_NAME 	'ckan.emap.fgv.br'
SERVER_PORT 	'80'
SERVER_PROTOCOL 	'HTTP/1.1'
SERVER_SIGNATURE 	'&lt;address&gt;Apache/2.2.16 (Debian) Server at ckan.emap.fgv.br Port 80&lt;/address&gt;\n'
SERVER_SOFTWARE 	'Apache/2.2.16 (Debian)'
WSGI Variables
application 	&lt;beaker.middleware.CacheMiddleware object at 0x7f051c802690&gt;
beaker.cache 	&lt;beaker.cache.CacheManager object at 0x7f051c802750&gt;
beaker.get_session 	&lt;bound method SessionMiddleware._get_session of &lt;beaker.middleware.SessionMiddleware object at 0x7f051c8026d0&gt;&gt;
beaker.session 	{'locale': u'pt_BR', '_accessed_time': 1307358102.6266389, '_creation_time': 1302605470.0245121}
mod_wsgi.application_group 	'dck093|'
mod_wsgi.callable_object 	'application'
mod_wsgi.handler_script 	''
mod_wsgi.input_chunked 	'0'
mod_wsgi.listener_host 	''
mod_wsgi.listener_port 	'80'
mod_wsgi.process_group 	'ckan'
mod_wsgi.request_handler 	'wsgi-script'
mod_wsgi.script_reloading 	'1'
mod_wsgi.version 	(3, 3)
paste.cookies 	(&lt;SimpleCookie: SESS61faf7f7d2406929b2f9eb4cbfff17d2='a3306f5d1194cf0d8a51dbf7b42c1259' __utma='4669863.1260802706.1295364409.1306935693.1306960483.86' __utmc='4669863' __utmz='4669863.1295364409.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)' auth_tkt='c6c3c3e0b3fe7bb765356659992760b24da43221flavio!userid_type:unicode' ckan='d4951177ef995d92f0f987d481bd9180aa0f89e4518921db9cd9b6ac75fdd3fab4a25d06' ckan_apikey='c139718d-918f-4a2b-b219-e33cb05cbe23' ckan_display_name='Fl\xc3\xa1vio Code\xc3\xa7o Coelho' ckan_user='flavio'&gt;, '__utma=4669863.1260802706.1295364409.1306935693.1306960483.86; __utmz=4669863.1295364409.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); SESS61faf7f7d2406929b2f9eb4cbfff17d2=a3306f5d1194cf0d8a51dbf7b42c1259; ckan=d4951177ef995d92f0f987d481bd9180aa0f89e4518921db9cd9b6ac75fdd3fab4a25d06; auth_tkt="c6c3c3e0b3fe7bb765356659992760b24da43221flavio!userid_type:unicode"; auth_tkt="c6c3c3e0b3fe7bb765356659992760b24da43221flavio!userid_type:unicode";... __utmc=4669863')
paste.registry 	&lt;paste.registry.Registry object at 0x7f051d7e5710&gt;
paste.throw_errors 	True
pylons.action_method 	&lt;bound method PackageController.read of &lt;ckan.controllers.package.PackageController object at 0x7f051d7e5b10&gt;&gt;
pylons.controller 	&lt;ckan.controllers.package.PackageController object at 0x7f051d7e5b10&gt;
pylons.environ_config 	{'session': 'beaker.session', 'cache': 'beaker.cache'}
pylons.pylons 	&lt;pylons.util.PylonsContext object at 0x7f051d7e5a50&gt;
pylons.routes_dict 	{'action': u'read', 'controller': u'package', 'id': u'dengue-net'}
repoze.who.identity 	&lt;repoze.who identity (hidden, dict-like) at 139659946193344&gt;
repoze.who.logger 	&lt;logging.Logger instance at 0x7f051c801128&gt;
repoze.who.plugins 	{'openid': &lt;OpenIdIdentificationPlugin 139659931643152&gt;, 'friendlyform': &lt;FriendlyFormPlugin 139659929725584&gt;, 'ckan.lib.authenticator:UsernamePasswordAuthenticator': &lt;ckan.lib.authenticator.UsernamePasswordAuthenticator object at 0x7f051c9e7610&gt;, 'auth_tkt': &lt;AuthTktCookiePlugin 139659931643280&gt;, 'ckan.lib.authenticator:OpenIDAuthenticator': &lt;ckan.lib.authenticator.OpenIDAuthenticator object at 0x7f051c9dcfd0&gt;}
routes.route 	&lt;routes.route.Route object at 0x7f051c69fd50&gt;
routes.url 	&lt;routes.util.URLGenerator object at 0x7f051d7e57d0&gt;
webob._parsed_cookies 	({'ckan': 'd4951177ef995d92f0f987d481bd9180aa0f89e4518921db9cd9b6ac75fdd3fab4a25d06', '__utmz': '4669863.1295364409.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)', 'auth_tkt': 'c6c3c3e0b3fe7bb765356659992760b24da43221flavio!userid_type:unicode', 'ckan_display_name': 'Fl\xc3\xa1vio Code\xc3\xa7o Coelho', 'ckan_apikey': 'c139718d-918f-4a2b-b219-e33cb05cbe23', 'ckan_user': 'flavio', '__utma': '4669863.1260802706.1295364409.1306935693.1306960483.86', '__utmc': '4669863', 'SESS61faf7f7d2406929b2f9eb4cbfff17d2': 'a3306f5d1194cf0d8a51dbf7b42c1259'}, '__utma=4669863.1260802706.1295364409.1306935693.1306960483.86; __utmz=4669863.1295364409.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); SESS61faf7f7d2406929b2f9eb4cbfff17d2=a3306f5d1194cf0d8a51dbf7b42c1259; ckan=d4951177ef995d92f0f987d481bd9180aa0f89e4518921db9cd9b6ac75fdd3fab4a25d06; auth_tkt="c6c3c3e0b3fe7bb765356659992760b24da43221flavio!userid_type:unicode"&lt; wbr&gt;; auth_tkt="c6c3c3e0b3fe7bb765356659992760b24da43221flavio!... __utmc=4669863')
webob._parsed_query_vars 	(GET([]), '')
webob.adhoc_attrs 	{'language': 'en-us'}
wsgi process 	'Multi process AND threads (?)'
wsgi.file_wrapper 	&lt;built-in method file_wrapper of mod_wsgi.Adapter object at 0x7f051cc1ad50&gt;
wsgi.version 	(1, 1)
wsgiorg.routing_args 	(&lt;routes.util.URLGenerator object at 0x7f051d7e57d0&gt;, {'action': u'read', 'controller': u'package', 'id': u'dengue-net'})
</pre>
                            
                          </td>
                          <td class="PosixTime">1307358586000000
                          </td>
                          <td class="ModifiedTime">1307374897000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1121.html">#1121</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">wontfix
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1121.html">JSON extras appear in package edit form mangled</a>
                          </td>
                          <td class="description">
                            <p>
It is possible to use the CKAN API to insert JSON format data into package extra values, but this data is displayed in the package edit form.
</p>
<p>
Example: Package <a class="ext-link" href="http://ckan.net/package/hbz_unioncatalog"><span class="icon">​</span>http://ckan.net/package/hbz_unioncatalog</a> in the API the extra value as a list:
</p>
<pre class="wiki">"extras": {"publishingInstitution": ["http://lobid.org/organisation/DE-605", "http://lobid.org/organisation/DE-290"...
</pre><p>
yet when you edit the package it loses all the quotes and brackets: <a class="ext-link" href="http://ckan.net/package/edit/hbz_unioncatalog"><span class="icon">​</span>http://ckan.net/package/edit/hbz_unioncatalog</a>
{{{<a class="ext-link" href="http://lobid.org/organisation/DE-605http://lobid.org/organisation/DE-290"><span class="icon">​</span>http://lobid.org/organisation/DE-605http://lobid.org/organisation/DE-290</a>...
}}}
so when you save the package, the list is mangled into a bad string.
</p>

                            
                          </td>
                          <td class="PosixTime">1304367504000000
                          </td>
                          <td class="ModifiedTime">1307358426000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1132.html">#1132</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">
                          </td>
                          <td class="reporter">johnlawrenceaspden
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-backlog.html">ckan-backlog</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">invalid
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1132.html">test_authz doesn't run</a>
                          </td>
                          <td class="description">
                            <p>
Trying to run the tests in test_authz.py with
</p>
<p>
$ nosetests --ckan ckan/tests/functional/test_authz.py
results in no tests being run:
</p>
<hr />
<p>
Ran 0 tests in 0.840s
</p>
<p>
OK (SKIP=3)
</p>

                            
                          </td>
                          <td class="PosixTime">1304966923000000
                          </td>
                          <td class="ModifiedTime">1307352675000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1143.html">#1143</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.5-sprint-2.html">ckan-v1.5-sprint-2</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1143.html">Improve stats page</a>
                          </td>
                          <td class="description">
                            <ul><li>Ensure we don't include deleted packages in the stats
</li><li>Some visual improvements:
<ul><li>Number of packages:
<ul><li>fix x axis to start at first revision
</li><li>fix y axis to start at zero
</li></ul></li><li>Fix problem with legend to 'Revisions to packages' graph.
</li><li>Hide sidebar in the template, so it isn't right-cropped in the DGU theme
</li></ul></li><li>Add some testing of the stats lib - results of basic stats
</li></ul>
                            
                          </td>
                          <td class="PosixTime">1305734836000000
                          </td>
                          <td class="ModifiedTime">1307024681000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1153.html">#1153</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">lucychambers
                          </td>
                          <td class="reporter">lucychambers
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-backlog.html">ckan-backlog</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1153.html">Update CKAN wiki front page</a>
                          </td>
                          <td class="description">
                            <p>
Update CKAN wiki front page - a la <a class="missing wiki">OpenSpending?</a>: <a class="ext-link" href="http://wiki.openspending.org/Main_Page"><span class="icon">​</span>http://wiki.openspending.org/Main_Page</a>
</p>
<p>
Sections should relate to different types of people using the site: 
</p>
<p>
Developers, Users etc..
</p>

                            
                          </td>
                          <td class="PosixTime">1306155211000000
                          </td>
                          <td class="ModifiedTime">1306941386000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1139.html">#1139</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">lucychambers
                          </td>
                          <td class="reporter">lucychambers
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-backlog.html">ckan-backlog</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1139.html">Create CKAN Theme Gallery</a>
                          </td>
                          <td class="description">
                            <p>
Take screenshots of existing ckan instances esp those mentioned
&lt;<a class="ext-link" href="http://wiki.ckan.net/Theming"><span class="icon">​</span>http://wiki.ckan.net/Theming</a>&gt; and put on flickr in ckan or ckan-theme
group so we can create a gallery ... (both to illustrate theming but
also to show ckan instances that are around -- could add to
<a class="ext-link" href="http://wiki.ckan.net/Instances"><span class="icon">​</span>http://wiki.ckan.net/Instances</a>)
</p>

                            
                          </td>
                          <td class="PosixTime">1305645859000000
                          </td>
                          <td class="ModifiedTime">1306941356000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1170.html">#1170</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.5-sprint-2.html">ckan-v1.5-sprint-2</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1170.html">Production deployment docs out of date</a>
                          </td>
                          <td class="description">
                            <p>
Need to cover pip-requirements.txt on different branches in the doc/deployment.rst. 
</p>
<p>
Also could do with tidying up upgrade.txt into this document too.
</p>

                            
                          </td>
                          <td class="PosixTime">1306864171000000
                          </td>
                          <td class="ModifiedTime">1306864422000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1156.html">#1156</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">pudo
                          </td>
                          <td class="reporter">pudo
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/pdeu-1.html">pdeu-1</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1156.html">Scraping harvesters for Paris and Vienna Catalogues</a>
                          </td>
                          <td class="description">
                            <p>
Import metadata from both sources into PDEU via the Harvesting framework but by scraping their respective catalogue pages. 
</p>
<ul><li><a class="ext-link" href="http://data.wien.gv.at/katalog/"><span class="icon">​</span>http://data.wien.gv.at/katalog/</a>
</li><li><a class="ext-link" href="http://opendata.paris.fr/opendata/jsp/site/Portal.jsp"><span class="icon">​</span>http://opendata.paris.fr/opendata/jsp/site/Portal.jsp</a>
</li></ul>
                            
                          </td>
                          <td class="PosixTime">1306337428000000
                          </td>
                          <td class="ModifiedTime">1306855111000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/935.html">#935</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">pudo
                          </td>
                          <td class="reporter">pudo
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/935.html">"groups" field bug in IATI</a>
                          </td>
                          <td class="description">
                            <p>
An internal server error was reported when trying to create a new package (not when editing):
</p>
<blockquote>
<p>
<a class="missing wiki">WebApp?</a> Error: &lt;class 'sqlalchemy.exceptions.<a class="missing wiki">IntegrityError?</a>'&gt;: (<a class="missing wiki">IntegrityError?</a>) null value in column "name" violates not-null constraint 'INSERT INTO package (id, name, title, version, url, author, author_email, maintainer, maintainer_email, notes, license_id, state, revision_id) VALUES (%(id)s, %(name)s, %(title)s, %(version)s, %(url)s, %(author)s, %(author_email)s, %(maintainer)s, %(maintainer_email)s, %(notes)s, %(license_id)s, %(state)s, %(revision_id)s)' {'maintainer': None, 'name': None, 'author': None, 'author_email': None, 'notes': None, 'title': None, 'maintainer_email': None, 'url': None, 'state': 'active', 'version': None, 'license_id': None, 'revision_id': '0141c09c-4eb3-4dda-a6b1-e07f2c73b4c5', 'id': '7fe16a29-f183-471a-99c5-2c2e81dd86e4'} 
</p>
</blockquote>
<p>
The error could not be reproduced in a non-apache/mod_wsgi environment, even with a dump of the live database. Further investigation by manual editing of the package form left the "groups" field as the likely cause. After updating the packages installed, and temporarily editing the package controller the problem vanished after a restart of the web server. 
</p>
<p>
Possible causes include: 
</p>
<ul><li>Stale pyc file
</li><li>Threading issue
</li><li>Dependency issue
</li></ul><p>
As the problem is gone for now, it cannot be further investigated atm. 
</p>

                            
                          </td>
                          <td class="PosixTime">1296302915000000
                          </td>
                          <td class="ModifiedTime">1306778682000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/913.html">#913</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">pudo
                          </td>
                          <td class="reporter">pudo
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.5.html">ckan-v1.5</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">wontfix
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/913.html">Handle licenses in dcat-tools</a>
                          </td>
                          <td class="description">
                            <ul><li>Create a list of all valid predicates where licenses are stored.
</li><li>Create a license normalization registry in GSpread
</li><li>Fill spreadsheet from OKD/OSI lists. 
</li></ul>
                            
                          </td>
                          <td class="PosixTime">1295266407000000
                          </td>
                          <td class="ModifiedTime">1306774962000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/912.html">#912</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">pudo
                          </td>
                          <td class="reporter">pudo
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.5.html">ckan-v1.5</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">wontfix
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/912.html">Rethink result row representation in dcat-tools/rdfsolr</a>
                          </td>
                          <td class="description">
                            <ul><li>Should license go in the bottom line? 
</li><li>Formats should be styled as in CKAN
</li></ul>
                            
                          </td>
                          <td class="PosixTime">1295266299000000
                          </td>
                          <td class="ModifiedTime">1306774876000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/944.html">#944</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">pudo
                          </td>
                          <td class="reporter">pudo
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/iati-4.html">iati-4</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/944.html">Upgrade IATI to CKAN 'default'</a>
                          </td>
                          <td class="description">
                            <ul><li>Move code base, fix any breakage. 
</li><li>Deploy to eu8 
</li><li>Test 
</li><li>Deploy to eu14 
</li></ul><h2 id="Why">Why</h2>
<p>
Later CKAN codebase has a bunch of improvements / fixes that it would be good to have.
</p>
<h2 id="Estimate">Estimate</h2>
<ul><li>8h
</li></ul>
                            
                          </td>
                          <td class="PosixTime">1296469688000000
                          </td>
                          <td class="ModifiedTime">1306774766000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1155.html">#1155</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">pudo
                          </td>
                          <td class="reporter">pudo
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/pdeu-1.html">pdeu-1</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1155.html">Harvester for data.london.gov.uk</a>
                          </td>
                          <td class="description">
                            <p>
Write a harvester for data.london.gov.uk to import catalogue metadata into PDEU. API (or at least documentation) is available at: <a class="ext-link" href="http://sourceforge.net/projects/londondatastore/files/"><span class="icon">​</span>http://sourceforge.net/projects/londondatastore/files/</a> 
</p>

                            
                          </td>
                          <td class="PosixTime">1306337318000000
                          </td>
                          <td class="ModifiedTime">1306773174000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/826.html">#826</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">kindly
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.4-sprint-1.html">ckan-v1.4-sprint-1</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/826.html">Resource 'extra' fields</a>
                          </td>
                          <td class="description">
                            <p>
There are a number of extra properties we want to store in a resource: 
</p>
<ul><li>resource size (in bytes, no. triples etc.) - <a class="ext-link" href="https://trac.dataco.coi.gov.uk/projects/datagov/ticket/673"><span class="icon">​</span>https://trac.dataco.coi.gov.uk/projects/datagov/ticket/673</a>
</li><li>resource hash is 'static' (default) or 'changeable' - <a class="ext-link" href="https://trac.dataco.coi.gov.uk/projects/datagov/ticket/674"><span class="icon">​</span>https://trac.dataco.coi.gov.uk/projects/datagov/ticket/674</a>
</li><li>alternative link (e.g. TNA Web Archive) to use the link is broken - <a class="ext-link" href="https://trac.dataco.coi.gov.uk/projects/datagov/ticket/173"><span class="icon">​</span>https://trac.dataco.coi.gov.uk/projects/datagov/ticket/173</a>
</li></ul><p>
i.e. this is a much needed enhancement
</p>
<p>
Need to be able to read/write these values in web interface and API.
</p>
<p>
(At some point we may wish to have custom form widgets for these new fields in the resource table, but let's leave this for the future.)
</p>
<h1 id="Implementation">Implementation</h1>
<p>
I suggest these are arbitrary key/value pairs, just like package extras, reusing <a class="missing wiki">PackageExtra?</a> code as much as possible.
(Other much more radical alternative is to move model to RDF.)
</p>

                            
                          </td>
                          <td class="PosixTime">1290611905000000
                          </td>
                          <td class="ModifiedTime">1306766057000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1169.html">#1169</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.5-sprint-2.html">ckan-v1.5-sprint-2</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1169.html">Link to csv/json dumps on ckan.net</a>
                          </td>
                          <td class="description">
                            
                            
                          </td>
                          <td class="PosixTime">1306749768000000
                          </td>
                          <td class="ModifiedTime">1306754833000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1122.html">#1122</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">pudo
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">wontfix
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1122.html">JSON Extra data not searchable</a>
                          </td>
                          <td class="description">
                            <p>
It is possible to use the CKAN API to insert JSON format data into package extra values, but this data is not found on searching.
</p>
<p>
Full text from Pascal:
</p>
<pre class="wiki">we encountered a Problem concerning accessing Arrays/Lists.

curl -XGET 'http://ckan.net/api/rest/package/hbz_unioncatalog'

will get you amongst others:

 "extras": {"publishingInstitution":
"[u'http://lobid.org/organisation/DE-605',
u'http://lobid.org/organisation/DE-290',
u'http://lobid.org/organisation/DE-38M',
u'http://lobid.org/organisation/DE-98',
u'http://lobid.org/organisation/DE-38',
u'http://lobid.org/organisation/DE-Kn41',
u'http://lobid.org/organisation/DE-82',
u'http://lobid.org/organisation/DE-107',
u'http://lobid.org/organisation/DE-929',
u'http://lobid.org/organisation/DE-Zw1',
u'http://lobid.org/organisation/DE-832']"}

but if I try to query this:

wget
'http://ckan.net/api/search/package?q=lobid&amp;publishingInstitution="http://lobid.org/organisation/DE-605"'

I get only two packages, among the package "hbz_unioncatalog" is
missing. (These two packages have only one value for
"publishingInstitution").

The "extra/publishingInstitution"-Array was uploaded through a "curl
-XPUT ...
 "extras": {
   "publishingInstitution":[
     "http://lobid.org/organisation/DE-605",
     "http://lobid.org/organisation/DE-290",
     "http://lobid.org/organisation/DE-38M",
     "http://lobid.org/organisation/DE-98",
     "http://lobid.org/organisation/DE-38",
     "http://lobid.org/organisation/DE-Kn41",
     "http://lobid.org/organisation/DE-82",
     "http://lobid.org/organisation/DE-107",
     "http://lobid.org/organisation/DE-929",
     "http://lobid.org/organisation/DE-Zw1",
     "http://lobid.org/organisation/DE-832"
   ]
   },
...
</pre>
                            
                          </td>
                          <td class="PosixTime">1304367510000000
                          </td>
                          <td class="ModifiedTime">1306747714000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/985.html">#985</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">pudo
                          </td>
                          <td class="reporter">pudo
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/pdeu-1.html">pdeu-1</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">duplicate
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/985.html">Harvest other data catalogues</a>
                          </td>
                          <td class="description">
                            <ul><li>data.london.gov.uk (1d, ping DERI)
</li><li>catalogues from Paris and Vienna (1d)
</li></ul><p>
Others?
</p>
<ul><li>digitaliser.dk (1d)
</li><li>data-publica.com (2d)
</li><li>data.suomi.fi (2d)
</li><li>dati.piedmonte.it (1d)
</li><li>portalu.de (2d)
</li></ul>
                            
                          </td>
                          <td class="PosixTime">1297679799000000
                          </td>
                          <td class="ModifiedTime">1306408134000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1161.html">#1161</a>
                          </td>
                          <td class="type">requirement
                          </td>
                          <td class="owner">pudo
                          </td>
                          <td class="reporter">amercader
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/pdeu-1.html">pdeu-1</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">duplicate
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1161.html">Build a simplified theme for PDEU</a>
                          </td>
                          <td class="description">
                            <p>
We need to offer a strongly simplified version, read-only of CKAN under publicdata.eu, with a focus on its role as search engine instead of a data catalogue.
</p>
<p>
This ticket relates to work on the PDEU theme only!
</p>

                            
                          </td>
                          <td class="PosixTime">1306407835000000
                          </td>
                          <td class="ModifiedTime">1306408026000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1149.html">#1149</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">kindly
                          </td>
                          <td class="reporter">kindly
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.5-sprint-1.html">ckan-v1.5-sprint-1</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1149.html">Change domain object modification plugin to use Session extension.</a>
                          </td>
                          <td class="description">
                            <p>
This should make it more efficient as it currently does a lot of repeating work.  i.e if you change a package and a resource in the same commit it sends out 2 notifications and should only really send out 1.   
</p>

                            
                          </td>
                          <td class="PosixTime">1305969863000000
                          </td>
                          <td class="ModifiedTime">1306090663000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1148.html">#1148</a>
                          </td>
                          <td class="type">refactor
                          </td>
                          <td class="owner">kindly
                          </td>
                          <td class="reporter">kindly
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.5-sprint-1.html">ckan-v1.5-sprint-1</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1148.html">test speed improvements and cleanup</a>
                          </td>
                          <td class="description">
                            <p>
The tests have been running slower recently and need fixing.  They also could do with a bit more consistency to them.
</p>

                            
                          </td>
                          <td class="PosixTime">1305969223000000
                          </td>
                          <td class="ModifiedTime">1305969925000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1111.html">#1111</a>
                          </td>
                          <td class="type">task
                          </td>
                          <td class="owner">lucychambers
                          </td>
                          <td class="reporter">lucychambers
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1111.html">FAQ - For CKAN</a>
                          </td>
                          <td class="description">
                            <p>
Write CKAN FAQ (Basis can be: <a class="ext-link" href="http://wiki.ckan.net/FAQ"><span class="icon">​</span>http://wiki.ckan.net/FAQ</a>) 
</p>
<p>
Post preliminary questions on: 
</p>
<p>
<a class="ext-link" href="http://notebook.okfn.org/"><span class="icon">​</span>http://notebook.okfn.org/</a>
</p>

                            
                          </td>
                          <td class="PosixTime">1303906561000000
                          </td>
                          <td class="ModifiedTime">1305881039000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1078.html">#1078</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">kindly
                          </td>
                          <td class="reporter">rgrp
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.5.html">ckan-v1.5</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1078.html">Refactors WUI controllers and forms to use logic layer</a>
                          </td>
                          <td class="description">
                            <ul><li>Deserialize forms to new dict format.
</li><li>Replace controllers/forms to use dictization.
</li></ul>
                            
                          </td>
                          <td class="PosixTime">1302509347000000
                          </td>
                          <td class="ModifiedTime">1305828973000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/842.html">#842</a>
                          </td>
                          <td class="type">enhancement
                          </td>
                          <td class="owner">johnglover
                          </td>
                          <td class="reporter">rgrp
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.4-sprint-7.html">ckan-v1.4-sprint-7</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/842.html">Todo list CKAN extension</a>
                          </td>
                          <td class="description">
                            <p>
An extension that provides a todo list feature on CKAN so that people can register and find things to do.
</p>
<p>
Extension name: ckanext-todo
</p>
<h2 id="UserStory">User Story</h2>
<h3 id="Packagepage">Package page</h3>
<p>
As a user I come to a package:
</p>
<ul><li>Have a todo count at that top that takes you down to the todo list (which may say nothing todo)
</li><li>At the bottom is a section of the package display titled "<a class="missing wiki">ToDo?</a>" where I see a list of all toDos for the package most recent at the top
<ul><li>If I am logged in 
<ul><li>See a form for "Add to do" at the top of the todo section and can add one straight away
</li><li>I see a "now resolved" button next to each which goes green when you hover.
</li></ul></li></ul></li></ul><blockquote>
<blockquote>
<blockquote>
<blockquote>
<p>
When clicked the todo fades away.
</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<ul><li>Not logged in: I see a button that says "login to add todo"
</li></ul><h3 id="Todolistpage">Todo list page</h3>
<p>
When a user comes to todo overview at /todo
</p>
<p>
At top list all todo categories with counts (or a progress bar). Click on category name or bar takes you down page to list for that category.
</p>
<p>
Category list has a list of todo items (ul with li items with class todo) - link to package relevant to the todo.
</p>
<h2 id="Implementation">Implementation</h2>
<p>
The Todo form
</p>
<ul><li>One of the fields is category -&gt; autocomplete the category (not constrained) (lowercase, no spaces, .-_ allowed)
</li><li>Add a description
</li><li>Submit, the todo gets added via AJAX to the list at the top as the most recent todo
</li></ul><p>
Model:
</p>
<pre class="wiki">todo table

  id (autoincrement integer)
  package_id
  todo_category_id (required)
  description (required)
  created=NOW()
  resolved=null (unresolved) or a datetime (datetime of resolution)
  creator=user
  resolver=user

todo_category table
  id
  name

Prepopulate with: broken-resource-link, no-author, bad-format, add-description
</pre><p>
API at /api/2/todo
</p>
<ul><li>GET / POST / PUT ...
</li></ul><p>
/api/2/todo?package=package_id_or_name&amp;category=...&amp;resolved=0/1
</p>
<ul><li>support limit (?)
</li></ul><p>
/api/2/todo/category -&gt; return list of todo categories
</p>
<ul><li>No GET / PUT / POST (these are auto-created by creation of todo)
</li></ul><h2 id="OptionalExtrasWillnotbedoneatm">Optional Extras (Will not be done atm)</h2>
<ul><li>Integrate todo tags (e.g. list packages tagged with a todo.{xxx} on Todo List page ...
</li></ul>
                            
                          </td>
                          <td class="PosixTime">1291467708000000
                          </td>
                          <td class="ModifiedTime">1305646487000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1127.html">#1127</a>
                          </td>
                          <td class="type">CREP
                          </td>
                          <td class="owner">
                          </td>
                          <td class="reporter">sebbacon
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1127.html">CREP0001: Formalise new feature discussion and definition using CREPs</a>
                          </td>
                          <td class="description">
                            <p>
<strong>Proposer:</strong> Seb Bacon<br />
<strong>Seconder:</strong> Rufus Pollock<br />
<br />
</p>
<h2 id="Abstract">Abstract</h2>
<p>
When adding major new features to CKAN, a longer, more formal discussion 
will improve software design quality and documentation, better engage
the wider community, and ensure the core team are up to date with
latest developments.  
</p>
<p>
I propose a formal process (CREP -- CKAN Revision and Enhancement Proposal) for making this happen.
</p>
<h2 id="TheProblem">The Problem</h2>
<p>
The current workflow for introducing major new features into CKAN is
very informal, typically based around one person's great idea, which
they've discussed with one or two other people in the team.  The
originator of the idea is typically the only person with access to 
all the input they've had through such discussions.  Often, the only 
location of this information is  in that person's head.
</p>
<p>
However, there is a lot of experience embodied in the CKAN community
which should be drawn on before making large design decisions.  This
will lead to better software.  Additionally, building consensus in the
community around a proposal before implementation ensures positive
community engagement and buy-in to new features, making them more
likely to be a success.
</p>
<p>
We aren't great at documenting new features.  Documentation after
coding is complete is an unrewarding experience for most programmers.
Requiring skeleton documentation before code is written is a good
discipline that can form the basis of better documentation in the
future (e.g. by a writer rather than a programmer).
</p>
<h2 id="Specification">Specification</h2>
<p>
Minor features don't require a CREP, and can just be entered in the
issue tracking system as a bug or feature.  As a rule of thumb, a
feature is major if it will take more than a day to implement, or is
likely to involve matters of opinion in its design.
</p>
<p>
A developer may decide that a CREP is too formal and long-winded. The 
decision to write a CREP is at at their discretion; however, new 
features MUST always be proposed via email, even if this is just a 
couple of sentences.
</p>
<p>
If a feature requires a CREP, the proposer should find a seconder
for their idea.  This sanity check step happens before a CREP is
written to ensure at least the possibility of consensus on the CREP.
</p>
<p>
Next the proposer should write a CREP, starting by copying and pasting
the <a class="ext-link" href="http://wiki.ckan.net/CKAN_Revision_and_Enhancement_Proposals"><span class="icon">​</span>template on the wiki</a> into a new Trac ticket.  This will be with a status of "new" and Type of "CREP".  The proposer should notify
the <a class="ext-link" href="http://lists.okfn.org/mailman/listinfo/ckan-dev"><span class="icon">​</span>ckan-dev</a> mailing
list, and possibly the
<a class="ext-link" href="http://lists.okfn.org/mailman/listinfo/ckan-discuss"><span class="icon">​</span>ckan-discuss</a>
list for less technical CREPs.
</p>
<p>
The draft can be discussed via email, verbally, or via the trac
ticket.  In any case, it is the proposer's responsibility to keep the
CREP updated to reflect the current consensus.
</p>
<p>
Once consensus has been reached, the ticket should be marked with the
"accepted" status and assigned to a CKAN release milestone.
</p>
<p>
When an accepted CREP has been implemented, it should be resolved as
"fixed".
</p>
<p>
If no consensus can be reached on a draft CREP, or for some reason an
accepted CREP doesn't get completed, it should be marked as or "wontfix".
</p>
<p>
If a completed CREP becomes obsolete, it should be marked as "invalid", 
with a note pointing to the obsoleting ticket(s)
</p>
<h2 id="Whydoitthisway">Why do it this way</h2>
<p>
Given the distributed nature of the core team plus other volunteers,
some kind of written procedure is necessary to ensure a fully
documented and discussed proposal.
</p>
<p>
The idea of "Enhancement Proposals" which can be semi-formally
proposed and discussed prior to implementation is common in the Open
Source world (<a class="ext-link" href="http://www.python.org/dev/peps/pep-0001/"><span class="icon">​</span>PEPs</a>,
<a class="ext-link" href="http://dep.debian.net/"><span class="icon">​</span>DEPs</a>,
<a class="ext-link" href="http://plone.org/documentation/glossary/plip"><span class="icon">​</span>PLIPs</a>, to name three).
</p>
<p>
Existing historic proposals exist, called CEPs.  The proposed system
is called CREP (CKAN revision or enhancement proposal) to disambiguate
it from the legacy proposals, and from the delicious fungus <em>Boletus
Edulis</em>.
</p>
<p>
Giving a formal structure to the proposal is useful as it gives the
community a means to identify a CREP that's not had sufficient thought
or discussion.  An informal email thread can easily be lost and
important questions (such as backwards compatibility) overlooked.  The
use of the proposed template empowers any community member to ask the
proposer to expand on rationale, deliverables, etc.
</p>
<p>
The structure chosen is somewhere between Debian's and Plone's.  It
aims to give a structure to the debate, a clear start at
documentation, and also prompt some thinking about implementation and
timescales.
</p>
<p>
All this policy about structure should not be construed as mandatory.  
In particular, the later fields in the CREP template regarding 
Implementation Plan may be omitted if the author doesn't find them 
helpful.
</p>
<p>
Some projects (e.g. Debian) keep their enhancement proposals in a
versioning repository; others (e.g. Plone) keep them in an issue
tracking system.  Trac is proposed for CKAN because we already use it
for small feature proposals and for team planning.  It seems unlikely
that change tracking on an individual CREP will be useful; a CREP that
changes sufficiently from its original form should probably be marked
"obselete" and a new CREP started.  Using an issue tracking system also
means we can easily track CREPs by state.
</p>
<h2 id="BackwardsCompatibility">Backwards Compatibility</h2>
<p>
Some [<a class="ext-link" href="https://bitbucket.org/okfn/ceps/src/76b274888bcf/cep/"><span class="icon">​</span>https://bitbucket.org/okfn/ceps/src/76b274888bcf/cep/</a> legacy 
enhancement proposals], called CEPs, have previously been started.
</p>
<p>
They are currently all marked as "active".  Any which require
discussion should be altered by the proposer to match the new CREP
specification and submitted to trac.  The original CEP should be
updated with a banner at the top pointing a reader to the new CREP.
</p>
<p>
Any that are now obselete should be clearly marked as such in a banner
at the top, pointing a reader to the trac for new CREPs.
</p>
<h2 id="Implementationplan">Implementation plan</h2>
<h3 id="Deliverables">Deliverables</h3>
<ul><li>This CREP, agreed
</li><li>Support for proposed statuses in Trac
</li><li>Canned reports for listing CREPs in Trac
</li></ul><h3 id="Risksandmitigations">Risks and mitigations</h3>
<ul><li>That this CREP is agreed, but rarely acted on.  This risk can be
mitigated by nominating a CREP champion in the community or core
team, whose job it is to say "where's the CREP for that?" and
generally own the quality of CREPS
</li></ul><h3 id="Participants">Participants</h3>
<p>
Seb Bacon: as current Documentation Czar (May 2011), responsible for 
ensuring CREPs are up to date.
</p>
<h3 id="Progress">Progress</h3>
<p>
This document is the entire proposal.
</p>

                            
                          </td>
                          <td class="PosixTime">1304601313000000
                          </td>
                          <td class="ModifiedTime">1305622850000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1092.html">#1092</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">kindly
                          </td>
                          <td class="reporter">kindly
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.4-sprint-6.html">ckan-v1.4-sprint-6</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1092.html">refactor logic layer to seperate out api, form logic</a>
                          </td>
                          <td class="description">
                            <p>
The logic layer is a bit too api centric. Make the reusable parts separate in preparation for the wui refactor.
</p>

                            
                          </td>
                          <td class="PosixTime">1302777929000000
                          </td>
                          <td class="ModifiedTime">1305570822000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1131.html">#1131</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">dread
                          </td>
                          <td class="reporter">dread
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.4-sprint-7.html">ckan-v1.4-sprint-7</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1131.html">Search param validation exception not caught</a>
                          </td>
                          <td class="description">
                            <p>
Example request:
</p>
<pre class="wiki">http://nl.ckan.net/api/2/search/package?q=delft&amp;order_by=&amp;offset=&amp;limit=&amp;tags=
</pre><p>
Gives 500 error:
</p>
<pre class="wiki">&lt;type 'exceptions.ValueError'&gt;: invalid literal for int() with base 10: ''
</pre>
                            
                          </td>
                          <td class="PosixTime">1304942023000000
                          </td>
                          <td class="ModifiedTime">1305537897000000
                          </td>
              </tr>
              <tr class="even">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1083.html">#1083</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">johnlawrenceaspden
                          </td>
                          <td class="reporter">johnlawrenceaspden
                          </td>
                          <td class="milestone">
                            <a title="View milestone" href="../milestone/ckan-v1.5-sprint-1.html">ckan-v1.5-sprint-1</a>
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1083.html">userobjectroles added twice can't be deleted</a>
                          </td>
                          <td class="description">
                            <p>
the add_user_to_role/remove_user_from_role functions are asymmetrical
in that the add function is happy to add the same role twice but the remove asserts that it's only in the table once and crashes if that's not true.
</p>
<p>
an attempt has been made to guard against this, but fails, I think because the add functions rely on the caller committing the change to the db.
</p>
<p>
same problem affects corresponding authorization_group functions
</p>
<p>
I'll try to sort this out. Making a note here.
</p>

                            
                          </td>
                          <td class="PosixTime">1302550660000000
                          </td>
                          <td class="ModifiedTime">1305537827000000
                          </td>
              </tr>
              <tr class="odd">
                          <td class="ticket">
                            <a title="View ticket" href="../ticket/1109.html">#1109</a>
                          </td>
                          <td class="type">defect
                          </td>
                          <td class="owner">kindly
                          </td>
                          <td class="reporter">kindly
                          </td>
                          <td class="milestone">
                          </td>
                          <td class="status">closed
                          </td>
                          <td class="resolution">fixed
                          </td>
                          <td class="summary">
                            <a title="View ticket" href="../ticket/1109.html">When extras has a value other than a string an integrity error occurs in the api.</a>
                          </td>
                          <td class="description">
                            <p>
This is a regression that happened after refactoring the api.
</p>
<p>
It was shown by 
</p>
<p>
<a class="ext-link" href="http://pastebin.com/2v7QasZy"><span class="icon">​</span>http://pastebin.com/2v7QasZy</a>
</p>

                            
                          </td>
                          <td class="PosixTime">1303839943000000
                          </td>
                          <td class="ModifiedTime">1305124697000000
                          </td>
              </tr>
          </tbody>
      </table>
      <div class="paging">
    <span class="previous">
      <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=16.html" title="Previous Page">←</a>
    </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=7.html" title="Page 7">7</a>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=8.html" title="Page 8">8</a>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=9.html" title="Page 9">9</a>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=10.html" title="Page 10">10</a>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=11.html" title="Page 11">11</a>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=12.html" title="Page 12">12</a>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=13.html" title="Page 13">13</a>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=14.html" title="Page 14">14</a>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=15.html" title="Page 15">15</a>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=16.html" title="Page 16">16</a>
      </span>
      <span>
        <span class="current">17</span>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=18.html" title="Page 18">18</a>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=19.html" title="Page 19">19</a>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=20.html" title="Page 20">20</a>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=21.html" title="Page 21">21</a>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=22.html" title="Page 22">22</a>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=23.html" title="Page 23">23</a>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=24.html" title="Page 24">24</a>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=25.html" title="Page 25">25</a>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=26.html" title="Page 26">26</a>
      </span>
      <span>
        <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=27.html" title="Page 27">27</a>
      </span>
    <span class="next">
      <a href="22%3Fsort=ModifiedTime&amp;asc=0&amp;page=18.html" title="Next Page">→</a>
    </span>
</div>
      <div id="help"><strong>Note:</strong>
        See <a href="../wiki/TracReports.html">TracReports</a> for help on using and creating reports.</div>
    </div>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="first">
          <a rel="nofollow" href="22%3Fsort=ModifiedTime&amp;asc=0&amp;format=rss" class="rss">RSS Feed</a>
        </li><li>
          <a rel="nofollow" href="22%3Fsort=ModifiedTime&amp;asc=0&amp;format=csv">Comma-delimited Text</a>
        </li><li>
          <a rel="nofollow" href="22%3Fsort=ModifiedTime&amp;asc=0&amp;format=tab">Tab-delimited Text</a>
        </li><li class="last">
          <a rel="nofollow" href="../report%3Fid=22&amp;format=sql">SQL Query</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="../chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Powered by <a href="../about.html"><strong>Trac 0.12.3</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right">Visit the Trac open source project at<br /><a href="http://trac.edgewall.org/">http://trac.edgewall.org/</a></p>
    </div>
  </body>
</html>