<?xml version="1.0"?>
<rss xmlns:dc="http://purl.org/dc/elements/1.1/" version="2.0">
  <channel>
    <title>CKAN: Ticket #1217: Diff exception</title>
    <link>http://localhost/ticket/1217</link>
    <description>&lt;p&gt;
Exception raised doing this particular diff.
&lt;/p&gt;
&lt;p&gt;
&lt;a class="ext-link" href="http://ckan.net/revision/diff/sudocfr?diff_entity=package&amp;amp;oldid=a18b2520-09e0-44be-80dd-4fea94ffe7d1&amp;amp;diff=3934ff16-a3a7-4481-b390-72944903b945"&gt;&lt;span class="icon"&gt;â€‹&lt;/span&gt;http://ckan.net/revision/diff/sudocfr?diff_entity=package&amp;amp;oldid=a18b2520-09e0-44be-80dd-4fea94ffe7d1&amp;amp;diff=3934ff16-a3a7-4481-b390-72944903b945&lt;/a&gt;
&lt;/p&gt;
&lt;pre class="wiki"&gt;...
Module ckan.controllers.revision:142 in diff
&amp;lt;&amp;lt;          if c.diff_entity == 'package':
                   c.pkg = model.Package.by_name(id)
                   diff = c.pkg.diff(c.revision_to, c.revision_from)
               elif c.diff_entity == 'group':
                   c.group = model.Group.by_name(id)
&amp;gt;&amp;gt;  diff = c.pkg.diff(c.revision_to, c.revision_from)
Module ckan.model.package:449 in diff
&amp;lt;&amp;lt;                              display_id = to_obj_rev.tag.name
                               elif obj_class.__name__ == 'PackageExtra':
                                   display_id = to_obj_rev.key
                               else:
                                   display_id = related_obj_id[:4]
&amp;gt;&amp;gt;  display_id = to_obj_rev.key
AttributeError: 'NoneType' object has no attribute 'key'
&lt;/pre&gt;&lt;p&gt;
Seems to be to do with this particular extra key:
&lt;/p&gt;
&lt;pre class="wiki"&gt;[&amp;lt;PackageExtraRevision id=ba1f3b3e-f61f-4924-bae0-ec3dd2163ae4 package_id=febe4da9-5874-4411-a7da-b497fdebf739 key=namespace value=http://www.sudoc.fr/ state=active revision_id=5ec8e730-c73d-4f1c-989b-2e015eb3d315 continuity_id=ba1f3b3e-f61f-4924-bae0-ec3dd2163ae4 expired_id=None revision_timestamp=2011-07-08 13:48:11.027260 expired_timestamp=9999-12-31 00:00:00 current=True&amp;gt;]
&lt;/pre&gt;&lt;p&gt;
Is it because it was created between the from_revision and to_revision?
&lt;/p&gt;
</description>
    <language>en-us</language>
    <image>
      <title>CKAN</title>
      <url>http://assets.okfn.org/p/ckan/img/ckan_logo_shortname.png</url>
      <link>http://localhost/ticket/1217</link>
    </image>
    <generator>Trac 0.12.3</generator>
    <item>
      
        <dc:creator>dread</dc:creator>

      <pubDate>Mon, 07 Nov 2011 10:54:37 GMT</pubDate>
      <title>status changed; resolution set</title>
      <link>http://localhost/ticket/1217#comment:1</link>
      <guid isPermaLink="false">http://localhost/ticket/1217#comment:1</guid>
      <description>
          &lt;ul&gt;
            &lt;li&gt;&lt;strong&gt;status&lt;/strong&gt;
                changed from &lt;em&gt;new&lt;/em&gt; to &lt;em&gt;closed&lt;/em&gt;
            &lt;/li&gt;
            &lt;li&gt;&lt;strong&gt;resolution&lt;/strong&gt;
                set to &lt;em&gt;invalid&lt;/em&gt;
            &lt;/li&gt;
          &lt;/ul&gt;
        &lt;p&gt;
I haven't seen this for a while - could have been due to database corruption which has been fixed.
&lt;/p&gt;
      </description>
      <category>Ticket</category>
    </item>
 </channel>
</rss>