<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  


  <head>
    <title>
      Ticket Diff – CKAN
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <!--[if IE]><script type="text/javascript">window.location.hash = window.location.hash;</script><![endif]-->
        <link rel="search" href="../search.html" />
        <link rel="help" href="../wiki/TracGuide.html" />
        <link rel="up" href="2732%3Faction=history&amp;version=1.html" title="Ticket History" />
        <link rel="next" href="2732%3Faction=diff&amp;version=2.html" title="Version 2" />
        <link rel="start" href="../wiki.1.html" />
        <link rel="stylesheet" href="../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../chrome/common/css/diff.css" type="text/css" />
        <link rel="shortcut icon" href="../chrome/common/trac.ico" type="image/x-icon" />
        <link rel="icon" href="../chrome/common/trac.ico" type="image/x-icon" />
      <link type="application/opensearchdescription+xml" rel="search" href="../search/opensearch" title="Search CKAN" />
    <script type="text/javascript" src="../chrome/common/js/jquery.js"></script><script type="text/javascript" src="../chrome/common/js/babel.js"></script><script type="text/javascript" src="../chrome/common/js/messages/en_US.js"></script><script type="text/javascript" src="../chrome/common/js/trac.js"></script><script type="text/javascript" src="../chrome/common/js/search.js"></script><script type="text/javascript" src="../chrome/common/js/diff.js"></script>
    <!--[if lt IE 7]>
    <script type="text/javascript" src="/chrome/common/js/ie_pre7_hacks.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="../chrome/common/css/diff.css" />
    <meta name="ROBOTS" content="NOINDEX, NOFOLLOW" />
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="http://ckan.org/"><img src="http://assets.okfn.org/p/ckan/img/ckan_logo_shortname.png" alt="CKAN Trac" height="70" /></a>
      </div>
      <form id="search" action="../search.html" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Search" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="../login.html">Login</a></li><li><a href="../prefs.html">Preferences</a></li><li><a href="../wiki/TracGuide.html">Help/Guide</a></li><li><a href="../about.html">About Trac</a></li><li class="last"><a href="../register.html">Register</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first"><a href="../timeline.html">Timeline</a></li><li><a href="../roadmap.html">Roadmap</a></li><li class="active"><a href="../report.html">View Tickets</a></li><li><a href="../search.html">Search</a></li><li class="last"><a href="../wiki.1.html">Wiki</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
          <ul>
              <li class="first"><span class="missing">&larr; Previous Change</span></li><li><a href="2732%3Faction=history&amp;version=1.html" title="Ticket History">Ticket History</a></li><li class="last"><span><a class="next" href="2732%3Faction=diff&amp;version=2.html" title="Version 2">Next Change</a> &rarr;</span></li>
          </ul>
        <hr />
      </div>
    <div id="content" class="ticket">
      <h1>
        Changes between
          <a href="2732%3Fversion=0.html">Initial Version</a> and
          <a href="2732%3Fversion=1.html">Version 1</a> of
          <a href="2732%3Fversion=1.html">Ticket #2732</a>
      </h1>
      <form method="post" id="prefs" action="2732%3Fversion=1.html"><div><input type="hidden" name="__FORM_TOKEN" value="93d81ccf9a7bb1c456462f62" /></div>
        <div>
          <input type="hidden" name="action" value="diff" />
          <input type="hidden" name="version" value="1" />
          <input type="hidden" name="old_version" value="0" />
          
  <label for="style">View differences</label>
  <select id="style" name="style">
    <option selected="selected" value="inline">inline</option>
    <option value="sidebyside">side by side</option>
  </select>
  <div class="field">
    <label><input type="radio" name="contextall" value="0" checked="checked" />
             Show</label>
      <label><input type="text" name="contextlines" id="contextlines" size="2" maxlength="3" value="2" />
             lines around each change</label><br />
    <label><input type="radio" name="contextall" value="1" />
           Show the changes in full context</label>
  </div>
  <fieldset id="ignore">
    <legend>Ignore:</legend>
    <div class="field">
      <input type="checkbox" id="ignoreblanklines" name="ignoreblanklines" />
      <label for="ignoreblanklines">Blank lines</label>
    </div>
    <div class="field">
      <input type="checkbox" id="ignorecase" name="ignorecase" />
      <label for="ignorecase">Case changes</label>
    </div>
    <div class="field">
      <input type="checkbox" id="ignorewhitespace" name="ignorewhitespace" />
      <label for="ignorewhitespace">White space changes</label>
    </div>
  </fieldset>
  <div class="buttons">
    <input type="submit" name="update" value="Update" />
  </div>

        </div>
      </form>
      <dl id="overview">
        <dt class="property time">Timestamp:</dt>
        <dd class="time">
            07/24/12 08:59:02 (<a class="timeline" href="../timeline%3Ffrom=2012-07-24T08:59:02Z&amp;precision=second.html" title="2012-07-24T08:59:02Z in Timeline">22 months</a> ago)
        </dd>
        <dt class="property author">Author:</dt>
        <dd class="author">
          ross
        </dd>
        <dt class="property message">Comment:</dt>
        <dd class="message">
          
          
        </dd>
      </dl>
      <div class="diff">
        <div class="legend" id="diff-legend">
          <h3>Legend:</h3>
          <dl>
            <dt class="unmod"></dt><dd>Unmodified</dd>
            <dt class="add"></dt><dd>Added</dd>
            <dt class="rem"></dt><dd>Removed</dd>
            <dt class="mod"></dt><dd>Modified</dd>
          </dl>
        </div>
        <div class="diff">
  <ul class="entries">
      <li class="entry">
        <h2 id="file1">
          <a href="2732%3Fversion=1.html">Ticket #2732 &ndash; Description</a>
        </h2>
        <table class="trac-diff inline" summary="Differences" cellspacing="0">
              <colgroup><col class="lineno" /><col class="lineno" /><col class="content" /></colgroup>
              <thead>
                <tr>
                  <th title=" Initial Version">
                    <a href="2732%3Fversion=0.html#L1">
                      initial</a>
                  </th>
                  <th title=" Version 1">
                    <a href="2732%3Fversion=1.html#L1">
                      v1</a>
                  </th>
                  <td> </td>
                </tr>
              </thead>
            <tbody class="unmod">
                  <tr>
                          <th>1</th><th>1</th><td class="l"><span>We should simplify upload and storage of files, initially only to local storage with archiver eventually being fixed to archive data externally. WIP pad is http://ckan.okfnpad.org/uploads&nbsp; </span> </td>
                  </tr>
            </tbody><tbody class="add">
                  <tr class="first">
                          <th> </th><th>2</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>3</th><td class="r"><ins>_Simplifying uploads_</ins> </td>
                  </tr><tr>
                          <th> </th><th>4</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>5</th><td class="r"><ins>Currently uploads are too painful/difficult/fiddly to use and/or configure.&nbsp; We want to simplify uploads so that they are done directly to the CKAN server, without support for remote services (S3 etc) and/or the dependencies it introduces.</ins> </td>
                  </tr><tr>
                          <th> </th><th>6</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>7</th><td class="r"><ins>We want to fix:</ins> </td>
                  </tr><tr>
                          <th> </th><th>8</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>9</th><td class="r"><ins>&nbsp;* File uploads themselves</ins> </td>
                  </tr><tr>
                          <th> </th><th>10</th><td class="r"><ins>&nbsp;* Storage of uploaded files</ins> </td>
                  </tr><tr>
                          <th> </th><th>11</th><td class="r"><ins>&nbsp;* Notification of the upload to other components</ins> </td>
                  </tr><tr>
                          <th> </th><th>12</th><td class="r"><ins>&nbsp;</ins> </td>
                  </tr><tr>
                          <th> </th><th>13</th><td class="r"><ins>&nbsp;</ins> </td>
                  </tr><tr>
                          <th> </th><th>14</th><td class="r"><ins>_File uploads_</ins> </td>
                  </tr><tr>
                          <th> </th><th>15</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>16</th><td class="r"><ins>Things file upload should do:</ins> </td>
                  </tr><tr>
                          <th> </th><th>17</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>18</th><td class="r"><ins>&nbsp;* Allow sysadmin to disable</ins> </td>
                  </tr><tr>
                          <th> </th><th>19</th><td class="r"><ins>&nbsp;* Allow auth'ed users to upload</ins> </td>
                  </tr><tr>
                          <th> </th><th>20</th><td class="r"><ins>&nbsp;* Store whatever they send on disk, and store DB entry linking the file to the person</ins> </td>
                  </tr><tr>
                          <th> </th><th>21</th><td class="r"><ins>&nbsp;* When creating the resource, the user should be able to choose from all of the files</ins> </td>
                  </tr><tr>
                          <th> </th><th>22</th><td class="r"><ins>&nbsp; &nbsp;they have uploaded but not yet associated with a resource. This will allow for bulk</ins> </td>
                  </tr><tr>
                          <th> </th><th>23</th><td class="r"><ins>&nbsp; &nbsp;upload and then a delayed association.&nbsp; Whenver a user creates a resource they</ins> </td>
                  </tr><tr>
                          <th> </th><th>24</th><td class="r"><ins>&nbsp; &nbsp;either upload a file now, or see previously uploaded files.</ins> </td>
                  </tr><tr>
                          <th> </th><th>25</th><td class="r"><ins>&nbsp; &nbsp;</ins> </td>
                  </tr><tr>
                          <th> </th><th>26</th><td class="r"><ins>? Can we do the upload asynchronously and then associated uploaded key with the</ins> </td>
                  </tr><tr>
                          <th> </th><th>27</th><td class="r"><ins>&nbsp; &nbsp;resource before the save ? What happens if the user tries to submit before asymc upload finishes ? Should we delay them?</ins> </td>
                  </tr><tr>
                          <th> </th><th>28</th><td class="r"><ins>&nbsp; &nbsp;</ins> </td>
                  </tr><tr>
                          <th> </th><th>29</th><td class="r"><ins>&nbsp; &nbsp;</ins> </td>
                  </tr><tr>
                          <th> </th><th>30</th><td class="r"><ins>_File storage_</ins> </td>
                  </tr><tr>
                          <th> </th><th>31</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>32</th><td class="r"><ins>File storage should be local to the CKAN install, and not a remote service.&nbsp; Any archiving to remove storage providers should be outside of the main request.</ins> </td>
                  </tr><tr>
                          <th> </th><th>33</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>34</th><td class="r"><ins>File storage should:</ins> </td>
                  </tr><tr>
                          <th> </th><th>35</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>36</th><td class="r"><ins>&nbsp;* allow moving data, a sysadmin should be able to move the storage root and change configuration and&nbsp; have the system continue running (i.e. don't store absolute paths).</ins> </td>
                  </tr><tr>
                          <th> </th><th>37</th><td class="r"><ins>&nbsp;* provide maintainability, it should be easy to determine which old files are not associated with resources&nbsp; and thus can be cleaned up.</ins> </td>
                  </tr><tr>
                          <th> </th><th>38</th><td class="r"><ins>&nbsp;* allow for collection of information (i.e. estimate of storate space used)</ins> </td>
                  </tr><tr>
                          <th> </th><th>39</th><td class="r"><ins>&nbsp;* check whether there is enough space and handling the conequences cleanly</ins> </td>
                  </tr><tr>
                          <th> </th><th>40</th><td class="r"><ins>&nbsp;* ensure files to be written only underneath its own root folder, checks should be made after any path generation that the file begins with the location of the file storage.</ins> </td>
                  </tr><tr>
                          <th> </th><th>41</th><td class="r"><ins>&nbsp;* Have a configurable maximum accepted blob size during upload.</ins> </td>
                  </tr><tr>
                          <th> </th><th>42</th><td class="r"><ins>&nbsp;* Should store what meta-data was provided with the upload, such as mimetype.</ins> </td>
                  </tr><tr>
                          <th> </th><th>43</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>44</th><td class="r"><ins>Somewhere in the DB we should store ...</ins> </td>
                  </tr><tr>
                          <th> </th><th>45</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>46</th><td class="r"><ins>|Column|Notes|</ins> </td>
                  </tr><tr>
                          <th> </th><th>47</th><td class="r"><ins>|id|An identifier|</ins> </td>
                  </tr><tr>
                          <th> </th><th>48</th><td class="r"><ins>|owner|The owning user, who uploaded the file|</ins> </td>
                  </tr><tr>
                          <th> </th><th>49</th><td class="r"><ins>|path|The path (from the 'storage root') to the file|</ins> </td>
                  </tr><tr>
                          <th> </th><th>50</th><td class="r"><ins>|size|The size in bytes of the file on disk|</ins> </td>
                  </tr><tr>
                          <th> </th><th>51</th><td class="r"><ins>|mimetype|The mimetype of the file, as provided by the uploader|</ins> </td>
                  </tr><tr>
                          <th> </th><th>52</th><td class="r"><ins>|upload_date|When the data was uploaded|</ins> </td>
                  </tr><tr>
                          <th> </th><th>53</th><td class="r"><ins>|resource|The ID of the resource it belongs to. A unidirectional relationship.|</ins> </td>
                  </tr><tr>
                          <th> </th><th>54</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>55</th><td class="r"><ins>Generating paths should try and separate the files, perhaps based on username of the owner, or some other mechanism to avoid a single folder full of files.</ins> </td>
                  </tr><tr>
                          <th> </th><th>56</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>57</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>58</th><td class="r"><ins>_Notifications_</ins> </td>
                  </tr><tr>
                          <th> </th><th>59</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>60</th><td class="r"><ins>We need to make sure that it is possible to notify other components within the system that an upload has taken place, or at least make it easy for them to be notified.&nbsp; The primary use case for this is to notify the component that will translate/upload certain formats to the data store.</ins> </td>
                  </tr><tr>
                          <th> </th><th>61</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>62</th><td class="r"><ins>We could do this based on the post-upload update to the file model (i.e. when we record the total received size of the file).</ins> </td>
                  </tr><tr>
                          <th> </th><th>63</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>64</th><td class="r"><ins></ins> </td>
                  </tr><tr class="last">
                          <th> </th><th>65</th><td class="r"><ins></ins> </td>
                  </tr>
            </tbody>
        </table>
      </li>
  </ul>
</div>
      </div>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="../chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Powered by <a href="../about.html"><strong>Trac 0.12.3</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right">Visit the Trac open source project at<br /><a href="http://trac.edgewall.org/">http://trac.edgewall.org/</a></p>
    </div>
  </body>
</html>