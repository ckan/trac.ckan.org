<?xml version="1.0"?>
<rss xmlns:dc="http://purl.org/dc/elements/1.1/" version="2.0">
  <channel>
    <title>CKAN: Ticket #940: OpenID login via google for same user generates 2 different openid urls</title>
    <link>http://localhost/ticket/940</link>
    <description>&lt;p&gt;
This has been noted twice in the last couple of weeks.
&lt;/p&gt;
&lt;p&gt;
Checking around my guess is this is due to someone logging in to www.ckan.net and ckan.net. Google generates openid based on the RP (requesting party) which is the requesting domain url unless the openid.realm is set. See:
&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;&lt;a class="ext-link" href="http://groups.google.com/group/google-federated-login-api/web/the-most-important-technical-issue-in-using-the-google-accounts-api?pli=1"&gt;&lt;span class="icon"&gt;​&lt;/span&gt;http://groups.google.com/group/google-federated-login-api/web/the-most-important-technical-issue-in-using-the-google-accounts-api?pli=1&lt;/a&gt;
&lt;/li&gt;&lt;li&gt;&lt;a class="ext-link" href="http://stackoverflow.com/questions/3549953/how-to-get-unique-identifier-from-openid-google"&gt;&lt;span class="icon"&gt;​&lt;/span&gt;http://stackoverflow.com/questions/3549953/how-to-get-unique-identifier-from-openid-google&lt;/a&gt;
&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;
To fix this we should set the openid.realm (not sure how atm).
&lt;/p&gt;
&lt;p&gt;
If this is not possible an alternative is to make sure we redirect all users to a single site url (perhaps using ckan config option site_url, or doing this in apache).
&lt;/p&gt;
&lt;p&gt;
Cost: 1h
&lt;/p&gt;
</description>
    <language>en-us</language>
    <image>
      <title>CKAN</title>
      <url>http://assets.okfn.org/p/ckan/img/ckan_logo_shortname.png</url>
      <link>http://localhost/ticket/940</link>
    </image>
    <generator>Trac 0.12.3</generator>
    <item>
      
        <dc:creator>pudo</dc:creator>

      <pubDate>Wed, 02 Feb 2011 14:20:33 GMT</pubDate>
      <title>status changed</title>
      <link>http://localhost/ticket/940#comment:1</link>
      <guid isPermaLink="false">http://localhost/ticket/940#comment:1</guid>
      <description>
          &lt;ul&gt;
            &lt;li&gt;&lt;strong&gt;status&lt;/strong&gt;
                changed from &lt;em&gt;new&lt;/em&gt; to &lt;em&gt;assigned&lt;/em&gt;
            &lt;/li&gt;
          &lt;/ul&gt;
        &lt;p&gt;
It seems like even with openid.realm set we could only create two "zones": *.ckan.net and ckan.net. We do not want *.ckan.net because it interferes with ccCKANs.
&lt;/p&gt;
&lt;p&gt;
My vote for the moment would be to 303 www.ckan.net to ckan.net.
&lt;/p&gt;
      </description>
      <category>Ticket</category>
    </item><item>
      
        <dc:creator>rgrp</dc:creator>

      <pubDate>Fri, 04 Feb 2011 08:21:39 GMT</pubDate>
      <title></title>
      <link>http://localhost/ticket/940#comment:2</link>
      <guid isPermaLink="false">http://localhost/ticket/940#comment:2</guid>
      <description>
        &lt;p&gt;
I agree with pudo (though it would not be the end of the world if these were treated as the same realm!). I've now created a permanent redirect for www.ckan.net to ckan.net.
&lt;/p&gt;
&lt;pre class="wiki"&gt;    RewriteEngine on
    RewriteCond %{HTTP_HOST} ^www\.ckan\.net$ [NC]
    RewriteRule ^(.*)$ http://ckan.net$1 [R=301,L]
&lt;/pre&gt;
      </description>
      <category>Ticket</category>
    </item><item>
      
        <dc:creator>rgrp</dc:creator>

      <pubDate>Mon, 07 Feb 2011 09:42:28 GMT</pubDate>
      <title>status changed; resolution set</title>
      <link>http://localhost/ticket/940#comment:3</link>
      <guid isPermaLink="false">http://localhost/ticket/940#comment:3</guid>
      <description>
          &lt;ul&gt;
            &lt;li&gt;&lt;strong&gt;status&lt;/strong&gt;
                changed from &lt;em&gt;assigned&lt;/em&gt; to &lt;em&gt;closed&lt;/em&gt;
            &lt;/li&gt;
            &lt;li&gt;&lt;strong&gt;resolution&lt;/strong&gt;
                set to &lt;em&gt;wontfix&lt;/em&gt;
            &lt;/li&gt;
          &lt;/ul&gt;
        &lt;p&gt;
Listing as wontfix now since:
&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;Have workaround
&lt;/li&gt;&lt;li&gt;Better for most sites to converge on a single domain anyway (for SEO etc) -- via std redirect approach or otherwise
&lt;/li&gt;&lt;li&gt;Seems problematic to fix this via openid realm
&lt;/li&gt;&lt;/ol&gt;
      </description>
      <category>Ticket</category>
    </item>
 </channel>
</rss>