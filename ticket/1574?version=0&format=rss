<?xml version="1.0"?>
<rss xmlns:dc="http://purl.org/dc/elements/1.1/" version="2.0">
  <channel>
    <title>CKAN: Ticket #1574: [super] Storage changes</title>
    <link>http://localhost/ticket/1574</link>
    <description>&lt;p&gt;
It would be great to allow uploading of files to push the data into webstore.  Initially we were going to suggest changes to ckanext-storage but after further analysis we arrived at the conclusion that this should be implemented by ckanext-archiver as it already handles archiving of data from various sources and would be the best place to 'archive' to webstore.
&lt;/p&gt;
&lt;ol&gt;&lt;li&gt;A user wants to upload a file to CKAN, and so chooses the file upload option as they do currently with ckanext-storage.
&lt;/li&gt;&lt;/ol&gt;&lt;ol start="2"&gt;&lt;li&gt;The file upload is performed by ckanext-storage to whichever data sink was configured.
&lt;/li&gt;&lt;/ol&gt;&lt;ol start="3"&gt;&lt;li&gt;The user is provided the link to the file as they are currently, except the link is to a short-link, a la bit.ly, which resolves to the file itself. [Note: this may not be necessary, we may be able to manage this with resource properties]
&lt;/li&gt;&lt;/ol&gt;&lt;ol start="4"&gt;&lt;li&gt;A configurable celery task checks the uploaded content and decides what to do with the file based on the mime-type or the file size, or a combination of the two.  In some cases this will send the file up to  webstore from wherever it was uploaded to.
&lt;/li&gt;&lt;/ol&gt;&lt;ol start="5"&gt;&lt;li&gt;The short link code [or resource]  is updated to point to the new location (e.g. changed  from &lt;a class="ext-link" href="http://ckaninstance/"&gt;&lt;span class="icon"&gt;​&lt;/span&gt;http://ckaninstance/&lt;/a&gt; to &lt;a class="ext-link" href="http://webstoreinstance/"&gt;&lt;span class="icon"&gt;​&lt;/span&gt;http://webstoreinstance/&lt;/a&gt;) so that future requests will go to the correct location.
&lt;/li&gt;&lt;/ol&gt;&lt;ol start="6"&gt;&lt;li&gt;After each file has been processed, the archiver will determine whether the file is deleted, kept or moved to an archive [Do we need to make sure some tasks only happen in sequence?]
&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;
This would require some change to the webstore to have it interoperate more cleanly with CKAN - Username handling should be modified to allow use of IDs rather than  trying to mangle CKAN usernames that don't fit the current scheme, and we need to change to using the API rather than the DB directly (see &lt;a class="assigned ticket" href="http://localhost/ticket/1550" title="enhancement: Allow simple auth via the API (assigned)"&gt;#1550&lt;/a&gt;)
&lt;/p&gt;
&lt;p&gt;
A new celery task would be necessary in ckanext-archiver although it would beat some resemblance to ckanext-webstorer.
&lt;/p&gt;
&lt;p&gt;
&lt;/p&gt;
</description>
    <language>en-us</language>
    <image>
      <title>CKAN</title>
      <url>http://assets.okfn.org/p/ckan/img/ckan_logo_shortname.png</url>
      <link>http://localhost/ticket/1574</link>
    </image>
    <generator>Trac 0.12.3</generator>
    <item>
      
        <dc:creator>ross</dc:creator>

      <pubDate>Tue, 03 Jan 2012 09:18:18 GMT</pubDate>
      <title></title>
      <link>http://localhost/ticket/1574#comment:1</link>
      <guid isPermaLink="false">http://localhost/ticket/1574#comment:1</guid>
      <description>
        &lt;p&gt;
Related:
&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;
&lt;a class="closed ticket" href="http://localhost/ticket/1608" title="enhancement: Merge storage into Core (closed: fixed)"&gt;#1608&lt;/a&gt; Merge storage into Core
&lt;a class="closed ticket" href="http://localhost/ticket/1609" title="enhancement: Celery task for ckanext-archiver to write to webstore. (closed: fixed)"&gt;#1609&lt;/a&gt; Celery task for ckanext-archiver to write to webstore.
&lt;/p&gt;
&lt;/blockquote&gt;
      </description>
      <category>Ticket</category>
    </item><item>
      
        <dc:creator>ross</dc:creator>

      <pubDate>Tue, 03 Jan 2012 11:30:11 GMT</pubDate>
      <title></title>
      <link>http://localhost/ticket/1574#comment:2</link>
      <guid isPermaLink="false">http://localhost/ticket/1574#comment:2</guid>
      <description>
        &lt;p&gt;
Added &lt;a class="closed ticket" href="http://localhost/ticket/1611" title="enhancement: Implement auth API calls for webstore/external use (closed: duplicate)"&gt;#1611&lt;/a&gt; as relevant to webstore integration
&lt;/p&gt;
      </description>
      <category>Ticket</category>
    </item><item>
      
        <dc:creator>rgrp</dc:creator>

      <pubDate>Thu, 05 Jan 2012 14:38:56 GMT</pubDate>
      <title></title>
      <link>http://localhost/ticket/1574#comment:3</link>
      <guid isPermaLink="false">http://localhost/ticket/1574#comment:3</guid>
      <description>
        &lt;p&gt;
@ross: Is it possible to update the detailed description of this ticket so it reflects current reality (whatever that is ;-) ) (BTW: you can edit the main descript of the ticket by scrolling to the bottom of this ticket edit page)
&lt;/p&gt;
      </description>
      <category>Ticket</category>
    </item><item>
      
        <dc:creator>ross</dc:creator>

      <pubDate>Fri, 06 Jan 2012 10:52:44 GMT</pubDate>
      <title>description changed</title>
      <link>http://localhost/ticket/1574#comment:4</link>
      <guid isPermaLink="false">http://localhost/ticket/1574#comment:4</guid>
      <description>
          &lt;ul&gt;
            &lt;li&gt;&lt;strong&gt;description&lt;/strong&gt;
              modified (&lt;a href="/ticket/1574?action=diff&amp;amp;version=4"&gt;diff&lt;/a&gt;)
            &lt;/li&gt;
          &lt;/ul&gt;
        &lt;p&gt;
Updated description.
&lt;/p&gt;
      </description>
      <category>Ticket</category>
    </item><item>
      
        <dc:creator>ross</dc:creator>

      <pubDate>Fri, 06 Jan 2012 10:53:50 GMT</pubDate>
      <title>description changed</title>
      <link>http://localhost/ticket/1574#comment:5</link>
      <guid isPermaLink="false">http://localhost/ticket/1574#comment:5</guid>
      <description>
          &lt;ul&gt;
            &lt;li&gt;&lt;strong&gt;description&lt;/strong&gt;
              modified (&lt;a href="/ticket/1574?action=diff&amp;amp;version=5"&gt;diff&lt;/a&gt;)
            &lt;/li&gt;
          &lt;/ul&gt;
        &lt;p&gt;
&lt;span class="underline"&gt;Some issues to be addressed&lt;/span&gt;
&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;What about existing content stored on google/s3?
&lt;/li&gt;&lt;li&gt;Metadata for OFS should use username/userid?
If user changes username we could just change the pairtree metadata json file, it should not be automated or easy for
users to change username though.
&lt;/li&gt;&lt;li&gt;OFS Metadata should contain the form data from CKAN upload
&lt;/li&gt;&lt;li&gt;Remove _owner from OFS metadata (unnecessary)
&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;
&lt;span class="underline"&gt;Some issues to still consider&lt;/span&gt;
&lt;/p&gt;
&lt;ul&gt;&lt;li&gt;Allow .sqlite upload?
&lt;/li&gt;&lt;li&gt;Allow .sql upload?
&lt;/li&gt;&lt;/ul&gt;
      </description>
      <category>Ticket</category>
    </item><item>
      
        <dc:creator>ross</dc:creator>

      <pubDate>Mon, 09 Jan 2012 12:09:09 GMT</pubDate>
      <title>status changed; owner set</title>
      <link>http://localhost/ticket/1574#comment:6</link>
      <guid isPermaLink="false">http://localhost/ticket/1574#comment:6</guid>
      <description>
          &lt;ul&gt;
            &lt;li&gt;&lt;strong&gt;owner&lt;/strong&gt;
              set to &lt;em&gt;ross&lt;/em&gt;
            &lt;/li&gt;
            &lt;li&gt;&lt;strong&gt;status&lt;/strong&gt;
                changed from &lt;em&gt;new&lt;/em&gt; to &lt;em&gt;assigned&lt;/em&gt;
            &lt;/li&gt;
          &lt;/ul&gt;
      </description>
      <category>Ticket</category>
    </item><item>
      
        <dc:creator>kindly</dc:creator>

      <pubDate>Thu, 12 Jan 2012 18:26:23 GMT</pubDate>
      <title>milestone changed</title>
      <link>http://localhost/ticket/1574#comment:7</link>
      <guid isPermaLink="false">http://localhost/ticket/1574#comment:7</guid>
      <description>
          &lt;ul&gt;
            &lt;li&gt;&lt;strong&gt;milestone&lt;/strong&gt;
                changed from &lt;em&gt;ckan-backlog&lt;/em&gt; to &lt;em&gt;ckan-v1.6&lt;/em&gt;
            &lt;/li&gt;
          &lt;/ul&gt;
      </description>
      <category>Ticket</category>
    </item><item>
      
        <dc:creator>rgrp</dc:creator>

      <pubDate>Wed, 18 Jan 2012 16:38:03 GMT</pubDate>
      <title>description changed</title>
      <link>http://localhost/ticket/1574#comment:8</link>
      <guid isPermaLink="false">http://localhost/ticket/1574#comment:8</guid>
      <description>
          &lt;ul&gt;
            &lt;li&gt;&lt;strong&gt;description&lt;/strong&gt;
              modified (&lt;a href="/ticket/1574?action=diff&amp;amp;version=8"&gt;diff&lt;/a&gt;)
            &lt;/li&gt;
          &lt;/ul&gt;
      </description>
      <category>Ticket</category>
    </item><item>
      
        <dc:creator>ross</dc:creator>

      <pubDate>Wed, 18 Jan 2012 16:42:45 GMT</pubDate>
      <title>description changed</title>
      <link>http://localhost/ticket/1574#comment:9</link>
      <guid isPermaLink="false">http://localhost/ticket/1574#comment:9</guid>
      <description>
          &lt;ul&gt;
            &lt;li&gt;&lt;strong&gt;description&lt;/strong&gt;
              modified (&lt;a href="/ticket/1574?action=diff&amp;amp;version=9"&gt;diff&lt;/a&gt;)
            &lt;/li&gt;
          &lt;/ul&gt;
        &lt;p&gt;
Added related ticket &lt;a class="closed ticket" href="http://localhost/ticket/1681" title="enhancement: Core storage document (closed: fixed)"&gt;#1681&lt;/a&gt; for documentation/announce to be done asap.
&lt;/p&gt;
      </description>
      <category>Ticket</category>
    </item><item>
      
        <dc:creator>rgrp</dc:creator>

      <pubDate>Wed, 18 Jan 2012 16:53:42 GMT</pubDate>
      <title>description changed</title>
      <link>http://localhost/ticket/1574#comment:10</link>
      <guid isPermaLink="false">http://localhost/ticket/1574#comment:10</guid>
      <description>
          &lt;ul&gt;
            &lt;li&gt;&lt;strong&gt;description&lt;/strong&gt;
              modified (&lt;a href="/ticket/1574?action=diff&amp;amp;version=10"&gt;diff&lt;/a&gt;)
            &lt;/li&gt;
          &lt;/ul&gt;
      </description>
      <category>Ticket</category>
    </item><item>
      
        <dc:creator>ross</dc:creator>

      <pubDate>Fri, 20 Jan 2012 10:56:51 GMT</pubDate>
      <title>description changed</title>
      <link>http://localhost/ticket/1574#comment:11</link>
      <guid isPermaLink="false">http://localhost/ticket/1574#comment:11</guid>
      <description>
          &lt;ul&gt;
            &lt;li&gt;&lt;strong&gt;description&lt;/strong&gt;
              modified (&lt;a href="/ticket/1574?action=diff&amp;amp;version=11"&gt;diff&lt;/a&gt;)
            &lt;/li&gt;
          &lt;/ul&gt;
      </description>
      <category>Ticket</category>
    </item><item>
      
        <dc:creator>rgrp</dc:creator>

      <pubDate>Wed, 15 Feb 2012 20:45:33 GMT</pubDate>
      <title>summary changed</title>
      <link>http://localhost/ticket/1574#comment:12</link>
      <guid isPermaLink="false">http://localhost/ticket/1574#comment:12</guid>
      <description>
          &lt;ul&gt;
            &lt;li&gt;&lt;strong&gt;summary&lt;/strong&gt;
                changed from &lt;em&gt;[super] Storage changes&lt;/em&gt; to &lt;em&gt;[super] Storage changes including automated save to Webstore&lt;/em&gt;
            &lt;/li&gt;
          &lt;/ul&gt;
      </description>
      <category>Ticket</category>
    </item><item>
      
        <dc:creator>ross</dc:creator>

      <pubDate>Mon, 28 May 2012 11:02:35 GMT</pubDate>
      <title>status changed; resolution set</title>
      <link>http://localhost/ticket/1574#comment:13</link>
      <guid isPermaLink="false">http://localhost/ticket/1574#comment:13</guid>
      <description>
          &lt;ul&gt;
            &lt;li&gt;&lt;strong&gt;status&lt;/strong&gt;
                changed from &lt;em&gt;assigned&lt;/em&gt; to &lt;em&gt;closed&lt;/em&gt;
            &lt;/li&gt;
            &lt;li&gt;&lt;strong&gt;resolution&lt;/strong&gt;
                set to &lt;em&gt;fixed&lt;/em&gt;
            &lt;/li&gt;
          &lt;/ul&gt;
      </description>
      <category>Ticket</category>
    </item>
 </channel>
</rss>